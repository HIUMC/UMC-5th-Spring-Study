# ğŸ¾ğŸ¾ê°ì²´ ì§€í–¥ ì„¤ê³„ì™€ ìŠ¤í”„ë§ğŸ¾ğŸ¾

# ìŠ¤í”„ë§ì´ë€?

## ìŠ¤í”„ë§ ìƒíƒœê³„

**ìŠ¤í”„ë§** : ì—¬ëŸ¬ ê°€ì§€ ê¸°ìˆ ë“¤ì˜ ëª¨ìŒ

- í•„ìˆ˜ : *ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬, ìŠ¤í”„ë§ ë¶€íŠ¸
- ì„ íƒ : ìŠ¤í”„ë§ ë°ì´í„°, ìŠ¤í”„ë§ ì„¸ì…˜, ìŠ¤í”„ë§ ì‹œíë¦¬í‹°, ìŠ¤í”„ë§ Rest Docs, ìŠ¤í”„ë§ ë°°ì¹˜, ìŠ¤í”„ë§ í´ë¼ìš°ë“œ

ê´€ë ¨ ìë£Œ ê²€ìƒ‰ : [spring.io](http://spring.io) â†’ Projects â†’ Overview

## â­â­â­ ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬

- **í•µì‹¬ ê¸°ìˆ ** : ìŠ¤í”„ë§ DI ì»¨í…Œì´ë„ˆ, AOP, ì´ë²¤íŠ¸, ê¸°íƒ€
- ì›¹ ê¸°ìˆ  : ìŠ¤í”„ë§ MVC, ìŠ¤í”„ë§ WebFlux
- ë°ì´í„° ì ‘ê·¼ ê¸°ìˆ  : íŠ¸ëœì­ì…˜, JDBC, ORM ì§€ì›, XML ì§€ì›
- ê¸°ìˆ  í†µí•© : ìºì‹œ, ì´ë©”ì¼, ì›ê²©ì ‘ê·¼, ìŠ¤ì¼€ì¤„ë§
- í…ŒìŠ¤íŠ¸ : ìŠ¤í”„ë§ ê¸°ë°˜ í…ŒìŠ¤íŠ¸ ì§€ì›
- ì–¸ì–´ : ì½”í‹€ë¦°, ê·¸ë£¨ë¹„
- ìµœê·¼ì—ëŠ” ìŠ¤í”„ë§ ë¶€íŠ¸ë¥¼ í†µí•´ ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ì˜ ê¸°ìˆ ë“¤ì„ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©

## ìŠ¤í”„ë§ ë¶€íŠ¸

- ìŠ¤í”„ë§ì„ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì§€ì›, ìµœê·¼ì—ëŠ” ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©
- ë‹¨ë…ìœ¼ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ìŠ¤í”„ë§ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‰½ê²Œ ìƒì„±
- Tomcat ê°™ì€ ì›¹ ì„œë²„ë¥¼ ë‚´ì¥í•´ì„œ ë³„ë„ì˜ ì›¹ ì„œë²„ë¥¼ ì„¤ì¹˜í•˜ì§€ ì•Šì•„ë„ ë¨
- ì†ì‰¬ìš´ ë¹Œë“œ êµ¬ì„±ì„ ìœ„í•œ starter ì¢…ì†ì„± ì œê³µ
- ìŠ¤í”„ë§ê³¼ 3rd parth(ì™¸ë¶€) ë¼ì´ë¸ŒëŸ¬ë¦¬ ìë™ êµ¬ì„±
- ë©”íŠ¸ë¦­, ìƒíƒœ í™•ì¸, ì™¸ë¶€ êµ¬ì„± ê°™ì€ í”„ë¡œë•ì…˜ ì¤€ë¹„ ê¸°ëŠ¥ ì œê³µ (ëª¨ë‹ˆí„°ë§)
- ê´€ë¡€ì— ì˜í•œ ê°„ê²°í•œ ì„¤ì •

## ìŠ¤í”„ë§ ë‹¨ì–´?

- ìŠ¤í”„ë§ì´ë¼ëŠ” ë‹¨ì–´ëŠ” ë¬¸ë§¥ì— ë”°ë¼ ë‹¤ë¥´ê²Œ ì‚¬ìš©ëœë‹¤
    - ìŠ¤í”„ë§ DI ì»¨í…Œì´ë„ˆ ê¸°ìˆ 
    - ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬
    - ìŠ¤í”„ë§ ë¶€íŠ¸, ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ ë“±ì„ ëª¨ë‘ í¬í•¨í•œ ìŠ¤í”„ë§ ìƒíƒœê³„

## ìŠ¤í”„ë§ì˜ í•µì‹¬

- ìŠ¤í”„ë§ì€ ìë°” ì–¸ì–´ ê¸°ë°˜ì˜ í”„ë ˆì„ì›Œí¬
- ìë°” ì–¸ì–´ì˜ ê°€ì¥ í° íŠ¹ì§• - **ê°ì²´ ì§€í–¥ ì–¸ì–´**
- ìŠ¤í”„ë§ì€ ê°ì²´ ì§€í–¥ ì–¸ì–´ê°€ ê°€ì§„ ê°•ë ¥í•œ íŠ¹ì§•ì„ ì‚´ë ¤ë‚´ëŠ” í”„ë ˆì„ì›Œí¬
- ìŠ¤í”„ë§ì€ **ì¢‹ì€ ê°ì²´ ì§€í–¥** ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œí•  ìˆ˜ ìˆê²Œ ë„ì™€ì£¼ëŠ” í”„ë ˆì„ì›Œí¬

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ê°ì²´ ì§€í–¥ í”„ë¡œê·¸ë˜ë°

## ê°ì²´ ì§€í–¥ íŠ¹ì§•

- ì¶”ìƒí™”
- ìº¡ìŠí™”
- ìƒì†
- **ë‹¤í˜•ì„±**

## ê°ì²´ ì§€í–¥ í”„ë¡œê·¸ë˜ë°

- ì»´í“¨í„° í”„ë¡œê·¸ë¨ì„ ì—¬ëŸ¬ ê°œì˜ ë…ë¦½ëœ ë‹¨ìœ„, **ê°ì²´**ë“¤ì˜ **ëª¨ì„**ìœ¼ë¡œ íŒŒì•…í•˜ëŠ” ê²ƒ
- ê°ê°ì˜ ê°ì²´ëŠ” ë©”ì„¸ì§€ë¥¼ ì£¼ê³ ë°›ê³ , ë°ì´í„°ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆìŒ (**í˜‘ë ¥**)
- í”„ë¡œê·¸ë¨ì„ **ìœ ì—°**í•˜ê³  **ë³€ê²½**ì´ ìš©ì´í•˜ê²Œ ë§Œë“œëŠ” ê²ƒ â†’ ëŒ€ê·œëª¨ ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œì— ì´ìš©

    
    ìœ ì—°í•˜ê³ , ë³€ê²½ì´ ìš©ì´?

    - ë ˆê³  ë¸”ëŸ­ ì¡°ë¦½í•˜ë“¯ì´
    - í‚¤ë³´ë“œ, ë§ˆìš°ìŠ¤ ê°ˆì•„ ë¼ìš°ë“¯ì´
    - ì»´í“¨í„° ë¶€í’ˆ ê°ˆì•„ ë¼ìš°ë“¯ì´
    - ì»´í¬ë„ŒíŠ¸ë¥¼ ì‰½ê³  ìœ ì—°í•˜ê²Œ ë³€ê²½í•˜ë©´ì„œ ê°œë°œí•  ìˆ˜ ìˆëŠ” ë°©ë²•

    â†’ ë‹¤í˜•ì„± (Polymorphism)

# ë‹¤í˜•ì„±

## ë‹¤í˜•ì„±ì˜ ì‹¤ì„¸ê³„ ë¹„ìœ 

- ì‹¤ì„¸ê³„ì™€ ê°ì²´ ì§€í–¥ì„ 1:1 ë¡œ ë§¤ì¹­ X â†’ ê·¸ë˜ë„ ì‹¤ì„¸ê³„ì˜ ë¹„ìœ ë¡œ ì´í•´í•˜ê¸°ì—ëŠ” ì¢‹ìŒ
- **ì—­í• **ê³¼ **êµ¬í˜„**ìœ¼ë¡œ ì„¸ìƒì„ êµ¬ë¶„
- ì˜ˆì‹œ
    - ìš´ì „ì - ìë™ì°¨
    - ê³µì—° ë¬´ëŒ€
    - í‚¤ë³´ë“œ, ë§ˆìš°ìŠ¤, ì„¸ìƒì˜ í‘œì¤€ ì¸í„°í˜ì´ìŠ¤ë“¤
    - ì •ë ¬ ì•Œê³ ë¦¬ì¦˜
    - í• ì¸ ì •ì±… ë¡œì§

![Untitled](img/ìš´ì „ì-ìë™ì°¨.png)

â¡ï¸ ìë™ì°¨ê°€ ë°”ë€Œì–´ë„ ìš´ì „ìëŠ” ìš´ì „ ê°€ëŠ¥

â¡ï¸ ìë™ì°¨ ë¬´í•œ í™•ì¥ ê°€ëŠ¥

â¡ï¸ í´ë¼ì´ì–¸íŠ¸ì— ì˜í–¥ì„ ì£¼ì§€ ì•Šê³  ìƒˆë¡œìš´ ê¸°ëŠ¥ ì œê³µ ê°€ëŠ¥

![Untitled](img/ë¡œë¯¸ì˜¤ì™€_ì¤„ë¦¬ì—£_ê³µì—°.png)

â¡ï¸ ë°°ìš°ëŠ” ëŒ€ì²´ ê°€ëŠ¥

â¡ï¸ ìœ ì—°í•˜ê³  ë³€ê²½ ìš©ì´

## ì—­í• ê³¼ êµ¬í˜„ì„ ë¶„ë¦¬

- ì¥ì 
    - ì„¸ìƒì´ **ë‹¨ìˆœ**í•´ì§€ê³ , **ìœ ì—°**í•´ì§€ë©° **ë³€ê²½**ì´ í¸ë¦¬
    - **í´ë¼ì´ì–¸íŠ¸**ëŠ” ëŒ€ìƒì˜ ì—­í• (ì¸í„°í˜ì´ìŠ¤)ë§Œ ì•Œë©´ ë¨
    - **í´ë¼ì´ì–¸íŠ¸**ëŠ” êµ¬í˜„ ëŒ€ìƒì˜ **ë‚´ë¶€ êµ¬ì¡°ë¥¼ ëª°ë¼**ë„ ë¨
    - **í´ë¼ì´ì–¸íŠ¸**ëŠ” êµ¬í˜„ ëŒ€ìƒì˜ **ë‚´ë¶€ êµ¬ì¡°ê°€ ë³€ê²½**ë˜ì–´ë„ ì˜í–¥ì„ ë°›ì§€ ì•ŠìŒ
    - **í´ë¼ì´ì–¸íŠ¸**ëŠ” êµ¬í˜„ **ëŒ€ìƒ ìì²´ë¥¼ ë³€ê²½**í•´ë„ ì˜í–¥ì„ ë°›ì§€ ì•ŠìŒ


### ìë°” ì–¸ì–´

- ìë°” ì–¸ì–´ì˜ ë‹¤í˜•ì„±ì„ í™œìš©
    - ì—­í•  = ì¸í„°í˜ì´ìŠ¤
    - êµ¬í˜„ = ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ í´ë˜ìŠ¤, êµ¬í˜„ ê°ì²´
- ê°ì²´ë¥¼ ì„¤ê³„í•  ë•Œ **ì—­í• **ê³¼ **êµ¬í˜„**ì„ ëª…í™•íˆ ë¶„ë¦¬
- ê°ì²´ ì„¤ê³„ì‹œ ì—­í• (ì¸í„°í˜ì´ìŠ¤)ë¥¼ ë¨¼ì € ë¶€ì—¬ í›„, ê·¸ ì—­í• ì„ ìˆ˜í–‰í•˜ëŠ” êµ¬í˜„ ê°ì²´ ë§Œë“¤ê¸°

## ìë°” ì–¸ì–´ì˜ ë‹¤í˜•ì„±

- **ì˜¤ë²„ë¼ì´ë”©**
- ë‹¤í˜•ì„±ìœ¼ë¡œ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ ê°ì²´ë¥¼ ì‹¤í–‰ ì‹œì ì— ìœ ì—°í•˜ê²Œ ë³€ê²½ ê°€ëŠ¥
- í´ë˜ìŠ¤ ìƒì† ê´€ê³„ë„ ë‹¤í˜•ì„±, ì˜¤ë²„ë¼ì´ë”© ì ìš© ê°€ëŠ¥

![Untitled](img/ìë°”_ì–¸ì–´ì˜_ë‹¤í˜•ì„±.png)

![Untitled](img/í´ë¼ì´ì–¸íŠ¸ëŠ”_MemberRepository_ì˜ì¡´.png)

â¡ï¸ í´ë¼ì´ì–¸íŠ¸ëŠ” MemberRepository ì˜ì¡´

```java
// 1
public class MemberService {
	private MemberRepository memberRepository = new MemmoryMemberRepository();
}

// 2
public class MemberService {
	private MemberRepository memberRepository = new JdbcMemberRepository();
}
```

![Untitled](img/í´ë¼ì´ì–¸íŠ¸ëŠ”_MemberRepository_ì˜ì¡´2.png)

![Untitled](img/í´ë¼ì´ì–¸íŠ¸ëŠ”_MemberRepository_ì˜ì¡´_ì „ì²´ê´€ê³„.png)

## ë‹¤í˜•ì„±ì˜ ë³¸ì§ˆ

- ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ **ì‹¤í–‰ ì‹œì **ì— **ìœ ì—°**í•˜ê²Œ **ë³€ê²½** ê°€ëŠ¥
- **í˜‘ë ¥** : ê°ì²´ ì‚¬ì´ì˜ ê´€ê³„
- **í´ë¼ì´ì–¸íŠ¸ë¥¼ ë³€ê²½í•˜ì§€ ì•Šê³ , ì„œë²„ì˜ êµ¬í˜„ ê¸°ëŠ¥ì„ ìœ ì—°í•˜ê²Œ ë³€ê²½ ê°€ëŠ¥**

## ì—­í• ê³¼ êµ¬í˜„ì„ ë¶„ë¦¬

### ì •ë¦¬

- ìœ ì—°í•˜ê³ , ë³€ê²½ì´ ìš©ì´
- í™•ì¥ ê°€ëŠ¥í•œ ì„¤ê³„ (ë¬´í•œ í™•ì¥)
- í´ë¼ì´ì–¸íŠ¸ì— ì˜í–¥ì„ ì£¼ì§€ ì•ŠëŠ” ë³€ê²½ ê°€ëŠ¥

### í•œê³„

- ì—­í• (ì¸í„°í˜ì´ìŠ¤)ì´ ë³€í•˜ë©´, í´ë¼ì´ì–¸íŠ¸ & ì„œë²„ì— ë³€ê²½ ë°œìƒ

## ìŠ¤í”„ë§ê³¼ ê°ì²´ ì§€í–¥

- â­**ë‹¤í˜•ì„±**
- ìŠ¤í”„ë§ì€ ë‹¤í˜•ì„±ì„ ê·¹ëŒ€í™”í•´ì„œ ì´ìš©í•  ìˆ˜ ìˆê²Œ ë„ì™€ì¤Œ
- ì œì–´ì˜ ì—­ì „(IoC), ì˜ì¡´ê´€ê³„ ì£¼ì…(DI) : ë‹¤í˜•ì„±ì„ í™œìš©í•´ ì—­í• ê³¼ êµ¬í˜„ì„ í¸ë¦¬í•˜ê²Œ ë‹¤ë£° ìˆ˜ ìˆë„ë¡ ì§€ì›
- ìŠ¤í”„ë§ì„ ì‚¬ìš©í•˜ë©´ êµ¬í˜„ì„ í¸ë¦¬í•˜ê²Œ ë³€ê²½ ê°€ëŠ¥

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ì¢‹ì€ ê°ì²´ ì§€í–¥ ì„¤ê³„ì˜ 5ê°€ì§€ ì›ì¹™ (SOLID)

- ê°€ë” ë©´ì ‘ì—ì„œ ë‚˜ì˜´ ğŸ‘€

## SOLID
> í´ë¦° ì½”ë“œë¡œ ìœ ëª…í•œ ë¡œë²„íŠ¸ ë§ˆí‹´ì´ ì¢‹ì€ ê°ì²´ ì§€í–¥ ì„¤ê³„ì˜ 5ê°€ì§€ ì›ì¹™ì„ ì •ë¦¬

- SRP (Single Responsibility Principle) : ë‹¨ì¼ ì±…ì„ ì›ì¹™
- OCP (Open/Closed Principle): ê°œë°©-íì‡„ ì›ì¹™
- LSP (Liskov Substitution Principle) : ë¦¬ìŠ¤ì½”í”„ ì¹˜í™˜ ì›ì¹™
- ISP (Interface Segregation Principle) : ì¸í„°í˜ì´ìŠ¤ ë¶„ë¦¬ ì›ì¹™
- DIP (Dependency Inversion Principle) : ì˜ì¡´ê´€ê³„ ì—­ì „ ì›ì¹™

## SRP ë‹¨ì¼ ì±…ì„ ì›ì¹™
> Single Responsibility Principle

- í•œ í´ë˜ìŠ¤ëŠ” í•˜ë‚˜ì˜ ì±…ì„ë§Œ ê°€ì ¸ì•¼ í•œë‹¤
- ê¸°ì¤€ : **ë³€ê²½**
  - ë³€ê²½ì´ ìˆì„ ë•Œ íŒŒê¸‰ íš¨ê³¼ê°€ ì ìœ¼ë©´ ë‹¨ì¼ ì±…ì„ ì›ì¹™ì„ ì˜ ë”°ë¥¸ ê²ƒ
- ì˜ˆ) UI ë³€ê²½, ê°ì²´ì˜ ìƒì„±ê³¼ ì‚¬ìš©ì„ ë¶„ë¦¬

## â­â­â­ OCP ê°œë°©-íì‡„ ì›ì¹™
> Open/Closed Principle

- ì†Œí”„íŠ¸ì›¨ì–´ ìš”ì†ŒëŠ” **í™•ì¥ì—ëŠ” ì—´ë ¤** ìˆìœ¼ë‚˜ **ë³€ê²½ì—ëŠ” ë‹«í˜€** ìˆì–´ì•¼ í•œë‹¤
- **ë‹¤í˜•ì„±** í™œìš©
- ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ ìƒˆë¡œìš´ í´ë˜ìŠ¤ë¥¼ í•˜ë‚˜ ë§Œë“¤ì–´ì„œ ìƒˆë¡œìš´ ê¸°ëŠ¥ì„ êµ¬í˜„

```java
public class MemberService {
	// private MemberRepository memberRepository = new MemoryMemberRepository();
	private MemberRepository memberRepository = new JdbcMemberRepository();
}
```

### ë¬¸ì œì 

- MemberService í´ë¼ì´ì–¸íŠ¸ê°€ êµ¬í˜„ í´ë˜ìŠ¤ë¥¼ ì§ì ‘ ì„ íƒ
  - MemberRepository m = new MemoryMemberRepository(); â† ê¸°ì¡´ ì½”ë“œ
  - MemberRepository m = new JdbcMemberRepository(); â† ë³€ê²½ ì½”ë“œ
- **êµ¬í˜„ ê°ì²´ë¥¼ ë³€ê²½í•˜ë ¤ë©´ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ ë³€ê²½í•´ì•¼ í•¨**
- **ë‹¤í˜•ì„±ì„ ì‚¬ìš©í–ˆì§€ë§Œ OCP ì›ì¹™ ë¶ˆë§Œì¡±**
- í•´ê²°ì±… : ê°ì²´ë¥¼ ìƒì„±í•˜ê³ , ì—°ê´€ê´€ê³„ë¥¼ ë§ºì–´ì£¼ëŠ” ë³„ë„ì˜ ì¡°ë¦½, ì„¤ì •ìê°€ í•„ìš”í•˜ë‹¤

## LSP ë¦¬ìŠ¤ì½”í”„ ì¹˜í™˜ ì›ì¹™
> Liskov Substitution Principle

- í”„ë¡œê·¸ë¨ì˜ ê°ì²´ëŠ” í”„ë¡œê·¸ë¨ì˜ ì •í™•ì„±ì„ ê¹¨ëœ¨ë¦¬ì§€ ì•Šìœ¼ë©´ì„œ í•˜ìœ„ íƒ€ì…ì˜ ì¸ìŠ¤í„´ìŠ¤ë¡œ ë°”ê¿€ ìˆ˜ ìˆì–´ì•¼ í•œë‹¤
- ë‹¤í˜•ì„±ì—ì„œ í•˜ìœ„ í´ë˜ìŠ¤ëŠ” ì¸í„°í˜ì´ìŠ¤ ê·œì•½ì„ ë‹¤ ì§€ì¼œì•¼ í•œë‹¤ëŠ” ê²ƒ
- ì˜ˆ) ìë™ì°¨ ì¸í„°í˜ì´ìŠ¤ì˜ ì—‘ì…€ì€ ì•ìœ¼ë¡œ ê°€ëŠ” ê¸°ëŠ¥, ë’¤ë¡œ ê°€ê²Œ êµ¬í˜„í•˜ë©´ LSP ìœ„ë°˜, ëŠë¦¬ë”ë¼ë„ ì•ìœ¼ë¡œ ê°€ì•¼í•¨

## ISP ì¸í„°í˜ì´ìŠ¤ ë¶„ë¦¬ ì›ì¹™
> Interface Segregation Principle

- íŠ¹ì • í´ë¼ì´ì–¸íŠ¸ë¥¼ ìœ„í•œ ì¸í„°í˜ì´ìŠ¤ ì—¬ëŸ¬ ê°œê°€ ë²”ìš© ì¸í„°í˜ì´ìŠ¤ í•˜ë‚˜ë³´ë‹¤ ë‚«ë‹¤
- ìë™ì°¨ ì¸í„°í˜ì´ìŠ¤ â†’ ìš´ì „ ì¸í„°í˜ì´ìŠ¤, ì •ë¹„ ì¸í„°í˜ì´ìŠ¤ë¡œ ë¶„ë¦¬
- ì‚¬ìš©ì í´ë¼ì´ì–¸íŠ¸ â†’ ìš´ì „ì í´ë¼ì´ì–¸íŠ¸, ì •ë¹„ì‚¬ í´ë¼ì´ì–¸íŠ¸ë¡œ ë¶„ë¦¬
- ë¶„ë¦¬í•˜ë©´ ì •ë¹„ ì¸í„°í˜ì´ìŠ¤ ìì²´ê°€ ë³€í•´ë„ ìš´ì „ì í´ë¼ì´ì–¸íŠ¸ì— ì˜í–¥ì„ ì£¼ì§€ ì•ŠìŒ
- ì¸í„°í˜ì´ìŠ¤ê°€ ëª…í™•í•´ì§€ê³ , ëŒ€ì²´ ê°€ëŠ¥ì„±ì´ í–¥ìƒ

## â­â­â­ DIP ì˜ì¡´ê´€ê³„ ì—­ì „ ì›ì¹™
> Dependency Inversion Principle

- â€œì¶”ìƒí™”ì— ì˜ì¡´í•´ì•¼ì§€, êµ¬ì²´í™”ì— ì˜ì¡´í•˜ë©´ ì•ˆëœë‹¤â€
- êµ¬í˜„ í´ë˜ìŠ¤ì— ì˜ì¡´í•˜ì§€ ë§ê³ , ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´í•˜ë¼ëŠ” ëœ»
- MemberService ëŠ” ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´í•˜ì§€ë§Œ, êµ¬í˜„ í´ë˜ìŠ¤ë„ ë™ì‹œ ì˜ì¡´
- MemberService í´ë¼ì´ì–¸íŠ¸ê°€ êµ¬í˜„ í´ë˜ìŠ¤ë¥¼ ì§ì ‘ ì„ íƒ
  - MemberRepository m = new MemoryMemberRepository(); â†’ **DIP ìœ„ë°˜**

## ì •ë¦¬

- ê°ì²´ ì§€í–¥ì˜ í•µì‹¬ì€ ë‹¤í˜•ì„±
- **ë‹¤í˜•ì„± ë§Œìœ¼ë¡œëŠ” OCP, DIP ë¥¼ ì§€í‚¬ ìˆ˜ ì—†ìŒ**

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ê°ì²´ ì§€í–¥ ì„¤ê³„ì™€ ìŠ¤í”„ë§

- **ìŠ¤í”„ë§ì€ ë‹¤ìŒ ê¸°ìˆ ë¡œ ë‹¤í˜•ì„± + OCP, DIP ë¥¼ ê°€ëŠ¥í•˜ê²Œ ì§€ì›**
  - DI (Dependency Injection) : ì˜ì¡´ê´€ê³„, ì˜ì¡´ì„± ì£¼ì…
  - DI ì»¨í…Œì´ë„ˆ ì œê³µ
- **í´ë¼ì´ì–¸íŠ¸ ì½”ë“œì˜ ë³€ê²½ ì—†ì´ ê¸°ëŠ¥ í™•ì¥**
- ì‰½ê²Œ ë¶€í’ˆì„ êµì²´í•˜ë“¯ì´ ê°œë°œ

## ì •ë¦¬

- ëª¨ë“  ì„¤ê³„ì— **ì—­í• **ê³¼ **êµ¬í˜„**ì„ ë¶„ë¦¬
- ì´ìƒì ìœ¼ë¡œëŠ” ëª¨ë“  ì„¤ê³„ì— ì¸í„°í˜ì´ìŠ¤ë¥¼ ë¶€ì—¬í•˜ì

### ì‹¤ë¬´ ê³ ë¯¼

- ì¸í„°í˜ì´ìŠ¤ ë„ì… ì‹œ ì¶”ìƒí™” ë¹„ìš© ë°œìƒ
- ê¸°ëŠ¥ì„ í™•ì¥í•  ê°€ëŠ¥ì„±ì´ ì—†ë‹¤ë©´, êµ¬ì²´ í´ë˜ìŠ¤ë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ê³ , í–¥í›„ ê¼­ í•„ìš”í•  ë•Œ ë¦¬íŒ©í„°ë§í•˜ì—¬ ì¸í„°í˜ì´ìŠ¤ ë„ì…


<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ğŸ¾ğŸ¾ìŠ¤í”„ë§ í•µì‹¬ ì›ë¦¬ ì´í•´1 - ì˜ˆì œ ë§Œë“¤ê¸°ğŸ¾ğŸ¾

# í”„ë¡œì íŠ¸ ìƒì„±

- ìŠ¤í”„ë§ ì—†ì´ ìˆœìˆ˜ ìë°”ë¡œ êµ¬í˜„

- ì‚¬ì „ ì¤€ë¹„ë¬¼
  - Oracle JDK ì˜ Java 11 ì„¤ì¹˜
  - IDE : IntelliJ ë˜ëŠ” Eclipse ì„¤ì¹˜

## [ìŠ¤í”„ë§ ë¶€íŠ¸ ìŠ¤íƒ€í„° ì‚¬ì´íŠ¸](https://start.spring.io)ë¡œ ì´ë™í•´ì„œ ìŠ¤í”„ë§ í”„ë¡œì íŠ¸ ìƒì„±


    ğŸ’¡ **ì£¼ì˜ ! ìŠ¤í”„ë§ ë¶€íŠ¸ 3.0**
    â†’ ìŠ¤í”„ë§ ë¶€íŠ¸ 3.0 ì„ ì„ íƒí•˜ê²Œ ë˜ë©´ ë‹¤ìŒ ë¶€ë¶„ í™•ì¸í•˜ê¸°
    1. Java 17 ì´ìƒ ì‚¬ìš©
    2. javax íŒ¨í‚¤ì§€ ì´ë¦„ì„ jakarta ë¡œ ë³€ê²½í•´ì•¼ í•¨

    íŒ¨í‚¤ì§€ ì´ë¦„ ë³€ê²½ ì˜ˆì‹œ
    - JPA ì• ë…¸í…Œì´ì…˜ :
    javax.persistence.Entity â†’ jakarta.persistence.Entity
    - ìŠ¤í”„ë§ì—ì„œ ìì£¼ ì‚¬ìš©í•˜ëŠ” @PostConstruct ì• ë…¸í…Œì´ì…˜ :
    javax.annotation.PostConstruct â†’ jakarta.annotation.PostConstruct
    - ìŠ¤í”„ë§ì—ì„œ ìì£¼ ì‚¬ìš©í•˜ëŠ” ê²€ì¦ ì• ë…¸í…Œì´ì…˜
    javax. validation â†’ jakarta.validation

    ìì„¸í•œ ë‚´ìš©
    https://bit.ly/springboot3


- í”„ë¡œì íŠ¸ ì„ íƒ
  - Project : Gradle - Groovy Project
  - Language : Java
  - Spring Boot : 3.1.4 (SNAPSHOT/M3 ëŠ” ì•„ì§ ì •ì‹ release ì•„ë‹˜)
  - Project Metadata
    - Group : hello
    - Artifact : core
    - Packaging : Jar
    - Java : 17
  - Dependencies : ì„ íƒ ì•ˆí•¨ â†’ core library ë§Œ ê°€ì§€ê³  ê°„ë‹¨í•˜ê²Œ ìƒì„±ë¨

![Untitled](img/ìŠ¤í”„ë§_ìŠ¤íƒ€í„°.png)

- í”„ë¡œì íŠ¸ ì—´ê¸° : build.gradle â†’ open
- build.gradle setting

```java
plugins {
	id 'java'
	id 'org.springframework.boot' version '3.1.4'
	id 'io.spring.dependency-management' version '1.1.3'
}

group = 'hello'
version = '0.0.1-SNAPSHOT'

java {
	sourceCompatibility = '17'
}

repositories {
	mavenCentral()
}

dependencies {
	implementation 'org.springframework.boot:spring-boot-starter'
	testImplementation 'org.springframework.boot:spring-boot-starter-test'
}

tasks.named('test') {
	useJUnitPlatform()
}
```

## ë™ì‘ í™•ì¸í•˜ê¸°(ê¸°ë³¸ ë©”ì¸ í´ë˜ìŠ¤ ì‹¤í–‰) : src/main/java/hello.core ì˜ CoreApplication Run í•´ë³´ê¸°

![Untitled](img/ìŠ¤í”„ë§_ìŠ¤íƒ€í„°_ë™ì‘_í™•ì¸.png)

Gradle ëŒ€ì‹  IntelliJë¡œ ìë°” ì§ì ‘ ì‹¤í–‰í•˜ê¸° â†’ ì‹¤í–‰ ì†ë„ê°€ ë” ë¹ ë¥´ë‹¤

- File - Settings - Build, Execution, Deployment - Build Tools - Gradle - Gradle projects
  - Build and run using : Gradle â†’ IntelliJ IDEA ë³€ê²½
  - Run tests using : Gradle â†’ IntelliJ IDEA ë³€ê²½

![Untitled](img/Gradle_ëŒ€ì‹ _IntelliJ.png)

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ê³¼ ì„¤ê³„

- íšŒì›
  - íšŒì› ê°€ì…, ì¡°íšŒ
  - íšŒì› ë“±ê¸‰ : ì¼ë°˜, VIP
  - íšŒì› ë°ì´í„°: ìì²´ DB êµ¬ì¶•, ì™¸ë¶€ ì‹œìŠ¤í…œ ì—°ë™ ê°€ëŠ¥ì„± (ë¯¸í™•ì •)
- ì£¼ë¬¸ê³¼ í• ì¸ ì •ì±…
  - íšŒì›ì´ ìƒí’ˆ ì£¼ë¬¸
  - íšŒì› ë“±ê¸‰ì— ë”°ë¥¸ í• ì¸ ì •ì±…
  - ê³ ì • ê¸ˆì•¡ í• ì¸ : ëª¨ë“  VIP 1000ì› í• ì¸ (ë³€ê²½ ê°€ëŠ¥)
  - í• ì¸ ì •ì±… ë³€ê²½ ê°€ëŠ¥ì„±, í• ì¸ì„ í•˜ì§€ ì•Šì„ ìˆ˜ë„ ìˆìŒ (ë¯¸í™•ì •)

â†’ ê³ ì •ë˜ì§€ ì•Šì€ ìš”êµ¬ì‚¬í•­ : ê°ì²´ ì§€í–¥ ì„¤ê³„ ë°©ë²• ì‚¬ìš©í•˜ê¸°

â†’ êµ¬í˜„ì²´ë¥¼ ë°”ê¿€ ìˆ˜ ìˆëŠ” ì¸í„°í˜ì´ìŠ¤ ì„¤ê³„

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# íšŒì› ë„ë©”ì¸ ì„¤ê³„

- íšŒì› ë„ë©”ì¸ ìš”êµ¬ì‚¬í•­
  - íšŒì› ê°€ì…, ì¡°íšŒ
  - íšŒì› ë“±ê¸‰ : ì¼ë°˜, VIP
  - íšŒì› ë°ì´í„°: ìì²´ DB êµ¬ì¶•, ì™¸ë¶€ ì‹œìŠ¤í…œ ì—°ë™ ê°€ëŠ¥ì„± (ë¯¸í™•ì •)


- íšŒì› ë„ë©”ì¸ í˜‘ë ¥ ê´€ê³„

![Untitled](img/íšŒì›_ë„ë©”ì¸_í˜‘ë ¥_ê´€ê³„.png)

- íšŒì› í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨

![Untitled](img/íšŒì›_í´ë˜ìŠ¤_ë‹¤ì´ì–´ê·¸ë¨.png)

â¡ï¸ ì¸í„°í˜ì´ìŠ¤ : MemberService

â¡ï¸ êµ¬í˜„ì²´ : MemberServiceImpl

â¡ï¸ MemberRepository = íšŒì› ì €ì¥ì†Œ

- íšŒì› ê°ì²´ ë‹¤ì´ì–´ê·¸ë¨ (ê°ì²´ ê°„ ë©”ëª¨ë¦¬ ì°¸ì¡°)

![Untitled](img/íšŒì›_ê°ì²´_ë‹¤ì´ì–´ê·¸ë¨.png)

MemberServiceImpl = íšŒì› ì„œë¹„ìŠ¤

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# íšŒì› ë„ë©”ì¸ ê°œë°œ

- ë§Œë“¤ ê²ƒ

  ![Untitled.png](img/íšŒì›_í´ë˜ìŠ¤_ë‹¤ì´ì–´ê·¸ë¨.png)


1. member íŒ¨í‚¤ì§€ ìƒì„±
2. member íŒ¨í‚¤ì§€ì— Grade ì´ë¦„ì˜ Enum ìƒì„±

```java
package hello.core.member;

public enum Grade {
    // íšŒì› ë“±ê¸‰
    BASIC,
    VIP
}
```

3. member íŒ¨í‚¤ì§€ì— Member ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.member;

public class Member {
    private Long id;
    private String name;
    private Grade grade;

    // Alt + Insert -> Constructor, Getter&Setter

    public Member(Long id, String name, Grade grade) {
        this.id = id;
        this.name = name;
        this.grade = grade;
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Grade getGrade() {
        return grade;
    }

    public void setGrade(Grade grade) {
        this.grade = grade;
    }
}
```

4. member íŒ¨í‚¤ì§€ì— MemberRepository ì´ë¦„ì˜ Interface ìƒì„±

```java
package hello.core.member;

public interface MemberRepository {
    void save(Member member);

    Member findById(Long memberId);
}
```

5. member íŒ¨í‚¤ì§€ì— MemoryMemberRepository ì´ë¦„ì˜ Class ìƒì„± (MemberRepository êµ¬í˜„ì²´)

```java
package hello.core.member;

import java.util.HashMap;
import java.util.Map;

public class MemoryMemberRepository implements MemberRepository{

    // ì‹¤ë¬´ì—ì„œëŠ” ë™ì‹œì„± ì´ìŠˆë¥¼ ê³ ë ¤í•´ ConcurrentHashMap ì‚¬ìš©
    private static Map<Long, Member> store = new HashMap<>();

    @Override
    public void save(Member member) {
        store.put(member.getId(), member);
    }

    @Override
    public Member findById(Long memberId) {
        return store.get(memberId);
    }
}
```

6. member íŒ¨í‚¤ì§€ì— MemberService ì´ë¦„ì˜ Interface ìƒì„±

```java
package hello.core.member;

public interface MemberService {
    // íšŒì› ê°€ì…
    void join(Member member);

    // íšŒì› ì¡°íšŒ
    Member findMember(Long memberId);
}
```

7. member íŒ¨í‚¤ì§€ì— MemberServiceImpl ì´ë¦„ì˜ Class ìƒì„± (MemberService êµ¬í˜„ì²´)

```java
package hello.core.member;

public class MemberServiceImpl implements MemberService{

    private final MemberRepository memberRepository = new MemoryMemberRepository();

    @Override
    public void join(Member member) {
        memberRepository.save(member);
    }

    @Override
    public Member findMember(Long memberId) {
        return memberRepository.findById(memberId);
    }
}
```

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# íšŒì› ë„ë©”ì¸ ì‹¤í–‰ê³¼ í…ŒìŠ¤íŠ¸

1. main/java/hello.core íŒ¨í‚¤ì§€ì— MemberApp ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core;

import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;

public class MemberApp {
    // psvm
    public static void main(String[] args) {
        MemberService memberService = new MemberServiceImpl();
        Member member = new Member(1L, "memberA", Grade.VIP); // ctrl + alt + v
        memberService.join(member);

        Member findMember = memberService.findMember(1L);
        System.out.println("new member = " + member.getName());
        System.out.println("findMember = " + findMember.getName());

    }
}
```

2. test/java/hello.core íŒ¨í‚¤ì§€ì— member ì´ë¦„ì˜ Package ìƒì„±
3. ë§Œë“  member íŒ¨í‚¤ì§€ì— MemberServiceTest ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.member;

import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.Test;

public class MemberServiceTest {

    MemberService memberService = new MemberServiceImpl();

    @Test
    void join() {
        // given
        Member member = new Member(1L, "memberA", Grade.VIP);

        // when
        memberService.join(member);
        Member findMember = memberService.findMember(1L);

        // then
        Assertions.assertThat(member).isEqualTo(findMember);

    }
}
```

![Untitled](img/íšŒì›_ë„ë©”ì¸_ì‹¤í–‰_í…ŒìŠ¤íŠ¸.png)

â†’ í…ŒìŠ¤íŠ¸ ì„±ê³µ !

ğŸ’¡ ë¬¸ì œì  â†’ ì¸í„°í˜ì´ìŠ¤ ë¿ë§Œì´ ì•„ë‹ˆë¼ êµ¬í˜„ì²´ë„ ì§ì ‘ í˜¸ì¶œí•˜ê³  ìˆìŒ

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ì£¼ë¬¸ê³¼ í• ì¸ ë„ë©”ì¸ ì„¤ê³„

- ì£¼ë¬¸ê³¼ í• ì¸ ì •ì±…
  - íšŒì›ì´ ìƒí’ˆ ì£¼ë¬¸
  - íšŒì› ë“±ê¸‰ì— ë”°ë¥¸ í• ì¸ ì •ì±…
  - ê³ ì • ê¸ˆì•¡ í• ì¸ : ëª¨ë“  VIP 1000ì› í• ì¸ (ë³€ê²½ ê°€ëŠ¥)
  - í• ì¸ ì •ì±… ë³€ê²½ ê°€ëŠ¥ì„±, í• ì¸ì„ í•˜ì§€ ì•Šì„ ìˆ˜ë„ ìˆìŒ (ë¯¸í™•ì •)


- ì£¼ë¬¸ ë„ë©”ì¸ í˜‘ë ¥, ì—­í• , ì±…ì„

![Untitled](img/ì£¼ë¬¸_ë„ë©”ì¸.png)

1. **ì£¼ë¬¸ ìƒì„±** : í´ë¼ì´ì–¸íŠ¸ëŠ” ì£¼ë¬¸ ì„œë¹„ìŠ¤ì— ì£¼ë¬¸ ìƒì„± ìš”ì²­
2. **íšŒì› ì¡°íšŒ** : ì£¼ë¬¸ ì„œë¹„ìŠ¤ëŠ” íšŒì› ì €ì¥ì†Œì—ì„œ íšŒì›ì„ ì¡°íšŒ (í• ì¸ì„ ìœ„í•´ íšŒì› ë“±ê¸‰ í•„ìš”)
3. **í• ì¸ ì ìš©** : ì£¼ë¬¸ ì„œë¹„ìŠ¤ëŠ” íšŒì› ë“±ê¸‰ì— ë”°ë¼ í• ì¸ ì ìš©
4. **ì£¼ë¬¸ ê²°ê³¼ ë°˜í™˜** : ì£¼ë¬¸ ì„œë¹„ìŠ¤ëŠ” í• ì¸ ê²°ê³¼ë¥¼ í¬í•¨í•œ ì£¼ë¬¸ ê²°ê³¼ ë°˜í™˜


- ì£¼ë¬¸ ë„ë©”ì¸ ì „ì²´

![Untitled](img/ì£¼ë¬¸_ë„ë©”ì¸_ì „ì²´.png)

â¡ï¸ **ì—­í• ê³¼ êµ¬í˜„ì„ ë¶„ë¦¬**í•´ì„œ ììœ ë¡­ê²Œ êµ¬í˜„ ê°ì²´ë¥¼ ì¡°ë¦½í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„

â¡ï¸ íšŒì› ì €ì¥ì†Œ, í• ì¸ ì •ì±… ìœ ì—°í•˜ê²Œ ë³€ê²½ ê°€ëŠ¥

- ì£¼ë¬¸ ë„ë©”ì¸ í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨

![Untitled](img/ì£¼ë¬¸_ë„ë©”ì¸_í´ë˜ìŠ¤_ë‹¤ì´ì–´ê·¸ë¨.png)

- ì£¼ë¬¸ ë„ë©”ì¸ ê°ì²´ ë‹¤ì´ì–´ê·¸ë¨1

![Untitled](img/ì£¼ë¬¸_ë„ë©”ì¸_ê°ì²´_ë‹¤ì´ì–´ê·¸ë¨1.png)

â¡ï¸ íšŒì›ì„ ë©”ëª¨ë¦¬ì—ì„œ ì¡°íšŒí•˜ê³ , ì •ì•¡ í• ì¸ ì •ì±…(ê³ ì • ê¸ˆì•¡)ì„ ì§€ì›í•´ë„ ì£¼ë¬¸ ì„œë¹„ìŠ¤ë¥¼ ë³€ê²½í•˜ì§€ ì•Šì•„ë„ ë¨

â¡ï¸ ì—­í• ë“¤ì˜ í˜‘ë ¥ ê´€ê³„ ì¬ì‚¬ìš© ê°€ëŠ¥

- ì£¼ë¬¸ ë„ë©”ì¸ ê°ì²´ ë‹¤ì´ì–´ê·¸ë¨2

![Untitled](img/ì£¼ë¬¸_ë„ë©”ì¸_ê°ì²´_ë‹¤ì´ì–´ê·¸ë¨2.png)

â¡ï¸ íšŒì›ì„ ë©”ëª¨ë¦¬ê°€ ì•„ë‹Œ ì‹¤ì œ DB ì—ì„œ ì¡°íšŒí•˜ê³ , ì •ë¥  í• ì¸ ì •ì±…(ì£¼ë¬¸ ê¸ˆì•¡ì— ë”°ë¼ % í• ì¸)ì„ ì§€ì›í•´ë„ ì£¼ë¬¸ ì„œë¹„ìŠ¤ë¥¼ ë³€ê²½í•˜ì§€ ì•Šì•„ë„ ë¨

â¡ï¸ ì—­í• ë“¤ì˜ í˜‘ë ¥ ê´€ê³„ ì¬ì‚¬ìš© ê°€ëŠ¥

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ì£¼ë¬¸ê³¼ í• ì¸ ë„ë©”ì¸ ê°œë°œ

1. hello.core íŒ¨í‚¤ì§€ì— discount ì´ë¦„ì˜ Package ìƒì„±
2. ë§Œë“  discount íŒ¨í‚¤ì§€ì— DiscountPolicy ì´ë¦„ì˜ Interface ìƒì„±

```java
package hello.core.discount;

import hello.core.member.Member;

public interface DiscountPolicy {

    // return í• ì¸ ëŒ€ìƒ ê¸ˆì•¡
    int discount(Member member, int price);
}
```

3. discount íŒ¨í‚¤ì§€ì— FixDiscountPolicy ì´ë¦„ì˜ Class ìƒì„± (DiscountPolicy êµ¬í˜„ì²´)

```java
package hello.core.discount;

import hello.core.member.Grade;
import hello.core.member.Member;

public class FixDiscountPolicy implements DiscountPolicy{

    private int discountFixAmount = 1000; // 1000ì› í• ì¸

    @Override
    public int discount(Member member, int price) {
        if (member.getGrade() == Grade.VIP) { // Enum ë¹„êµ ==
            return discountFixAmount;
        } else {
            return 0;
        }
    }
}
```

4. hello.core íŒ¨í‚¤ì§€ì— order ì´ë¦„ì˜ Package ìƒì„±
5. ë§Œë“  order íŒ¨í‚¤ì§€ì— Order ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.order;

public class Order {
    private Long memberId;
    private String itemName;
    private int itemPrice;
    private int discountPrice;

    public Order(Long memberId, String itemName, int itemPrice, int discountPrice) {
        this.memberId = memberId;
        this.itemName = itemName;
        this.itemPrice = itemPrice;
        this.discountPrice = discountPrice;
    }

    public int calculatePrice() {
        return itemPrice - discountPrice;
    }

    public Long getMemberId() {
        return memberId;
    }

    public void setMemberId(Long memberId) {
        this.memberId = memberId;
    }

    public String getItemName() {
        return itemName;
    }

    public void setItemName(String itemName) {
        this.itemName = itemName;
    }

    public int getItemPrice() {
        return itemPrice;
    }

    public void setItemPrice(int itemPrice) {
        this.itemPrice = itemPrice;
    }

    public int getDiscountPrice() {
        return discountPrice;
    }

    public void setDiscountPrice(int discountPrice) {
        this.discountPrice = discountPrice;
    }

    @Override
    public String toString() {
        return "Order{" +
                "memberId=" + memberId +
                ", itemName='" + itemName + '\'' +
                ", itemPrice=" + itemPrice +
                ", discountPrice=" + discountPrice +
                '}';
    }
}
```

6. order íŒ¨í‚¤ì§€ì— OrderService ì´ë¦„ì˜ Interface ìƒì„±

```java
package hello.core.order;

public interface OrderService {
    Order createOrder(Long memberId, String itemName, int itemPrice);

}
```

7. order íŒ¨í‚¤ì§€ì— OrderServiceImpl ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.order;

import hello.core.member.Member;
import hello.core.discount.DiscountPolicy;
import hello.core.discount.FixDiscountPolicy;
import hello.core.member.MemberRepository;
import hello.core.member.MemoryMemberRepository;

public class OrderServiceImpl implements OrderService{

    private final MemberRepository memberRepository = new MemoryMemberRepository();
    private final DiscountPolicy discountPolicy = new FixDiscountPolicy();

    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        Member member = memberRepository.findById(memberId);
        int discountPrice = discountPolicy.discount(member, itemPrice);

        return new Order(memberId, itemName, itemPrice, discountPrice);
    }
}
```

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ì£¼ë¬¸ê³¼ í• ì¸ ë„ë©”ì¸ ì‹¤í–‰ê³¼ í…ŒìŠ¤íŠ¸

1. main/java/hello.core ì— OrderApp ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core;

import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import hello.core.order.Order;
import hello.core.order.OrderService;
import hello.core.order.OrderServiceImpl;

public class OrderApp {
    public static void main(String[] args) {
        MemberService memberService = new MemberServiceImpl();
        OrderService orderService = new OrderServiceImpl();

        Long memberId = 1L;
        Member member = new Member(memberId, "memberA", Grade.VIP);
        memberService.join(member);

        Order order = orderService.createOrder(memberId, "itemA", 10000);

        System.out.println("order = " + order);
        System.out.println("order.calculatePrice = " + order.calculatePrice());
    }
}
```

- Run

![Untitled](img/OrderApp.png)

2. test/java/hello.core ì— order ì´ë¦„ì˜ Package ìƒì„±
3. ë§Œë“  order íŒ¨í‚¤ì§€ì— OrderServiceTest ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.order;

import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.Test;

public class OrderServiceTest {

    MemberService memberService = new MemberServiceImpl();
    OrderService orderService = new OrderServiceImpl();

    @Test
    void createOrder() {
        Long memberId = 1L;
        Member member = new Member(memberId, "memberA", Grade.VIP);
        memberService.join(member);

        Order order = orderService.createOrder(memberId, "itemA", 10000);
        Assertions.assertThat(order.getDiscountPrice()).isEqualTo(1000);
    }
}
```

- Run

![Untitled](img/OrderServiceTest.png)

â†’ ì„±ê³µ !

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ğŸ¾ğŸ¾ìŠ¤í”„ë§ í•µì‹¬ ì›ë¦¬ ì´í•´2 - ê°ì²´ ì§€í–¥ ì›ë¦¬ ì ìš©ğŸ¾ğŸ¾

# ìƒˆë¡œìš´ í• ì¸ ì •ì±… ê°œë°œ

### ìƒˆë¡œìš´ í• ì¸ ì •ì±…ì„ í™•ì¥í•´ë³´ì

- ê³ ì • í• ì¸ â†’ ì •ë¥  í• ì¸ ì •ì±…

1. discount íŒ¨í‚¤ì§€ì— RateDiscountPolicy ì´ë¦„ì˜ Class ìƒì„± (DiscountPolicy êµ¬í˜„ì²´)

```java
package hello.core.discount;

import hello.core.member.Grade;
import hello.core.member.Member;

public class RateDiscountPolicy implements DiscountPolicy{

    // ctrl + shift + t : í…ŒìŠ¤íŠ¸ ë§Œë“¤ê¸°
    private int discountPercent = 10;

    @Override
    public int discount(Member member, int price) {
        if (member.getGrade() == Grade.VIP) {
            return price * discountPercent / 100;
        } else {
            return 0;
        }
    }
}
```

2. test/java/hello.core/discount ì— RateDiscountPolicyTest ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.discount;

import hello.core.member.Grade;
import hello.core.member.Member;
import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.*;

class RateDiscountPolicyTest {

    RateDiscountPolicy discountPolicy = new RateDiscountPolicy();

    @Test
    @DisplayName("VIP ëŠ” 10% í• ì¸ì´ ì ìš©ë˜ì–´ì•¼ í•œë‹¤")
    void vip_o() {
        // given
        Member member = new Member(1L, "memberVIP", Grade.VIP);

        // when
        int discount = discountPolicy.discount(member, 10000);

        // then
        Assertions.assertThat(discount).isEqualTo(1000);
    }

    @Test
    @DisplayName("VIP ê°€ ì•„ë‹ˆë©´ í• ì¸ì´ ì ìš©ë˜ì§€ ì•Šì•„ì•¼ í•œë‹¤")
    void vip_x() {
        // given
        Member member = new Member(2L, "memberBASIC", Grade.BASIC);

        // when
        int discount = discountPolicy.discount(member, 10000);

        // then
        Assertions.assertThat(discount).isEqualTo(0);
    }
}
```

- Run

![Untitled](img/RateDiscountPolicyTest.png)

â†’ ì„±ê³µ!

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ìƒˆë¡œìš´ í• ì¸ ì •ì±… ì ìš©ê³¼ ë¬¸ì œì 

- ë°©ê¸ˆ ì¶”ê°€í•œ í• ì¸ ì •ì±… ì ìš©í•˜ê¸°

â†’ OrderServiceImpl ì½”ë“œ ìˆ˜ì •

```java
...
public class OrderServiceImpl implements OrderService{

    private final MemberRepository memberRepository = new MemoryMemberRepository();
    // private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
    private final DiscountPolicy discountPolicy = new RateDiscountPolicy();

    ...
}
```

### ë¬¸ì œì 

- ì—­í• ê³¼ êµ¬í˜„ ë¶„ë¦¬ â†’ OK
- ë‹¤í˜•ì„± í™œìš© & ì¸í„°í˜ì´ìŠ¤ì™€ êµ¬í˜„ ê°ì²´ ë¶„ë¦¬ â†’ OK
- OCP, DIP ê°ì²´ì§€í–¥ ì„¤ê³„ ì›ì¹™ ì¤€ìˆ˜ â†’ X
  - DIP : êµ¬ì²´(êµ¬í˜„) í´ë˜ìŠ¤ì— ì˜ì¡´
    - ì¶”ìƒ(ì¸í„°í˜ì´ìŠ¤) ì˜ì¡´ : DiscountPolicy
    - êµ¬ì²´(êµ¬í˜„) í´ë˜ìŠ¤ : FixDiscountPolicy, RateDiscountPolicy
  - OCP : ê¸°ëŠ¥ í™•ì¥, ë³€ê²½ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œì— ì˜í–¥

- ê¸°ëŒ€í–ˆë˜ ì˜ì¡´ ê´€ê³„

![Untitled](img/ê¸°ëŒ€í–ˆë˜_ì˜ì¡´_ê´€ê³„.png)

â†’ DiscountPolicy ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´í•˜ê¸°

- ì‹¤ì œ ì˜ì¡´ ê´€ê³„

![Untitled](img/ì‹¤ì œ_ì˜ì¡´_ê´€ê³„.png)

â†’ í´ë¼ì´ì–¸íŠ¸ OrderServiceImpl ì€ DiscountPolicy ì¸í„°í˜ì´ìŠ¤ ë¿ë§Œ ì•„ë‹ˆë¼ FixDiscountPolicy ì¸ êµ¬ì²´ í´ë˜ìŠ¤ë„ í•¨ê»˜ ì˜ì¡´ (**DIP ìœ„ë°˜**)

- ì •ì±… ë³€ê²½ ì‹œ

![Untitled](img/ì •ì±…_ë³€ê²½_ì‹œ_OCP_ìœ„ë°˜.png)

â†’ FixDiscountPolicy ë¥¼ RateDiscountPolicy ë¡œ ë³€ê²½í•˜ëŠ” ìˆœê°„ OrderServiceImpl ì˜ ì†ŒìŠ¤ ì½”ë“œê°€ ë³€ê²½ë¨ (**OCP ìœ„ë°˜**)

### ë¬¸ì œ í•´ê²° ë°©ë²•

- ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´í•˜ë„ë¡ ì„¤ê³„ ë³€ê²½í•˜ê¸°

â†’ ì½”ë“œ ë³€ê²½

```java
...
public class OrderServiceImpl implements OrderService{

    private final MemberRepository memberRepository = new MemoryMemberRepository();
    // private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
    // private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
    private DiscountPolicy discountPolicy;

    ...
}
```

â¡ï¸ ì‹¤í–‰ ì‹œ NPE (Null Pointer Exception) ë°œìƒ

- ë¬¸ì œ í•´ê²°ì„ ìœ„í•´ì„œëŠ” ëˆ„êµ°ê°€ê°€ í´ë¼ì´ì–¸íŠ¸ì¸ OrderServiceImpl ì— DiscountPolicy ì˜ êµ¬í˜„ ê°ì²´ë¥¼ ëŒ€ì‹  ìƒì„±í•˜ê³  ì£¼ì…í•´ì£¼ì–´ì•¼ í•¨

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# â­ ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬

â†’ ê¸°íšì ë§Œë“¤ê¸°

### App Config ë“±ì¥

- ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì „ì²´ ë™ì‘ ë°©ì‹ì„ êµ¬ì„±í•˜ê¸° ìœ„í•´, êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±í•˜ê³ , ì—°ê²°í•˜ëŠ” ì±…ì„ì„ ê°€ì§€ëŠ” ë³„ë„ì˜ ì„¤ì • í´ë˜ìŠ¤

1. hello.core íŒ¨í‚¤ì§€ì— AppConfig ì´ë¦„ì„ ê°€ì§„ Class ìƒì„±
- ìƒì„±ì ì£¼ì…

```java
package hello.core;

import hello.core.discount.FixDiscountPolicy;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import hello.core.member.MemoryMemberRepository;
import hello.core.order.OrderService;
import hello.core.order.OrderServiceImpl;

public class AppConfig {
    // ìƒì„±ì ì£¼ì…
    public MemberService memberService() {
        return new MemberServiceImpl(new MemoryMemberRepository());
    }

    public OrderService orderService() {
        return new OrderServiceImpl(new MemoryMemberRepository(), new FixDiscountPolicy());
    }
}
```

- AppConfig ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì‹¤ì œ ë™ì‘ì— í•„ìš”í•œ â€œ**êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±**â€
  - MemberServiceImpl
  - MemoryMemberRepository
  - OrderServiceImpl
  - FixDiscountPolicy
- AppConfig ëŠ” ìƒì„±í•œ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ì˜ ì°¸ì¡°(ë ˆí¼ëŸ°ìŠ¤)ë¥¼ â€œ**ìƒì„±ìë¥¼ í†µí•´ì„œ ì£¼ì…(ì—°ê²°)**â€
  - MemberServiceImpl â†’ MemoryMemberRepository
  - OrderServiceImpl â†’ MemoryMemberRepository, FixDiscountPolicy

2. MemberServiceImpl ì½”ë“œ ìˆ˜ì •

```java
...
public class MemberServiceImpl implements MemberService{

    private final MemberRepository memberRepository;

    public MemberServiceImpl(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }

    ...
}
```

- ì„¤ê³„ ë³€ê²½ìœ¼ë¡œ MemberServiceImpl ì€ MemoryMemberRepository ë¥¼ ì˜ì¡´í•˜ì§€ ì•ŠìŒ â¡ï¸ MemberRepository ì¸í„°í˜ì´ìŠ¤ë§Œ ì˜ì¡´ (DIP ë§Œì¡±)
- MemberServiceImpl ëŠ” ìƒì„±ìë¥¼ í†µí•´ ì–´ë–¤ êµ¬í˜„ ê°ì²´ê°€ ë“¤ì–´ì˜¬ì§€ ì•Œ ìˆ˜ ì—†ìŒ (ì™¸ë¶€ - AppConfig ì—ì„œ ê²°ì •)
- MemberServiceImpl ëŠ” **ì˜ì¡´ê´€ê³„ì— ëŒ€í•œ ê³ ë¯¼ì€ ì™¸ë¶€**ì— ë§¡ê¸°ê³  **ì‹¤í–‰ì—ë§Œ ì§‘ì¤‘**


- í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨

![Untitled](img/AppConfig_í´ë˜ìŠ¤_ë‹¤ì´ì–´ê·¸ë¨.png)

â†’ ê°ì²´ì˜ ìƒì„±ê³¼ ì—°ê²°ì€ AppConfig ë‹´ë‹¹

â†’ DIP ì™„ì„± : MemberServiceImpl ì€ MemberRepository ì¸ ì¶”ìƒì—ë§Œ ì˜ì¡´

â†’ ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬ : ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ì—°ê²°í•˜ëŠ” ì—­í• ê³¼ ì‹¤í–‰í•˜ëŠ” ì—­í• ì´ ëª…í™•íˆ ë¶„ë¦¬ë¨

- íšŒì› ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨

![Untitled](img/AppConfig_íšŒì›_ê°ì²´_ë‹¤ì´ì–´ê·¸ë¨.png)

â†’ AppConfig ê°ì²´ëŠ” memoryMemberRepository ê°ì²´ë¥¼ ìƒì„±í•˜ê³ , ê·¸ ì°¸ì¡°ê°’ì„ memberServiceImpl ì„ ìƒì„±í•˜ë©´ì„œ ìƒì„±ìë¡œ ì „ë‹¬

â†’ ì˜ì¡´ ê´€ê³„ ì£¼ì…(DI - Dependency Injection) : í´ë¼ì´ì–¸íŠ¸ì¸ memberServiceImpl ì…ì¥ì—ì„œ ì˜ì¡´ ê´€ê³„ë¥¼ ì™¸ë¶€ì—ì„œ ì£¼ì…í•´ì£¼ëŠ” ê²ƒ ê°™ì´ ë³´ì„

3. OrderServiceImpl ì½”ë“œ ìˆ˜ì •

```java
...
public class OrderServiceImpl implements OrderService{

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }

    ...
}
```

- ì„¤ê³„ ë³€ê²½ìœ¼ë¡œ OrderServiceImpl ì€ FixDiscountPolicy ë¥¼ ì˜ì¡´í•˜ì§€ ì•ŠìŒ â¡ï¸ DiscountPolicy ì¸í„°í˜ì´ìŠ¤ë§Œ ì˜ì¡´ (DIP ë§Œì¡±)
- OrderServiceImpl ëŠ” ìƒì„±ìë¥¼ í†µí•´ ì–´ë–¤ êµ¬í˜„ ê°ì²´ê°€ ë“¤ì–´ì˜¬ì§€ ì•Œ ìˆ˜ ì—†ìŒ (ì™¸ë¶€ - AppConfig ì—ì„œ ê²°ì •)
- OrderServiceImpl ì€ ì´ì œë¶€í„° ì‹¤í–‰ì—ë§Œ ì§‘ì¤‘
- OrderServiceImpl ì—ëŠ” MemoryMemberRepository, FixDiscountPolicy ê°ì²´ì˜ ì˜ì¡´ê´€ê³„ê°€ ì£¼ì…ë¨

### AppConfig ì‹¤í–‰

1. MemberApp ì½”ë“œ ìˆ˜ì •í•˜ê¸°

```java
...
public class MemberApp {
    public static void main(String[] args) {
        AppConfig appConfig = new AppConfig();
        MemberService memberService = appConfig.memberService();
        // MemberService memberService = new MemberServiceImpl();
        
        ...
    }
}
```

2. OrderApp ì½”ë“œ ìˆ˜ì •í•˜ê¸°

```java
...
public class OrderApp {
    public static void main(String[] args) {
        
        AppConfig appConfig = new AppConfig();
        MemberService memberService = appConfig.memberService();
        OrderService orderService = appConfig.orderService();
        // MemberService memberService = new MemberServiceImpl();
        // OrderService orderService = new OrderServiceImpl(memberRepository, discountPolicy);

        ...
    }
}
```

3. MemberServiceTest ì½”ë“œ ìˆ˜ì •í•˜ê¸°

```java
...
public class MemberServiceTest {

    MemberService memberService;

    // ê° í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì „ í˜¸ì¶œëœë‹¤
    @BeforeEach
    public void beforeEach() {
        AppConfig appConfig = new AppConfig();
        memberService = appConfig.memberService();
    }

    ...
    }
}
```

4. OrderServiceTest ì½”ë“œ ìˆ˜ì •í•˜ê¸°

```java
...
public class OrderServiceTest {

    MemberService memberService;
    OrderService orderService;

    @BeforeEach
    public void beforeEach() {
        AppConfig appConfig = new AppConfig();
        memberService = appConfig.memberService();
        orderService = appConfig.orderService();
    }

    ...
}
```

- Run

![Untitled](img/AppConfigTest.png)

â†’ ì„±ê³µ !

- AppConfig ë¥¼ í†µí•´ ê´€ì‹¬ì‚¬ ë¶„ë¦¬
- AppConfig ëŠ” êµ¬ì²´ í´ë˜ìŠ¤ë¥¼ ì„ íƒ â†’ ì „ì²´ êµ¬ì„± ì±…ì„(ì• í”Œë¦¬ì¼€ì´ì…˜ ë™ì‘ ë°©ì‹)
- OrderServiceImpl ì€ ê¸°ëŠ¥ì„ ì‹¤í–‰í•˜ëŠ” ì±…ì„ë§Œ

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# AppConfig ë¦¬íŒ©í„°ë§

- í˜„ì¬ AppConfig : **ì¤‘ë³µ** ë°œìƒ, **ì—­í• **ì— ë”°ë¥¸ **êµ¬í˜„** ë¶ˆëª…í™•

â¡ï¸ ì—­í• ì„ ë“œëŸ¬ë‚˜ê²Œ í•˜ëŠ” ê²ƒì´ ì¤‘ìš”

1. AppConfig ì½”ë“œ ìˆ˜ì •í•˜ê¸°

```java
...
public class AppConfig {
    // ìƒì„±ì ì£¼ì…
    public MemberService memberService() {
        // ctrl + alt + m ìœ¼ë¡œ ë³€ê²½
        return new MemberServiceImpl(memberRepository());
    }

    private MemoryMemberRepository memberRepository() {
        return new MemoryMemberRepository();
    }

    public OrderService orderService() {
        return new OrderServiceImpl(memberRepository(), discountPolicy());
    }

    private DiscountPolicy discountPolicy() {
        return new FixDiscountPolicy();
    }
}
```

- new MemoryMemberRepository() ì¤‘ë³µì´ ì œê±° â†’ MemoryMemberRepository ë¥¼ ë‹¤ë¥¸ êµ¬í˜„ì²´ë¡œ ë³€ê²½ ì‹œ í•œ ë¶€ë¶„ë§Œ ë³€ê²½í•˜ë©´ ë¨
- AppConfig ì—­í• ê³¼ êµ¬í˜„ í´ë˜ìŠ¤ ëª…í™• â¡ï¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´ êµ¬ì„± ë¹ ë¥´ê²Œ íŒŒì•… ê°€ëŠ¥

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ìƒˆë¡œìš´ êµ¬ì¡°ì™€ í• ì¸ ì •ì±… ì ìš©

- ì •ì•¡ í• ì¸ ì •ì±… â¡ï¸ ì •ë¥  í• ì¸ ì •ì±… ë³€ê²½í•˜ê¸°
- FixDiscountPolicy â†’ RateDiscountPolicy

â¡ï¸ AppConfig ë“±ì¥ : ì• í”Œë¦¬ì¼€ì´ì…˜ì´ í¬ê²Œ ì‚¬ìš© ì˜ì—­ê³¼, ê°ì²´ë¥¼ ìƒì„±í•˜ê³  êµ¬ì„±í•˜ëŠ” ì˜ì—­ìœ¼ë¡œ ë¶„ë¦¬ë¨

- ì‚¬ìš©, êµ¬ì„±ì˜ ë¶„ë¦¬

![Untitled](img/ì‚¬ìš©êµ¬ì„±ë¶„ë¦¬.png)

- í• ì¸ ì •ì±…ì˜ ë³€ê²½

![Untitled](img/í• ì¸ì •ì±…ë³€ê²½.png)

â¡ï¸ FixDiscountPolicy â†’ RateDiscountPolicy ë³€ê²½ : êµ¬ì„± ì˜ì—­ì—ë§Œ ì˜í–¥, ì‚¬ìš© ì˜ì—­ì€ ì˜í–¥ X

1. AppConfig ì½”ë“œ ë³€ê²½í•˜ê¸°

```java
...
public class AppConfig {
    ...
    private DiscountPolicy discountPolicy() {
        // return new FixDiscountPolicy();
        return new RateDiscountPolicy();
    }
}
```

- AppConfig í• ì¸ ì •ì±… ì—­í•  êµ¬í˜„ ë‹´ë‹¹ : FixDiscountPolicy â†’ RateDiscountPolicy
- í• ì¸ ì •ì±…ì„ ë³€ê²½í•´ë„, ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ êµ¬ì„± ì—­í• ì„ ë‹´ë‹¹í•˜ëŠ” AppConfig ë§Œ ë³€ê²½ (**ì‚¬ìš© ì˜ì—­**ì˜ ì–´ë–¤ ì½”ë“œë„ ë³€ê²½ X)
- **êµ¬ì„± ì˜ì—­**ì€ ë³€ê²½ë¨

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ì „ì²´ íë¦„ ì •ë¦¬

### ìƒˆë¡œìš´ í• ì¸ ì •ì±… ê°œë°œ

- ë‹¤í˜•ì„± ë•ë¶„ì— ìƒˆë¡œìš´ ì •ë¥  í• ì¸ ì •ì±… ì½”ë“œë¥¼ ì¶”ê°€ë¡œ ê°œë°œí•˜ëŠ” ê²ƒì€ ë¬¸ì œ ì—†ìŒ

### ìƒˆë¡œìš´ í• ì¸ ì •ì±… ì ìš©ê³¼ ë¬¸ì œì 

- ìƒˆë¡œ ê°œë°œí•œ ì •ë¥  í• ì¸ ì •ì±…ì„ ì ìš© ì‹œ â€œ**í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ**"ì¸ ì£¼ë¬¸ ì„œë¹„ìŠ¤ êµ¬í˜„ì²´ë„ í•¨ê»˜ ë³€ê²½ í•´ì•¼ í•¨
- ì£¼ë¬¸ ì„œë¹„ìŠ¤ í´ë¼ì´ì–¸íŠ¸ê°€ ì¸í„°í˜ì´ìŠ¤ì¸ DiscountPolicy ë¿ë§Œ ì•„ë‹ˆë¼, êµ¬ì²´ í´ë˜ìŠ¤ì¸ FixDiscountPolicy ë„ í•¨ê»˜ ì˜ì¡´ â†’ **DIP ìœ„ë°˜**

### ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬

- ê¸°ì¡´ì—ëŠ” í´ë¼ì´ì–¸íŠ¸ê°€ ì˜ì¡´í•˜ëŠ” ì„œë²„ êµ¬í˜„ ê°ì²´ë¥¼ ì§ì ‘ ìƒì„±, ì‹¤í–‰
- ê¸°íšìì¸ AppConfig ë“±ì¥
- AppConfig ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì „ì²´ ë™ì‘ ë°©ì‹ì„ êµ¬ì„±í•˜ê¸° ìœ„í•´, **êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±**í•˜ê³ , **ì—°ê²°**í•˜ëŠ” ì±…ì„
- ì´ì œë¶€í„° í´ë¼ì´ì–¸íŠ¸ ê°ì²´ëŠ” ìì‹ ì˜ ì—­í• ì„ ì‹¤í–‰í•˜ëŠ” ê²ƒë§Œ ì§‘ì¤‘, ê¶Œí•œì´ ì¤„ì–´ë“¦ (ì±…ì„ì´ ëª…í™•í•´ì§)

### AppConfig ë¦¬íŒ©í„°ë§

- êµ¬ì„± ì •ë³´ì—ì„œ ì—­í• ê³¼ êµ¬í˜„ì„ ëª…í™•í•˜ê²Œ ë¶„ë¦¬
- ì—­í• ì´ ì˜ ë“œëŸ¬ë‚¨
- ì¤‘ë³µ ì œê±°

### ìƒˆë¡œìš´ êµ¬ì¡°ì™€ í• ì¸ ì •ì±… ì ìš©

- ì •ì±… í• ì¸ ì •ì±… â†’ ì •ë¥  í• ì¸ ì •ì±…ìœ¼ë¡œ ë³€ê²½
- AppConfigì˜ ë“±ì¥ìœ¼ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ í¬ê²Œ ì‚¬ìš© ì˜ì—­ê³¼, ê°ì²´ë¥¼ ìƒì„±í•˜ê³  êµ¬ì„±í•˜ëŠ” ì˜ì—­ìœ¼ë¡œ ë¶„ë¦¬ë¨
- í• ì¸ ì •ì±…ì„ ë³€ê²½í•´ë„ AppConfig ê°€ ìˆëŠ” êµ¬ì„± ì˜ì—­ë§Œ ë³€ê²½, ì‚¬ìš© ì˜ì—­ì€ ë³€ê²½ x

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ì¢‹ì€ ê°ì²´ ì§€í–¥ ì„¤ê³„ì˜ 5ê°€ì§€ ì›ì¹™ì˜ ì ìš©

- ì—¬ê¸°ì„œëŠ” 3ê°€ì§€ SRP, DIP, OCP ê°€ ì ìš©ë˜ì–´ ìˆìŒ

### SRP ë‹¨ì¼ ì±…ì„ ì›ì¹™

> í•œ í´ë˜ìŠ¤ëŠ” í•˜ë‚˜ì˜ ì±…ì„ë§Œ ê°€ì ¸ì•¼ í•œë‹¤

- í´ë¼ì´ì–¸íŠ¸ ê°ì²´ëŠ” ì§ì ‘ êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±í•˜ê³ , ì—°ê²°í•˜ê³ , ì‹¤í–‰í•˜ëŠ” ë‹¤ì–‘í•œ ì±…ì„ì„ ê°€ì§€ê³  ìˆìŒ
- SRP ë‹¨ì¼ ì±…ì„ ì›ì¹™ì„ ë”°ë¥´ë©´ì„œ ê´€ì‹¬ì‚¬ ë¶„ë¦¬
- êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ì—°ê²°í•˜ëŠ” ì±…ì„ì€ AppConfig ê°€ ë‹´ë‹¹
- í´ë¼ì´ì–¸íŠ¸ ê°ì²´ëŠ” ì‹¤í–‰í•˜ëŠ” ì±…ì„ë§Œ ë‹´ë‹¹

### DIP ì˜ì¡´ê´€ê³„ ì—­ì „ ì›ì¹™

> í”„ë¡œê·¸ë˜ë¨¸ëŠ” â€œì¶”ìƒí™”ì— ì˜ì¡´í•´ì•¼ì§€, êµ¬ì²´í™”ì— ì˜ì¡´í•˜ë©´ ì•ˆëœë‹¤â€
ì˜ì¡´ì„± ì£¼ì…ì€ ì´ ì›ì¹™ì„ ë”°ë¥´ëŠ” ë°©ë²• ì¤‘ í•˜ë‚˜ë‹¤

- ê¸°ì¡´ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ : DiscountPolicy ì¸í„°í˜ì´ìŠ¤ + FixDiscountPolicy êµ¬ì²´í™” í´ë˜ìŠ¤ ì˜ì¡´
- í´ë¼ì´ì–¸íŠ¸ ì½”ë“œê°€ DiscountPolicy ì¶”ìƒí™” ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´í•˜ë„ë¡ ì½”ë“œ ë³€ê²½
- í•˜ì§€ë§Œ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œëŠ” ì¸í„°í˜ì´ìŠ¤ë§Œìœ¼ë¡œëŠ” ì‹¤í–‰ ë¶ˆê°€
- AppConfig ê°€ FixDiscountPolicy ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ ëŒ€ì‹  ìƒì„±í•œ í›„ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œì— ì˜ì¡´ ê´€ê³„ ì£¼ì…

### OCP

> ì†Œí”„íŠ¸ì›¨ì–´ ìš”ì†ŒëŠ” í™•ì¥ì—ëŠ” ì—´ë ¤ ìˆìœ¼ë‚˜ ë³€ê²½ì—ëŠ” ë‹«í˜€ ìˆì–´ì•¼ í•œë‹¤

- ë‹¤í˜•ì„± ì‚¬ìš©í•˜ê³  í´ë¼ì´ì–¸íŠ¸ê°€ DIP ë¥¼ ì§€í‚´
- ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‚¬ìš© ì˜ì—­ê³¼ êµ¬ì„± ì˜ì—­ìœ¼ë¡œ ë‚˜ëˆ”
- AppConfig ê°€ ì˜ì¡´ê´€ê³„ë¥¼ FixDiscountPolicy â†’ RateDiscountPolicy ë¡œ ë³€ê²½í•´ì„œ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œì— ì£¼ì…í•˜ë¯€ë¡œ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œëŠ” ë³€ê²½í•˜ì§€ ì•Šì•„ë„ ë¨
- **ì†Œí”„íŠ¸ì›¨ì–´ ìš”ì†Œë¥¼ ìƒˆë¡­ê²Œ í™•ì¥í•´ë„ ì‚¬ìš© ì˜ì—­ì˜ ë³€ê²½ì€ ë‹«í˜€ ìˆìŒ**

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# IoC, DI, ê·¸ë¦¬ê³  ì»¨í…Œì´ë„ˆ

### ì œì–´ì˜ ì—­ì „ IoC (Inversion of Control)

> í”„ë¡œê·¸ë¨ì˜ ì œì–´ íë¦„ì„ ì§ì ‘ ì œì–´í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ ì™¸ë¶€ì—ì„œ ê´€ë¦¬í•˜ëŠ” ê²ƒ

- ê¸°ì¡´ í”„ë¡œê·¸ë¨ : í´ë¼ì´ì–¸íŠ¸ êµ¬í˜„ ê°ì²´ê°€ ìŠ¤ìŠ¤ë¡œ í•„ìš”í•œ ì„œë²„ êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±í•˜ê³ , ì—°ê²°í•˜ê³  ì‹¤í–‰ ( êµ¬í˜„ ê°ì²´ê°€ í”„ë¡œê·¸ë¨ì˜ ì œì–´ íë¦„ì„ ìŠ¤ìŠ¤ë¡œ ì¡°ì¢… )
- AppConfig ë“±ì¥ ì´í›„ : êµ¬í˜„ ê°ì²´ëŠ” ìì‹ ì˜ ë¡œì§ì„ ì‹¤í–‰í•˜ëŠ” ì—­í• ë§Œ ë‹´ë‹¹ ( í”„ë¡œê·¸ë¨ì˜ ì œì–´ íë¦„ì€ AppConfig ë‹´ë‹¹ )
  - ex. OrderServiceImpl : í•„ìš”í•œ ì¸í„°í˜ì´ìŠ¤ë“¤ì„ í˜¸ì¶œí•˜ì§€ë§Œ ì–´ë–¤ êµ¬í˜„ ê°ì²´ë“¤ì´ ì‹¤í–‰ë ì§€ ëª¨ë¥¸ë‹¤
- AppConfig
  - í”„ë¡œê·¸ë¨ ì œì–´ íë¦„ì— ëŒ€í•œ ê¶Œí•œ
  - OrderServiceImpl ìƒì„±
  - OrderService ì¸í„°í˜ì´ìŠ¤ì˜ ë‹¤ë¥¸ êµ¬í˜„ ê°ì²´ ìƒì„± ë° ì‹¤í–‰

- í”„ë ˆì„ì›Œí¬ vs. ë¼ì´ë¸ŒëŸ¬ë¦¬
  - í”„ë ˆì„ì›Œí¬ : ë‚´ê°€ ì‘ì„±í•œ ì½”ë“œë¥¼ ì œì–´í•˜ê³ , ëŒ€ì‹  ì‹¤í–‰ (ex. JUnit)
  - ë¼ì´ë¸ŒëŸ¬ë¦¬ : ë‚´ê°€ ì‘ì„±í•œ ì½”ë“œê°€ ì§ì ‘ ì œì–´ì˜ íë¦„ì„ ë‹´ë‹¹


### ì˜ì¡´ ê´€ê³„ ì£¼ì… DI (Dependency Injection)

- OrderServiceImpl : DiscountPolicy ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´, ì–´ë–¤ êµ¬í˜„ ê°ì²´ê°€ ì‚¬ìš©ë ì§€ëŠ” ëª¨ë¦„
- ì˜ì¡´ ê´€ê³„ : ì •ì ì¸ í´ë˜ìŠ¤ ì˜ì¡´ ê´€ê³„ or ì‹¤í–‰ ì‹œì ì— ê²°ì •ë˜ëŠ” ë™ì ì¸ ê°ì²´(ì¸ìŠ¤í„´ìŠ¤) ì˜ì¡´ ê´€ê³„

- ì •ì ì¸ í´ë˜ìŠ¤ ì˜ì¡´ ê´€ê³„
  - í´ë˜ìŠ¤ê°€ ì‚¬ìš©í•˜ëŠ” import ì½”ë“œë§Œ ë³´ê³  ì˜ì¡´ê´€ê³„ ì‰½ê²Œ íŒŒì•… ê°€ëŠ¥ (ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ì§€ ì•Šì•„ë„ ë¶„ì„ ê°€ëŠ¥)
  - OrderServiceImpl -(ì˜ì¡´)â†’ MemberRepository, DiscountPolicy

![Untitled](img/ì •ì ì¸_í´ë˜ìŠ¤_ì˜ì¡´ê´€ê³„.png)

- ë™ì ì¸ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ ì˜ì¡´ ê´€ê³„
  - ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ì‹œì ì—ì„œ ì‹¤ì œ ìƒì„±ëœ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ì˜ ì°¸ì¡°ê°€ ì—°ê²°ëœ ì˜ì¡´ ê´€ê³„
  - ì˜ì¡´ ê´€ê³„ ì£¼ì… : ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ì‹œì ì— ì™¸ë¶€ì—ì„œ ì‹¤ì œ êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  í´ë¼ì´ì–¸íŠ¸ì— ì „ë‹¬í•˜ì—¬, í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ì˜ ì‹¤ì œ ì˜ì¡´ ê´€ê³„ê°€ ì—°ê²°ë˜ëŠ” ê²ƒ
  - ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± í›„, ê·¸ ì°¸ì¡°ê°’ì„ ì „ë‹¬í•´ì„œ ì—°ê²°
  - ì˜ì¡´ê´€ê³„ ì£¼ì… ì‚¬ìš© ì‹œ
    - í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ ë³€ê²½ X â†’ í´ë¼ì´ì–¸íŠ¸ê°€ í˜¸ì¶œí•˜ëŠ” ëŒ€ìƒì˜ íƒ€ì… ì¸ìŠ¤í„´ìŠ¤ ë³€ê²½
    - â­ ì •ì ì¸ í´ë˜ìŠ¤ ì˜ì¡´ ê´€ê³„ ë³€ê²½ X â†’ë™ì ì¸ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ ì˜ì¡´ ê´€ê³„ ì‰½ê²Œ ë³€ê²½

![Untitled](img/ë™ì ì¸_ê°ì²´_ì˜ì¡´ê´€ê³„.png)

### IoC ì»¨í…Œì´ë„ˆ, DI ì»¨í…Œì´ë„ˆ

- AppConfig ì²˜ëŸ¼ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ë©´ì„œ ì˜ì¡´ ê´€ê³„ë¥¼ ì—°ê²°í•´ì£¼ëŠ” ê²ƒ
- ì˜ì¡´ ê´€ê³„ ì£¼ì…ì— ì´ˆì ì„ ë§ì¶”ì–´ ìµœê·¼ì—ëŠ” ì£¼ë¡œ DI ì»¨í…Œì´ë„ˆë¼ í•¨
- ë˜ëŠ” ì–´ìƒ˜ë¸”ëŸ¬, ì˜¤ë¸Œì íŠ¸ íŒ©í† ë¦¬ ë“±ìœ¼ë¡œ ë¶ˆë¦¼

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ìŠ¤í”„ë§ìœ¼ë¡œ ì „í™˜í•˜ê¸°

1. AppConfig ì½”ë“œ ë³€ê²½í•˜ê¸°

```java
...
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
public class AppConfig {

    @Bean
    public MemberService memberService() {...}

    @Bean
    public MemoryMemberRepository memberRepository() {...}

    @Bean
    public OrderService orderService() {...}

    @Bean
    public DiscountPolicy discountPolicy() {...}
}
```

2. MemberApp ì½”ë“œ ë³€ê²½í•˜ê¸°

```java
...
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

public class MemberApp {
    public static void main(String[] args) {
        // AppConfig appConfig = new AppConfig();
        // MemberService memberService = appConfig.memberService();

        ApplicationContext applicationContext = new AnnotationConfigApplicationContext(AppConfig.class);
        MemberService memberService = applicationContext.getBean("memberService", MemberService.class);

        ...
    }
}
```

- Run

![Untitled](img/ìŠ¤í”„ë§_ì „í™˜.png)

3. OrderApp ì½”ë“œ ë³€ê²½í•˜ê¸°

```java
...
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

public class OrderApp {
    public static void main(String[] args) {

        // AppConfig appConfig = new AppConfig();
        // MemberService memberService = appConfig.memberService();
        // OrderService orderService = appConfig.orderService();

        ApplicationContext applicationContext = new AnnotationConfigApplicationContext(AppConfig.class);
        MemberService memberService = applicationContext.getBean("memberService", MemberService.class);
        OrderService orderService = applicationContext.getBean("orderService", OrderService.class);

        ...
    }
}
```

- Run

![Untitled](img/ìŠ¤í”„ë§_ì „í™˜2.png)

### ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ

- ApplicationContext = ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ
- @Configuration ì´ ë¶™ì€ AppConfig ë¥¼ ì„¤ì •(êµ¬ì„±) ì •ë³´ë¡œ ì‚¬ìš©
- @Bean ì´ ì íŒ ë©”ì„œë“œë¥¼ ëª¨ë‘ í˜¸ì¶œí•´ ë°˜í™˜ëœ ê°ì²´ë¥¼ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ë“±ë¡ â†’ ìŠ¤í”„ë§ ë¹ˆ
- ìŠ¤í”„ë§ ë¹ˆ ì´ë¦„ : @Bean ì´ ë¶™ì€ ë©”ì„œë“œ ëª… (ex. memberService, orderService)
- ìŠ¤í”„ë§ ë¹ˆ ì°¾ê¸° : applicationContext.getBean() ë©”ì„œë“œ ì‚¬ìš©

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ğŸ¾ğŸ¾ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì™€ ìŠ¤í”„ë§ ë¹ˆğŸ¾ğŸ¾

# ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„±

â˜‘ï¸ ì»¨í…Œì´ë„ˆ : ì‚¬ìš©í•˜ëŠ” ê°ì²´ë“¤ì„ ë‹´ê³  ìˆìŒ

- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ìƒì„±ë˜ëŠ” ê³¼ì •

```java
ApplicationContext applicationContext = new AnnotationConfigApplicationContext(AppConfig.class);
```

â†’ ApplicationContext : ì¸í„°í˜ì´ìŠ¤, ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ

â†’ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ë§Œë“œëŠ” ë°©ë²• : XML ê¸°ë°˜, ì• ë…¸í…Œì´ì…˜ ê¸°ë°˜ ìë°” ì„¤ì • í´ë˜ìŠ¤

â†’ AppConfig ì‚¬ìš©í–ˆë˜ ë°©ì‹ : ì• ë…¸í…Œì´ì…˜ ê¸°ë°˜ ìë°” ì„¤ì • í´ë˜ìŠ¤

- ìë°” ì„¤ì • í´ë˜ìŠ¤ ê¸°ë°˜ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ(ApplicationContext) ë§Œë“¤ê¸°
  - êµ¬í˜„ì²´ : new AnnotationConfigApplicationContext(AppConfig.class);

> ì°¸ê³  : ì •í™•íˆëŠ” ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ë¶€ë¥¼ ë•Œ BeanFactory, ApplicationContext ë¡œ êµ¬ë¶„í•´ì„œ ì´ì•¼ê¸°í•œë‹¤. BeanFactory ë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ëŠ” ê±°ì˜ ì—†ìœ¼ë©°, ì¼ë°˜ì ìœ¼ë¡œ ApplicationContext ë¥¼ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¼ í•œë‹¤.
>

## ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„± ê³¼ì •

### 1. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„±

![Untitled](img/ìŠ¤í”„ë§_ì»¨í…Œì´ë„ˆ_ìƒì„±.png)

- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„± ì‹œ êµ¬ì„± ì •ë³´ ì§€ì • : AppConfig.class

### 2. ìŠ¤í”„ë§ ë¹ˆ ë“±ë¡

![Untitled](img/ìŠ¤í”„ë§_ë¹ˆ_ë“±ë¡.png)

- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” íŒŒë¼ë¯¸í„°ë¡œ ë„˜ì–´ì˜¨ ì„¤ì • í´ë˜ìŠ¤ ì •ë³´ë¥¼ ì´ìš©í•´ ìŠ¤í”„ë§ ë¹ˆ ë“±ë¡
- ë¹ˆ ì´ë¦„ = ë©”ì„œë“œ ì´ë¦„
- ë¹ˆ ì´ë¦„ ì§ì ‘ ë¶€ì—¬ ê°€ëŠ¥ (ex. @Bean(name=â€memberService2â€))

> ì£¼ì˜ : ë¹ˆ ì´ë¦„ì€ í•­ìƒ ë‹¤ë¥¸ ì´ë¦„ì„ ë¶€ì—¬í•´ì•¼ í•œë‹¤. ê°™ì€ ì´ë¦„ ë¶€ì—¬ ì‹œ, ë‹¤ë¥¸ ë¹ˆì´ ë¬´ì‹œë˜ê±°ë‚˜, ê¸°ì¡´ ë¹ˆì„ ë®ì–´ë²„ë¦¬ê±°ë‚˜, ì„¤ì •ì— ë”°ë¼ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.
>

### 3. ìŠ¤í”„ë§ ë¹ˆ ì˜ì¡´ê´€ê³„ ì„¤ì • - ì¤€ë¹„

![Untitled](img/ìŠ¤í”„ë§_ë¹ˆ_ì˜ì¡´ê´€ê³„_ì¤€ë¹„.png)

### 4. ìŠ¤í”„ë§ ë¹ˆ ì˜ì¡´ê´€ê³„ ì„¤ì • - ì™„ë£Œ

![Untitled](img/ìŠ¤í”„ë§_ë¹ˆ_ì˜ì¡´ê´€ê³„_ì™„ë£Œ.png)

- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” ì„¤ì • ì •ë³´ë¥¼ ì°¸ê³ í•˜ì—¬ ì˜ì¡´ê´€ê³„ ì£¼ì… (DI)

> ì°¸ê³  : ìŠ¤í”„ë§ì€ ë¹ˆì„ ìƒì„±í•˜ê³ , ì˜ì¡´ê´€ê³„ë¥¼ ì£¼ì…í•˜ëŠ” ë‹¨ê³„ê°€ ë‚˜ëˆ„ì–´ì ¸ ìˆë‹¤. ê·¸ëŸ°ë° ì´ë ‡ê²Œ ìë°” ì½”ë“œë¡œ ìŠ¤í”„ë§ ë¹ˆì„ ë“±ë¡í•˜ë©´ ìƒì„±ìë¥¼ í˜¸ì¶œí•˜ë©´ì„œ ì˜ì¡´ê´€ê³„ ì£¼ì…ë„ í•œ ë²ˆì— ì²˜ë¦¬ëœë‹¤. (ì´í•´ë¥¼ ìœ„í•œ ì„¤ê³„)
>

> ì •ë¦¬ : ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ìƒì„±í•˜ê³ , ì„¤ì •(êµ¬ì„±) ì •ë³´ë¥¼ ì°¸ê³ í•´ ìŠ¤í”„ë§ ë¹ˆì„ ë“±ë¡í•˜ê³ , ì˜ì¡´ê´€ê³„ë¥¼ ì„¤ì •í–ˆë‹¤.
>

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ì»¨í…Œì´ë„ˆì— ë“±ë¡ëœ ëª¨ë“  ë¹ˆ ì¡°íšŒ

- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ì‹¤ì œë¡œ ìŠ¤í”„ë§ ë¹ˆì´ ë“±ë¡ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ê¸°

1. test/java/hello.core ì— beanfind ì´ë¦„ì˜ Package ìƒì„±
2. ë§Œë“  beanfind íŒ¨í‚¤ì§€ì— ApplicationContextInfoTest ì´ë¦„ì˜ Class ìƒì„±

### ëª¨ë“  ë¹ˆ ì¶œë ¥í•˜ê¸°

â¡ï¸ ì‹¤í–‰ ì‹œ ìŠ¤í”„ë§ì— ë“±ë¡ëœ ëª¨ë“  ë¹ˆ ì •ë³´ ì¶œë ¥ ê°€ëŠ¥

â¡ï¸ ac.getBeanDefinitionNames() : ìŠ¤í”„ë§ì— ë“±ë¡ëœ ëª¨ë“  ë¹ˆ ì´ë¦„ ì¡°íšŒ

â¡ï¸ ac.getBean() : ë¹ˆ ì´ë¦„ìœ¼ë¡œ ë¹ˆ ê°ì²´(ì¸ìŠ¤í„´ìŠ¤) ì¡°íšŒ

```java
package hello.core.beanfind;

import hello.core.AppConfig;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

public class ApplicationContextInfoTest {

    AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(AppConfig.class);

    @Test
    @DisplayName("ëª¨ë“  ë¹ˆ ì¶œë ¥í•˜ê¸°")
    void findAllBean() {
        String[] beanDefinitionNames = ac.getBeanDefinitionNames();
        // iter : ë¦¬ìŠ¤íŠ¸/ë°°ì—´ forë¬¸ ìë™ ìƒì„±
        for (String beanDefinitionName : beanDefinitionNames) {
            Object bean = ac.getBean(beanDefinitionName);
            System.out.println("name = " + beanDefinitionName + " object = " + bean);
        }
    }
}
```

- ì¶œë ¥ ê²°ê³¼

![Untitled](img/ëª¨ë“ _ë¹ˆ_ì¶œë ¥í•˜ê¸°.png)

### ì§ì ‘ ë§Œë“  ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹ˆë§Œ ì¶œë ¥í•˜ê¸°

â¡ï¸ ë‚´ê°€ ë“±ë¡í•œ ë¹ˆë§Œ ì¶œë ¥ (ìŠ¤í”„ë§ì´ ë‚´ë¶€ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë¹ˆì„ ì œì™¸)

â¡ï¸ getRole() : ìŠ¤í”„ë§ì´ ë‚´ë¶€ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë¹ˆ êµ¬ë¶„ (ROLE_APPLICATION/ROLE_INFRASTRUCTURE)

```java
...
public class ApplicationContextInfoTest {

    ...

    @Test
    @DisplayName("ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹ˆ ì¶œë ¥í•˜ê¸°")
    void findApplicationBean() {
        String[] beanDefinitionNames = ac.getBeanDefinitionNames();
        for (String beanDefinitionName : beanDefinitionNames) {
            // BeanDefinition : ë¹ˆì— ëŒ€í•œ ë©”íƒ€ë°ì´í„°
            BeanDefinition beanDefinition = ac.getBeanDefinition(beanDefinitionName);

            // ROLE_APPLICATION : ë‚´ê°€ ë“±ë¡í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ or ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬
            // ROLE_INFRASTRUCTURE : ìŠ¤í”„ë§ì´ ë‚´ë¶€ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë¹ˆ
            if (beanDefinition.getRole() == beanDefinition.ROLE_APPLICATION) {
                Object bean = ac.getBean(beanDefinitionName);
                System.out.println("name = " + beanDefinitionName + " object = " + bean);
            }
        }
    }
}
```

- ì¶œë ¥ ê²°ê³¼

![Untitled](img/ì• í”Œë¦¬ì¼€ì´ì…˜_ë¹ˆ_ì¶œë ¥í•˜ê¸°.png)

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ìŠ¤í”„ë§ ë¹ˆ ì¡°íšŒ - ê¸°ë³¸

- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì—ì„œ ìŠ¤í”„ë§ ë¹ˆì„ ì°¾ëŠ” ê°€ì¥ ê¸°ë³¸ì ì¸ ì¡°íšŒ ë°©ë²•

â˜‘ï¸ ac.getBean(ë¹ˆì´ë¦„, íƒ€ì…)

â˜‘ï¸ ac.getBean(íƒ€ì…)

ğŸ’¡ ì¡°íšŒ ëŒ€ìƒ ìŠ¤í”„ë§ ë¹ˆì´ ì—†ìœ¼ë©´ ì˜ˆì™¸ ë°œìƒ

- â€˜NoSuchBeanDefinitionException : No bean named â€˜xxxxâ€™ availableâ€™

1. test/java/hello.core/beanfind íŒ¨í‚¤ì§€ì— ApplicationContextBasicFindTest ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.beanfind;

import hello.core.AppConfig;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.NoSuchBeanDefinitionException;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

import static org.assertj.core.api.Assertions.assertThat;
import static org.junit.jupiter.api.Assertions.assertThrows;

public class ApplicationContextBasicFindTest {

    // Ctrl + E (Window) : ì´ì „ ì½”ë“œë¡œ ë°”ë¡œê°€ê¸°
    // Command + E (Linux)
    AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(AppConfig.class);

    @Test
    @DisplayName("ë¹ˆ ì´ë¦„ìœ¼ë¡œ ì¡°íšŒ")
    void findBeanByName() {
        MemberService memberService = ac.getBean("memberService", MemberService.class);

        // ê²€ì¦ - Assertions (org.junit)
        assertThat(memberService).isInstanceOf(MemberServiceImpl.class);
    }

    @Test
    @DisplayName("ì´ë¦„ ì—†ì´ íƒ€ì…ìœ¼ë¡œë§Œ ì¡°íšŒ")
    void findBeanByType() {
        MemberService memberService = ac.getBean(MemberService.class);
        assertThat(memberService).isInstanceOf(MemberServiceImpl.class);
    }

    @Test
    @DisplayName("êµ¬ì²´ íƒ€ì…ìœ¼ë¡œ ì¡°íšŒ")
    void findBeanByName2() {
        // ì¸í„°í˜ì´ìŠ¤ì˜ êµ¬í˜„ì²´ë¡œ ì§ì ‘ ì¡°íšŒ - ì¢‹ì§€ ì•Šì€ ë°©ë²•
        MemberService memberService = ac.getBean("memberService", MemberServiceImpl.class);
        assertThat(memberService).isInstanceOf(MemberServiceImpl.class);
    }

    // ì‹¤íŒ¨ í…ŒìŠ¤íŠ¸ ë§Œë“¤ê¸°
    @Test
    @DisplayName("ë¹ˆ ì´ë¦„ìœ¼ë¡œ ì¡°íšŒX")
    void findBeanByNameX() {
        // ac.getBean("xxxx", MemberService.class);
        assertThrows(NoSuchBeanDefinitionException.class,
                () -> ac.getBean("xxxx", MemberService.class));
    }
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/ìŠ¤í”„ë§_ë¹ˆ_ì¡°íšŒ_ê¸°ë³¸.png)

â†’ ì„±ê³µ !

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ìŠ¤í”„ë§ ë¹ˆ ì¡°íšŒ - ë™ì¼í•œ íƒ€ì…ì´ ë‘˜ ì´ìƒ

- íƒ€ì…ìœ¼ë¡œ ì¡°íšŒ ì‹œ ê°™ì€ íƒ€ì…ì˜ ìŠ¤í”„ë§ ë¹ˆì´ ë‘˜ ì´ìƒì´ë©´ ì˜¤ë¥˜ ë°œìƒ â†’ ë¹ˆ ì´ë¦„ ì§€ì •
- ac.getBeansOfType() : í•´ë‹¹ íƒ€ì…ì˜ ëª¨ë“  ë¹ˆ ì¡°íšŒ ê°€ëŠ¥

1. test/java/hello.core/beanfind íŒ¨í‚¤ì§€ì— ApplicationContextSameBeanFindTest ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.beanfind;

import hello.core.member.MemberRepository;
import hello.core.member.MemoryMemberRepository;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.NoUniqueBeanDefinitionException;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import java.util.Map;

import static org.assertj.core.api.Assertions.assertThat;
import static org.junit.jupiter.api.Assertions.assertThrows;

public class ApplicationContextSameBeanFindTest {

    AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(SameBeanConfig.class);

    @Test
    @DisplayName("íƒ€ì…ìœ¼ë¡œ ì¡°íšŒ ì‹œ ê°™ì€ íƒ€ì…ì´ ë‘˜ ì´ìƒì´ë©´ ì¤‘ë³µ ì˜¤ë¥˜ ë°œìƒ")
    void findBeanByTypeDuplicate() {
        assertThrows(NoUniqueBeanDefinitionException.class,
                () -> ac.getBean(MemberRepository.class));
    }

    @Test
    @DisplayName("íƒ€ì…ìœ¼ë¡œ ì¡°íšŒ ì‹œ ê°™ì€ íƒ€ì…ì´ ë‘˜ ì´ìƒì´ë©´ ë¹ˆ ì´ë¦„ì„ ì§€ì •")
    void findBeanByName() {
        MemberRepository memberRepository = ac.getBean("memberRepository1", MemberRepository.class);
        assertThat(memberRepository).isInstanceOf(MemberRepository.class);
    }

    @Test
    @DisplayName("íŠ¹ì • íƒ€ì… ëª¨ë‘ ì¡°íšŒ")
    void findAllBeanByType() {
        Map<String, MemberRepository> beansOfType = ac.getBeansOfType(MemberRepository.class);
        for (String key : beansOfType.keySet()) {
            System.out.println("key = " + key + " value = " + beansOfType.get(key));
        }
        System.out.println("beansOfType = " + beansOfType);
        assertThat(beansOfType.size()).isEqualTo(2);
    }

    // static class ì„ ì–¸ : ApplicationContextSameBeanFindTest ì•ˆì—ì„œë§Œ ì‚¬ìš©í•  í´ë˜ìŠ¤ë¼ëŠ” ì˜ë¯¸
    @Configuration
    static class SameBeanConfig {

        @Bean
        public MemberRepository memberRepository1() {
            return new MemoryMemberRepository();
        }

        @Bean
        public MemberRepository memberRepository2() {
            return new MemoryMemberRepository();
        }

    }
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/ApplicationContextSameBeanFindTest.png)

â†’ ì„±ê³µ !

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# â­â­â­ ìŠ¤í”„ë§ ë¹ˆ ì¡°íšŒ - ìƒì†ê´€ê³„

- ë¶€ëª¨ íƒ€ì… ì¡°íšŒ ì‹œ, ìì‹ íƒ€ì…ë„ í•¨ê»˜ ì¡°íšŒë¨
- ëª¨ë“  ìë°” ê°ì²´ì˜ ìµœê³  ë¶€ëª¨ì¸ Object íƒ€ì…ìœ¼ë¡œ ì¡°íšŒ ì‹œ, ëª¨ë“  ìŠ¤í”„ë§ ë¹ˆ ì¡°íšŒ ê°€ëŠ¥

1. test/java/hello.core/beanfind íŒ¨í‚¤ì§€ì— ApplicationContextExtendsFindTest ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.beanfind;

import hello.core.discount.DiscountPolicy;
import hello.core.discount.FixDiscountPolicy;
import hello.core.discount.RateDiscountPolicy;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.NoUniqueBeanDefinitionException;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import java.util.Map;

import static org.assertj.core.api.Assertions.assertThat;
import static org.junit.jupiter.api.Assertions.assertThrows;

public class ApplicationContextExtendsFindTest {

    AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(TestConfig.class);

    @Test
    @DisplayName("ë¶€ëª¨ íƒ€ì…ìœ¼ë¡œ ì¡°íšŒ ì‹œ ìì‹ì´ ë‘˜ ì´ìƒ ìˆìœ¼ë©´, ì¤‘ë³µ ì˜¤ë¥˜ ë°œìƒ")
    void findBeanByParentTypeDuplicate() {
        assertThrows(NoUniqueBeanDefinitionException.class,
                () -> ac.getBean(DiscountPolicy.class));
    }

    @Test
    @DisplayName("ë¶€ëª¨ íƒ€ì…ìœ¼ë¡œ ì¡°íšŒ ì‹œ ìì‹ì´ ë‘˜ ì´ìƒ ìˆìœ¼ë©´, ë¹ˆ ì´ë¦„ ì§€ì •")
    void findBeanByParentTypeBeanName() {
        DiscountPolicy rateDiscountPolicy = ac.getBean("rateDiscountPolicy", DiscountPolicy.class);
        assertThat(rateDiscountPolicy).isInstanceOf(RateDiscountPolicy.class);
    }

    @Test
    @DisplayName("íŠ¹ì • í•˜ìœ„ íƒ€ì…ìœ¼ë¡œ ì¡°íšŒ")
    void findBeanBySubType() {
        RateDiscountPolicy bean = ac.getBean(RateDiscountPolicy.class);
        assertThat(bean).isInstanceOf(RateDiscountPolicy.class);
    }

    @Test
    @DisplayName("ë¶€ëª¨ íƒ€ì…ìœ¼ë¡œ ëª¨ë‘ ì¡°íšŒ")
    void findAllBeanByParentType() {
        Map<String, DiscountPolicy> beansOfType = ac.getBeansOfType(DiscountPolicy.class);
        assertThat(beansOfType.size()).isEqualTo(2);
        for (String key : beansOfType.keySet()) {
            System.out.println("key = " + key + "value = " + beansOfType.get(key));
        }
    }

    @Test
    @DisplayName("ë¶€ëª¨ íƒ€ì…ìœ¼ë¡œ ëª¨ë‘ ì¡°íšŒ - Object")
    void findAllBeanByObjectType() {
        Map<String, Object> beansOfType = ac.getBeansOfType(Object.class);
        for (String key : beansOfType.keySet()) {
            System.out.println("key = " + key + "value = " + beansOfType.get(key));
        }
    }

    @Configuration
    static class TestConfig {
        @Bean
        public DiscountPolicy rateDiscountPolicy() {
            return new RateDiscountPolicy();
        }

        @Bean
        public DiscountPolicy fixDiscountPolicy() {
            return new FixDiscountPolicy();
        }
    }
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/ApplicationContextExtendsFindTest.png)

â†’ ì„±ê³µ !

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# BeanFactory ì™€ ApplicationContext

![Untitled](img/BeanFactory&ApplicationContext.png)

## BeanFactory

- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì˜ ìµœìƒìœ„ ì¸í„°í˜ì´ìŠ¤
- ìŠ¤í”„ë§ ë¹ˆì„ ê´€ë¦¬í•˜ê³  ì¡°íšŒí•˜ëŠ” ì—­í• 
- getBean() ì œê³µ
- ì§€ê¸ˆê¹Œì§€ ì‚¬ìš©í–ˆë˜ ëŒ€ë¶€ë¶„ì˜ ê¸°ëŠ¥ì€ BeanFactory ê°€ ì œê³µí•˜ëŠ” ê¸°ëŠ¥

## ApplicationContext

- BeanFactory ì˜ ê¸°ëŠ¥ì„ ëª¨ë‘ ìƒì†ë°›ì•„ ì œê³µ (BeanFactory ê¸°ëŠ¥ + É‘)

### ApplicationContext ê°€ ì œê³µí•˜ëŠ” ë¶€ê°€ê¸°ëŠ¥

![Untitled](img/ApplicationContext.png)

- **MessageSource** : ë©”ì‹œì§€ì†ŒìŠ¤ë¥¼ í™œìš©í•œ êµ­ì œí™” ê¸°ëŠ¥ (ex. í•œêµ­ì—ì„œ ë“¤ì–´ì˜¤ë©´ í•œêµ­ì–´, ì˜ì–´ê¶Œì—ì„œ ë“¤ì–´ì˜¤ë©´ ì˜ì–´ë¡œ ì¶œë ¥)
- **EnvironmentCapable** : í™˜ê²½ë³€ìˆ˜ (ë¡œì»¬, ê°œë°œ, ìš´ì˜ ë“±ì„ êµ¬ë¶„í•´ì„œ ì²˜ë¦¬)
- **ApplicationEventPublisher** : ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ë²¤íŠ¸ (ì´ë²¤íŠ¸ ë°œí–‰&êµ¬ë… ëª¨ë¸ í¸ë¦¬í•˜ê²Œ ì§€ì›)
- **ResourceLoader** : í¸ë¦¬í•œ ë¦¬ì†ŒìŠ¤ ì¡°íšŒ (íŒŒì¼, í´ë˜ìŠ¤íŒ¨ìŠ¤, ì™¸ë¶€ ë“±ì—ì„œ ë¦¬ì†ŒìŠ¤ë¥¼ í¸ë¦¬í•˜ê²Œ ì¡°íšŒ)

> **ì •ë¦¬**
> - ApplicationContext ëŠ” BeanFactory ì˜ ê¸°ëŠ¥ì„ ìƒì†ë°›ëŠ”ë‹¤
> - ApplicationContext ëŠ” ë¹ˆ ê´€ë¦¬ ê¸°ëŠ¥ + í¸ë¦¬í•œ ë¶€ê°€ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤
> - BeanFactory ë¥¼ ì§ì ‘ ì‚¬ìš©í•  ì¼ì€ ê±°ì˜ ì—†ë‹¤ (ë¶€ê°€ ê¸°ëŠ¥ì´ í¬í•¨ëœ ApplicationContext ì‚¬ìš©)
> - BeanFactory ë‚˜ ApplicationContext ë¥¼ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¼ í•œë‹¤
>

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ë‹¤ì–‘í•œ ì„¤ì • í˜•ì‹ ì§€ì› - ìë°” ì½”ë“œ, XML

- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” ë‹¤ì–‘í•œ í˜•ì‹ì˜ ì„¤ì • ì •ë³´ë¥¼ ë°›ì•„ë“¤ì¼ ìˆ˜ ìˆê²Œ ìœ ì—°í•˜ê²Œ ì„¤ê³„ë˜ì–´ ìˆìŒ
  - ìë°” ì½”ë“œ, XML, Groovy â€¦

![Untitled](img/ë‹¤ì–‘í•œ_ì„¤ì •_í˜•ì‹_ì§€ì›.png)

## ì• ë…¸í…Œì´ì…˜ ê¸°ë°˜ ìë°” ì½”ë“œ ì„¤ì • ì‚¬ìš©

- ì§€ê¸ˆê¹Œì§€ í–ˆë˜ ê²ƒ
- new AnnotationConfigApplicationContext(AppConfig.class)
- AnnotationConfigApplicationContext í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ìë°” ì½”ë“œë¡œ ëœ ì„¤ì • ì •ë³´ë¥¼ ë„˜ê¹€

## XML ì„¤ì • ì‚¬ìš©

- ìµœê·¼ì—ëŠ” ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ (ìŠ¤í”„ë§ ë¶€íŠ¸ ì˜í–¥)
- ì»´íŒŒì¼ ì—†ì´ ë¹ˆ ì„¤ì • ì •ë³´ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆëŠ” ì¥ì 
- GenericXmlApplicationContext í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ xml ì„¤ì • ì •ë³´ë¥¼ ë„˜ê¹€

1. main/resources ì— appConfig.xml íŒŒì¼ ìƒì„±

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="memberService" class="hello.core.member.MemberServiceImpl">
        <constructor-arg name="memberRepository" ref="memberRepository" />
    </bean>

    <bean id="memberRepository" class="hello.core.member.MemoryMemberRepository" />

    <bean id="orderService" class="hello.core.order.OrderServiceImpl">
        <constructor-arg name="memberRepository" ref="memberRepository" />
        <constructor-arg name="discountPolicy" ref="discountPolicy" />
    </bean>

    <bean id="discountPolicy" class="hello.core.discount.RateDiscountPolicy" />

</beans>
```

â¡ï¸ xml ê¸°ë°˜ì˜ appConfig.xml ìŠ¤í”„ë§ ì„¤ì • ì •ë³´ â‰’ ìë°” ì½”ë“œë¡œ ëœ [AppConfig.java](http://AppConfig.java) ì„¤ì • ì •ë³´

2. test/java/hello.core ì— xml ì´ë¦„ì˜ Package ìƒì„±
3. ë§Œë“  xml íŒ¨í‚¤ì§€ì— XmlAppContext ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.xml;

import hello.core.member.MemberService;
import org.junit.jupiter.api.Test;
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.GenericXmlApplicationContext;

import static org.assertj.core.api.Assertions.assertThat;

public class XmlAppContext {

    @Test
    void xmlAppContext() {
        ApplicationContext ac = new GenericXmlApplicationContext("appConfig.xml");
        MemberService memberService = ac.getBean("memberService", MemberService.class);
        assertThat(memberService).isInstanceOf(MemberService.class);
    }
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/XmlAppContext.png)

â†’ ì„±ê³µ !

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ìŠ¤í”„ë§ ë¹ˆ ì„¤ì • ë©”íƒ€ ì •ë³´ - BeanDefinition

- Bean ì •ë³´ì— ëŒ€í•œ ì¶”ìƒí™” (Bean ì„¤ì • ë©”íƒ€ ì •ë³´) : BeanDefinition
  - @Bean, <bean> ë‹¹ ê°ê° í•˜ë‚˜ì”© ë©”íƒ€ ì •ë³´ê°€ ìƒì„±ë¨
- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” ë©”íƒ€ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìŠ¤í”„ë§ ë¹ˆ ìƒì„±

![Untitled](img/BeanDefinition.png)

- ì½”ë“œ ë ˆë²¨ë¡œ í™•ì¥

![Untitled](img/BeanDefinitionì½”ë“œë ˆë²¨.png)

â¡ï¸ AnnotationConfigApplicationContext ëŠ” AnnotatedBeanDefinitionReder ë¥¼ ì‚¬ìš©í•´ AppConfig.class ë¥¼ ì½ê³  BeanDefinition ìƒì„±

â¡ï¸ GenericXmlApplicationContext ëŠ” XmlBeanDefinitionReader ë¥¼ ì‚¬ìš©í•´ appConfig.xml ë¥¼ ì½ê³  BeanDefinition ìƒì„±

â¡ï¸ ìƒˆë¡œìš´ í˜•ì‹ì˜ ì„¤ì • ì •ë³´ê°€ ì¶”ê°€ë  ì‹œ, ~BeanDefinitionReader ë¥¼ ë§Œë“¤ì–´ì„œ BeanDefinition ìƒì„±

## BeanDefinition ì‚´í´ë³´ê¸°

1. test/java/hellocore ì— beandefinition ì´ë¦„ì˜ Package ìƒì„±
2. ë§Œë“  beandefinition íŒ¨í‚¤ì§€ì— BeanDefinitionTest ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.beandefinition;

import hello.core.AppConfig;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.config.BeanDefinition;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

public class BeanDefinitionTest {

   AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(AppConfig.class);

   @Test
   @DisplayName("ë¹ˆ ì„¤ì • ë©”íƒ€ ì •ë³´ í™•ì¸")
   void findApplicationBean() {
       String[] beanDefinitionNames = ac.getBeanDefinitionNames();
       for (String beanDefinitionName : beanDefinitionNames) {
           BeanDefinition beanDefinition = ac.getBeanDefinition(beanDefinitionName);

           if (beanDefinition.getRole() == BeanDefinition.ROLE_APPLICATION) {
               System.out.println("beanDefinitionName = " + beanDefinitionName +
                       " beanDefinition = " + beanDefinition);
           }
       }
   }
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/BeanDefinitionTest.png)

â†’ ì„±ê³µ !

> **ì •ë¦¬**
> - BeanDefinition ì„ ì§ì ‘ ìƒì„±í•´ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ë“±ë¡í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ ì‹¤ë¬´ì—ì„œ ì§ì ‘ ì •ì˜í•˜ê±°ë‚˜ ì‚¬ìš©í•  ì¼ì€ ê±°ì˜ ì—†ë‹¤.
> - BeanDefinition ì— ëŒ€í•´ ë„ˆë¬´ ê¹Šì´ ìˆê²Œ ì´í•´í•˜ê¸° ë³´ë‹¤, ìŠ¤í”„ë§ì´ ë‹¤ì–‘í•œ í˜•íƒœì˜ ì„¤ì • ì •ë³´ë¥¼ BeanDefinition ìœ¼ë¡œ ì¶”ìƒí™”í•˜ì—¬ ì‚¬ìš©í•œë‹¤ëŠ” ê²ƒ ì •ë„ë§Œ ì´í•´í•˜ë©´ ëœë‹¤.
>

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ğŸ¾ğŸ¾ì‹±ê¸€í†¤ ì»¨í…Œì´ë„ˆğŸ¾ğŸ¾

# ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ì‹±ê¸€í†¤

- ìŠ¤í”„ë§ : ê¸°ì—…ìš© ì˜¨ë¼ì¸ ì„œë¹„ìŠ¤ ê¸°ìˆ ì„ ì§€ì›í•˜ê¸° ìœ„í•´ íƒ„ìƒ
- ëŒ€ë¶€ë¶„ì˜ ìŠ¤í”„ë§ ì• í”Œë¦¬ì¼€ì´ì…˜ â†’ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ (ì›¹ì´ ì•„ë‹Œ ì• í”Œë¦¬ì¼€ì´ì…˜ë„ ê°œë°œ ê°€ëŠ¥)
- ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ : ë³´í†µ ì—¬ëŸ¬ ê³ ê°ì´ ë™ì‹œì— ìš”ì²­

![ë™ì‹œ ìš”ì²­](img/ë™ì‹œìš”ì²­.png)

ë™ì‹œ ìš”ì²­

1. test/java/hello.core ì— singleton ì´ë¦„ì˜ Package ìƒì„±
2. ë§Œë“  singleton íŒ¨í‚¤ì§€ì— SingletonTest ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.singleton;

import hello.core.AppConfig;
import hello.core.member.MemberService;
import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

public class SingletonTest {

    @Test
    @DisplayName("ìŠ¤í”„ë§ ì—†ëŠ” ìˆœìˆ˜í•œ DI ì»¨í…Œì´ë„ˆ")
    void pureContainer() {
        AppConfig appConfig = new AppConfig();

        // 1. ì¡°íšŒ : í˜¸ì¶œí•  ë•Œë§ˆë‹¤ ê°ì²´ ìƒì„±
        MemberService memberService1 = appConfig.memberService();

        // 2. ì¡°íšŒ : í˜¸ì¶œí•  ë•Œë§ˆë‹¤ ê°ì²´ ìƒì„±
        MemberService memberService2 = appConfig.memberService();

        // ì°¸ì¡°ê°’ì´ ë‹¤ë¥¸ ê²ƒì„ í™•ì¸
        System.out.println("memberService1 = " + memberService1);
        System.out.println("memberService2 = " + memberService2);

        // memberService1 â‰  memberService2
        Assertions.assertThat(memberService1).isNotSameAs(memberService2);
    }
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/SingletonTest.png)

â†’ ì°¸ì¡°ê°’ì´ ë‹¤ë¥¸ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤

âœ… AppConfig (ìŠ¤í”„ë§ ì—†ëŠ” ìˆœìˆ˜í•œ DI ì»¨í…Œì´ë„ˆ) : ìš”ì²­ì„ í•  ë•Œ ë§ˆë‹¤ ê°ì²´ ìƒˆë¡œ ìƒì„± â†’ ë©”ëª¨ë¦¬ ë‚­ë¹„ê°€ ì‹¬í•¨

âœ… ì‹±ê¸€í†¤ íŒ¨í„´ : í•´ë‹¹ ê°ì²´ë¥¼ 1ê°œë§Œ ìƒì„±í•œ í›„ ê³µìœ 

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ì‹±ê¸€í†¤ íŒ¨í„´

- í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ê°€ ë”± 1ê°œë§Œ ìƒì„±ë˜ëŠ” ê²ƒì„ ë³´ì¥í•˜ëŠ” ë””ìì¸ íŒ¨í„´
- private ìƒì„±ì ì‚¬ìš© (ì™¸ë¶€ì—ì„œ ì„ì˜ë¡œ new í‚¤ì›Œë“œ ì‚¬ìš© ë°©ì§€) â†’ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ 2ê°œ ì´ìƒ ìƒì„± ë°©ì§€

1. test/java/hello.core/singleton íŒ¨í‚¤ì§€ì— SingletonService ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.singleton;

public class SingletonService {

    private static final SingletonService instance = new SingletonService();

    public static SingletonService getInstance() {
        return instance;
    }
    
    private SingletonService() {}

    public void logic() {
        System.out.println("ì‹±ê¸€í†¤ ê°ì²´ ë¡œì§ í˜¸ì¶œ");
    }
}
```

- private ìœ¼ë¡œ new í‚¤ì›Œë“œë¥¼ ë§‰ì•„ë‘ 
- í˜¸ì¶œí•  ë•Œë§ˆë‹¤ ê°™ì€ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜

2. test/java/hello.core/singleton/SingletonTest ì— ì½”ë“œ ì¶”ê°€

```java
...

import static org.assertj.core.api.Assertions.assertThat;

public class SingletonTest {

    ...

    @Test
    @DisplayName("ì‹±ê¸€í†¤ íŒ¨í„´ì„ ì ìš©í•œ ê°ì²´ ì‚¬ìš©")
    void singletonServiceTest() {
        SingletonService singletonService1 = SingletonService.getInstance();
        SingletonService singletonService2 = SingletonService.getInstance();

        System.out.println("singletonService1 = " + singletonService1);
        System.out.println("singletonService2 = " + singletonService2);

        assertThat(singletonService1).isSameAs(singletonService2);
    }
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/SingletonService.png)

â†’ ê°™ì€ ê°ì²´ê°€ ìƒì„±ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤

### ì‹±ê¸€í†¤ íŒ¨í„´ ë¬¸ì œì 

- ì‹±ê¸€í†¤ íŒ¨í„´ì„ êµ¬í˜„í•˜ëŠ” ì½”ë“œê°€ ë§ìŒ
- í´ë¼ì´ì–¸íŠ¸ê°€ êµ¬ì²´ í´ë˜ìŠ¤ì— ì˜ì¡´ â†’ DIP, OCP ìœ„ë°˜
- í…ŒìŠ¤íŠ¸ê°€ ì–´ë ¤ì›€
- ë‚´ë¶€ ì†ì„±ì„ ë³€ê²½í•˜ê±°ë‚˜ ì´ˆê¸°í™” í•˜ê¸° ì–´ë ¤ì›€
- private ìƒì„±ì â†’ ìì‹ í´ë˜ìŠ¤ ë§Œë“¤ê¸° ì–´ë ¤ì›€
- ìœ ì—°ì„±ì´ ë–¨ì–´ì§
- ì•ˆí‹°íŒ¨í„´ì´ë¼ ë¶ˆë¦¼

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ì‹±ê¸€í†¤ ì»¨í…Œì´ë„ˆ

- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” ì‹±ê¸€í†¤ íŒ¨í„´ì„ ì ìš©í•˜ì§€ ì•Šì•„ë„, ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‹±ê¸€í†¤(1ê°œë§Œ ìƒì„±)ìœ¼ë¡œ ê´€ë¦¬
- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ : ì‹±ê¸€í†¤ ì»¨í…Œì´ë„ˆ ì—­í• 
  - ì‹±ê¸€í†¤ ë ˆì§€ìŠ¤íŠ¸ë¦¬ : ì‹±ê¸€í†¤ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ëŠ” ê¸°ëŠ¥
- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ â†’ ì‹±ê¸€í†¤ íŒ¨í„´ ë‹¨ì  í•´ê²°
  - ì‹±ê¸€í†¤ íŒ¨í„´ì„ ìœ„í•œ ì§€ì €ë¶„í•œ ì½”ë“œ X
  - DIP, OCP, í…ŒìŠ¤íŠ¸, private ìƒì„±ìë¡œë¶€í„° ììœ ë¡­ê²Œ ì‹±ê¸€í†¤ ì‚¬ìš©

1. test/java/hello.core/SingletonTest ì— ì½”ë“œ ì¶”ê°€

```java
...
public class SingletonTest {

    ...

    @Test
    @DisplayName("ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì™€ ì‹±ê¸€í†¤")
    void springContainer() {
        // AppConfig appConfig = new AppConfig();
        ApplicationContext ac = new AnnotationConfigApplicationContext(AppConfig.class);

        // 1. ì¡°íšŒ : í˜¸ì¶œí•  ë•Œë§ˆë‹¤ ê°ì²´ ìƒì„±
        MemberService memberService1 = ac.getBean("memberService", MemberService.class);

        // 2. ì¡°íšŒ : í˜¸ì¶œí•  ë•Œë§ˆë‹¤ ê°ì²´ ìƒì„±
        MemberService memberService2 = ac.getBean("memberService", MemberService.class);

        // ì°¸ì¡°ê°’ì´ ê°™ì€ ê²ƒì„ í™•ì¸
        System.out.println("memberService1 = " + memberService1);
        System.out.println("memberService2 = " + memberService2);

        // memberService1 = memberService2
        assertThat(memberService1).isSameAs(memberService2);
    }
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/singleton_springContainer.png)

### ì‹±ê¸€í†¤ ì»¨í…Œì´ë„ˆ ì ìš© í›„

![Untitled](img/aftersingleton.png)

â¡ï¸ ì´ë¯¸ ë§Œë“¤ì–´ì§„ ê°ì²´ ê³µìœ  : íš¨ìœ¨ì ì¸ ì¬ì‚¬ìš©

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# â­ ì‹±ê¸€í†¤ ë°©ì‹ì˜ ì£¼ì˜ì 

- ì‹±ê¸€í†¤ ê°ì²´ëŠ” ìƒíƒœë¥¼ ìœ ì§€(stateful)í•˜ë„ë¡ ì„¤ê³„í•´ì„œëŠ” ì•ˆë¨ (ì—¬ëŸ¬ í´ë¼ì´ì–¸íŠ¸ê°€ ê°™ì€ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê³µìœ í•˜ê¸° ë•Œë¬¸)
- ë¬´ìƒíƒœ(stateless)ë¡œ ì„¤ê³„
  - íŠ¹ì • í´ë¼ì´ì–¸íŠ¸ì— ì˜ì¡´ì ì¸ í•„ë“œê°€ ìˆì–´ì„  ì•ˆë¨
  - íŠ¹ì • í´ë¼ì´ì–¸íŠ¸ê°€ ê°’ì„ ë³€ê²½í•  ìˆ˜ ìˆëŠ” í•„ë“œê°€ ìˆì–´ì„  ì•ˆë¨ (ê°€ê¸‰ì  ì½ê¸°ë§Œ ê°€ëŠ¥)
  - í•„ë“œ ëŒ€ì‹  ìë°”ì—ì„œ ê³µìœ ë˜ì§€ ì•ŠëŠ” ì§€ì—­ë³€ìˆ˜, íŒŒë¼ë¯¸í„°, ThreadLocal ë“± ì‚¬ìš©
- ìŠ¤í”„ë§ ë¹ˆ í•„ë“œì— ê³µìœ  ê°’ ì„¤ì • ì‹œ ì¥ì•  ë°œìƒ ê°€ëŠ¥

## ë¬¸ì œ ìƒí™©

1. test/java/hello.core/singleton íŒ¨í‚¤ì§€ì— StatefulService ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.singleton;

public class StatefulService {

    // ìƒíƒœë¥¼ ìœ ì§€í•˜ëŠ” í•„ë“œ
    private int price;

    public void order(String name, int price) {
        System.out.println("name = " + name + "price = " + price);

        // ë¬¸ì œê°€ ë˜ëŠ” ë¶€ë¶„ !!
        this.price = price;
    }

    public int getPrice() {
        return price;
    }
}
```

2. test/java/hello.core/singleton íŒ¨í‚¤ì§€ì— StatefulServiceTest ì´ë¦„ì˜ Class ìƒì„± (Windows : Ctrl + Shift + t, Linux : Command + Shift + t)

```java
package hello.core.singleton;

import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.annotation.Bean;

import static org.assertj.core.api.Assertions.assertThat;
import static org.junit.jupiter.api.Assertions.*;

class StatefulServiceTest {

    @Test
    void statefulServiceSingleton() {
        ApplicationContext ac = new AnnotationConfigApplicationContext(TestConfig.class);
        StatefulService statefulService1 = ac.getBean(StatefulService.class);
        StatefulService statefulService2 = ac.getBean(StatefulService.class);

        // Thread A : A ì‚¬ìš©ì 10000ì› ì£¼ë¬¸
        statefulService1.order("userA", 10000);

        // Thread B : B ì‚¬ìš©ì 20000ì› ì£¼ë¬¸
        statefulService2.order("userB", 20000);

        // Thread A : A ì‚¬ìš©ì ì£¼ë¬¸ ê¸ˆì•¡ ì¡°íšŒ
        int price = statefulService1.getPrice();
        System.out.println("A price = " + price);

        assertThat(statefulService1.getPrice()).isEqualTo(20000);
    }

    static class TestConfig {
        @Bean
        public StatefulService statefulService() {
            return new StatefulService();
        }
    }

}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/Stateful.png)

â†’ Thread A ì‚¬ìš©ìëŠ” 10000ì›ì„ ê¸°ëŒ€í–ˆì§€ë§Œ, 20000ì› ì¶œë ¥ !

â˜‘ï¸ StatefulService ì˜ price í•„ë“œëŠ” ê³µìœ  í•„ë“œì¸ë°, íŠ¹ì • í´ë¼ì´ì–¸íŠ¸ê°€ ê°’ì„ ë³€ê²½

## í•´ê²°

1. StatefulService ì½”ë“œ ë³€ê²½

```java
package hello.core.singleton;

public class StatefulService {

    // ìƒíƒœë¥¼ ìœ ì§€í•˜ëŠ” í•„ë“œ
    // private int price;

    public int order(String name, int price) {
        System.out.println("name = " + name + "price = " + price);

        // ë¬¸ì œê°€ ë˜ëŠ” ë¶€ë¶„ !!
        // this.price = price;

        return price;
    }

//    public int getPrice() {
//        return price;
//    }
}
```

2. StatefulServiceTest ì½”ë“œ ë³€ê²½

```java
...

class StatefulServiceTest {

    @Test
    void statefulServiceSingleton() {
        ApplicationContext ac = new AnnotationConfigApplicationContext(TestConfig.class);
        StatefulService statefulService1 = ac.getBean(StatefulService.class);
        StatefulService statefulService2 = ac.getBean(StatefulService.class);

        // Thread A : A ì‚¬ìš©ì 10000ì› ì£¼ë¬¸
        int userAPrice = statefulService1.order("userA", 10000);

        // Thread B : B ì‚¬ìš©ì 20000ì› ì£¼ë¬¸
        int userBPrice = statefulService2.order("userB", 20000);

        // Thread A : A ì‚¬ìš©ì ì£¼ë¬¸ ê¸ˆì•¡ ì¡°íšŒ
        // int price = statefulService1.getPrice();
        System.out.println("A price = " + userAPrice);

        // assertThat(statefulService1.getPrice()).isEqualTo(20000);
    }

    ...
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/Stateless.png)

â†’ í•´ê²°

âœ… ìŠ¤í”„ë§ ë¹ˆì€ í•­ìƒ ë¬´ìƒíƒœ(stateless)ë¡œ ì„¤ê³„ !!

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# @Configuration ê³¼ ì‹±ê¸€í†¤

## ì˜ë¬¸ì 

- AppConfig

```java
...

@Configuration
public class AppConfig {

    // @Bean memberService -> new MemoryMemberRepository()
    // @Bean orderService -> new MemoryMemberRepository()

    @Bean
    public MemberService memberService() {
        return new MemberServiceImpl(memberRepository());
    }

    @Bean
    public MemoryMemberRepository memberRepository() {
        return new MemoryMemberRepository();
    }

    @Bean
    public OrderService orderService() {
        return new OrderServiceImpl(memberRepository(), discountPolicy());
    }

    ...
}
```

â¡ï¸ MemoryMemberRepository ê°€ 2ë²ˆ í˜¸ì¶œë˜ë©´ì„œ ì‹±ê¸€í†¤ì´ ê¹¨ì§€ëŠ” ê±´ ì•„ë‹Œê°€ ?

### í…ŒìŠ¤íŠ¸ í•´ë³´ê¸°

1. MemberServiceImpl ì— í…ŒìŠ¤íŠ¸ ì½”ë“œ ì¶”ê°€

```java
...

public class MemberServiceImpl implements MemberService{

    ...

    // í…ŒìŠ¤íŠ¸ ìš©ë„
    public MemberRepository getMemberRepository() {
        return memberRepository;
    }
}
```

2. OrderServiceImpl ì— í…ŒìŠ¤íŠ¸ ì½”ë“œ ì¶”ê°€

```java
...

public class OrderServiceImpl implements OrderService{

    ...

    // í…ŒìŠ¤íŠ¸ ìš©ë„
    public MemberRepository getMemberRepository() {
        return memberRepository;
    }
}
```

3. test/java/hello.core/singleton íŒ¨í‚¤ì§€ì— ConfigurationSingletonTest ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.singleton;

import hello.core.AppConfig;
import hello.core.member.MemberRepository;
import hello.core.member.MemberServiceImpl;
import hello.core.order.OrderServiceImpl;
import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.Test;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

public class ConfigurationSingletonTest {

    @Test
    void configurationTest() {
        ApplicationContext ac = new AnnotationConfigApplicationContext(AppConfig.class);

        MemberServiceImpl memberService = ac.getBean("memberService", MemberServiceImpl.class);
        OrderServiceImpl orderService = ac.getBean("orderService", OrderServiceImpl.class);
        MemberRepository memberRepository = ac.getBean("memberRepository", MemberRepository.class);

        MemberRepository memberRepository1 = memberService.getMemberRepository();
        MemberRepository memberRepository2 = orderService.getMemberRepository();

        System.out.println("memberService -> memberRepository = " + memberRepository1);
        System.out.println("orderService -> memberRepository = " + memberRepository2);
        System.out.println("memberRepository = " + memberRepository);

        Assertions.assertThat(memberService.getMemberRepository()).isSameAs(memberRepository);
        Assertions.assertThat(orderService.getMemberRepository()).isSameAs(memberRepository);
    }
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/ConfigurationSingletonTest.png)

â†’ ê°™ì€ ì¸ìŠ¤í„´ìŠ¤ê°€ ì¡°íšŒëœë‹¤

### AppConfig ì—ì„œ í˜¸ì¶œ ë¡œê·¸ í™•ì¸í•˜ê¸°

```java
...
@Configuration
public class AppConfig {

    @Bean
    public MemberService memberService() {
        // soutm
        System.out.println("call AppConfig.memberService");
        return new MemberServiceImpl(memberRepository());
    }

    @Bean
    public MemoryMemberRepository memberRepository() {
        System.out.println("call AppConfig.memberRepository");
        return new MemoryMemberRepository();
    }

    @Bean
    public OrderService orderService() {
        System.out.println("call AppConfig.orderService");
        return new OrderServiceImpl(memberRepository(), discountPolicy());
    }

    ...
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/ConfigurationSingletonTest_AppConfigLog.png)

â†’ 3ë²ˆì˜ call ë°œìƒ : memberService, memberRepository, orderService

â˜‘ï¸ ì˜ˆìƒ call í˜¸ì¶œ (ìˆœì„œëŠ” ë³´ì¥ X)

â†’ call AppConfig.memberService

â†’ call AppConfig.memberRepository

â†’ call AppConfig.memberRepository

â†’ call AppConfig.orderService

â†’ call AppConfig.memberRepository

âœ… ì‹¤ì œ call í˜¸ì¶œ

â†’ call AppConfig.memberService

â†’ call AppConfig.memberRepository

â†’ call AppConfig.orderService

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# @Configuration ê³¼ ë°”ì´íŠ¸ì½”ë“œ ì¡°ì‘ì˜ ë§ˆë²•

- ìŠ¤í”„ë§ì€ í´ë˜ìŠ¤ì˜ ë°”ì´íŠ¸ì½”ë“œë¥¼ ì¡°ì‘í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©
- ë¹„ë°€ì€ @Configuration ì„ ì ìš©í•œ AppConfig ì— !!!

1. ConfigurationSingletonTest ì— ì½”ë“œ ì¶”ê°€

```java
...
public class ConfigurationSingletonTest {

    ...

    @Test
    void configurationDeep() {
        ApplicationContext ac = new AnnotationConfigApplicationContext(AppConfig.class);
        AppConfig bean = ac.getBean(AppConfig.class);

        System.out.println("bean = " + bean.getClass());
    }
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/configurationDeep.png)

â†’ ë‚´ê°€ ë§Œë“  í´ë˜ìŠ¤ê°€ ì•„ë‹ˆë¼ ìŠ¤í”„ë§ì´ CGLIB ë¼ëŠ” ë°”ì´íŠ¸ì½”ë“œ ì¡°ì‘ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•´ AppConfig í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ì€ ì„ì˜ì˜ ë‹¤ë¥¸ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ê³ , ê·¸ ë‹¤ë¥¸ í´ë˜ìŠ¤ë¥¼ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡í•œ ê²ƒ

### AppConfig@CGLIB

![Untitled](img/CGLIB.png)

â†’ ì„ì˜ì˜ ë‹¤ë¥¸ í´ë˜ìŠ¤ê°€ ì‹±ê¸€í†¤ì´ ë³´ì¥ë˜ë„ë¡ í•´ì¤Œ

- ì˜ˆìƒ ì½”ë“œ

```java
@Bean
public MemberRepository memberRepository() {
	if (memoryMemberRepository ê°€ ì´ë¯¸ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ë“±ë¡ë˜ì–´ ìˆìœ¼ë©´) {
		return ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì—ì„œ ì°¾ì•„ì„œ ë°˜í™˜;
	} else { // ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ì—†ìœ¼ë©´
		ê¸°ì¡´ ë¡œì§ì„ í˜¸ì¶œí•´ì„œ MemoryMemberRepository ë¥¼ ìƒì„±í•˜ê³  ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ë“±ë¡
		return ë°˜í™˜
	}
}
```

### @Configuration ì‚­ì œí–ˆì„ ê²½ìš°

- @Configuration ì„ ì ìš©í•˜ì§€ ì•Šê³ , @Bean ë§Œ ì ìš©

1. AppConfig ì—ì„œ @Configuration ì‚­ì œ

```java
...
// @Configuration
public class AppConfig {

    ...
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/configurationDeep_withoutConfiguration.png)

â†’ AppConfig ê°€ CGLIB ê¸°ìˆ  ì—†ì´ ìˆœìˆ˜í•œ AppConfig ë¡œ ìŠ¤í”„ë§ ë¹ˆì— ë“±ë¡ëœ ê²ƒì„ í™•ì¸

â˜‘ï¸ ê°ì ë‹¤ë¥¸ MemoryMemberRepository ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê°€ì§€ê³  ìˆë‹¤

> **ì •ë¦¬**
> - @Bean ë§Œ ì‚¬ìš©í•´ë„ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡ë˜ì§€ë§Œ, ì‹±ê¸€í†¤ì€ ë³´ì¥í•˜ì§€ ì•ŠëŠ”ë‹¤
> - í•­ìƒ @Configuration ì‚¬ìš©í•˜ê¸°
>

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ğŸ¾ğŸ¾ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ğŸ¾ğŸ¾

# ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ê³¼ ì˜ì¡´ê´€ê³„ ìë™ ì£¼ì… ì‹œì‘í•˜ê¸°

- ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” : ì„¤ì • ì •ë³´ ì—†ì´ ìë™ìœ¼ë¡œ ìŠ¤í”„ë§ ë¹ˆì„ ë“±ë¡
- @Autowired : ì˜ì¡´ê´€ê³„ ìë™ ì£¼ì…

1. main/java/hello.core ì— AutoAppConfig ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core;

import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.FilterType;

@Configuration
@ComponentScan(
        // AppConfig ì„¤ì • ì •ë³´ ì œì™¸í•˜ê¸°
        excludeFilters = @ComponentScan.Filter(type = FilterType.ANNOTATION, classes = Configuration.class)
)
public class AutoAppConfig { }
```

- @ComponentScan : @Component ì• ë…¸í…Œì´ì…˜ì´ ë¶™ì€ í´ë˜ìŠ¤ë¥¼ ìŠ¤ìº”í•´ì„œ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡

2. êµ¬í˜„ì²´(MemoryMemberRepository, RateDiscountPolicy, MemberServiceImp, OrderServiceImpl)ì— @Component, @Autowired ì• ë…¸í…Œì´ì…˜ ë¶™ì´ê¸°
- MemoryMemberRepository

```java
...
import org.springframework.stereotype.Component;

@Component
public class MemoryMemberRepository implements MemberRepository{

    ...
}
```

- RateDiscountPolicy

```java
...
import org.springframework.stereotype.Component;

@Component
public class RateDiscountPolicy implements DiscountPolicy{

    ...
}
```

- MemberServiceImpl

```java
...
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

@Component
public class MemberServiceImpl implements MemberService{

    ...
    @Autowired // ìë™ ì˜ì¡´ê´€ê³„ ì£¼ì…
    public MemberServiceImpl(MemberRepository memberRepository) { ... }

    ...
}
```

- OrderServiceImpl

```java
...
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

@Component
public class OrderServiceImpl implements OrderService{

    ...
    @Autowired
    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) { ... }

    ...
}
```

3. test/java/hello.core ì— scan ì´ë¦„ì˜ Package ìƒì„±
4. ë§Œë“  scan íŒ¨í‚¤ì§€ì— AutoAppConfigTest ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.scan;

import hello.core.AutoAppConfig;
import hello.core.member.MemberService;
import org.junit.jupiter.api.Test;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

import static org.assertj.core.api.Assertions.assertThat;

public class AutoAppConfigTest {

    @Test
    void basicScan() {
        AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(AutoAppConfig.class);

        MemberService memberService = ac.getBean(MemberService.class);
        assertThat(memberService).isInstanceOf(MemberService.class);
    }
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/AutoAppConfigTest.png)

â†’ ì˜ ë™ì‘í•œë‹¤

### @ComponentScan

![Untitled](img/@ComponentScan.png)

- @ComponentScan ì€ @Component ê°€ ë¶™ì€ ëª¨ë“  í´ë˜ìŠ¤ë¥¼ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡
- ìŠ¤í”„ë§ ë¹ˆì˜ ê¸°ë³¸ ì´ë¦„ : í´ë˜ìŠ¤ëª… - ë§¨ ì•ê¸€ìë§Œ ì†Œë¬¸ì ì‚¬ìš©
  - ex) MemberServiceImpl â†’ memberServiceImpl
  - ë¹ˆ ì´ë¦„ ì§ì ‘ ì§€ì • : @Component(â€memberService2â€)

### @Autowired

![Untitled](img/@Autowired.png)

- ìƒì„±ìì— @Autowired ì§€ì • ì‹œ, ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ìë™ìœ¼ë¡œ í•´ë‹¹ ìŠ¤í”„ë§ ë¹ˆ ì°¾ì€ í›„ ì£¼ì…
- ê¸°ë³¸ ì¡°íšŒ ì „ëµ : íƒ€ì…ì´ ê°™ì€ ë¹ˆì„ ì°¾ì•„ ì£¼ì…

![Untitled](img/@Autowired2.png)

- ìƒì„±ìì— íŒŒë¼ë¯¸í„°ê°€ ë§ì•„ë„ ìë™ ì£¼ì…

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# íƒìƒ‰ ìœ„ì¹˜ì™€ ê¸°ë³¸ ìŠ¤ìº” ëŒ€ìƒ

## íƒìƒ‰í•  íŒ¨í‚¤ì§€ì˜ ì‹œì‘ ìœ„ì¹˜ ì§€ì •

- AutoAppConfig

```java
...
@Configuration
@ComponentScan(
        // íƒìƒ‰í•  íŒ¨í‚¤ì§€ ì‹œì‘ ìœ„ì¹˜ ì§€ì •í•˜ê¸°
        basePackages = "hello.core.member",
        // ì§€ì •í•œ í´ë˜ìŠ¤ì˜ íŒ¨í‚¤ì§€ë¥¼ íƒìƒ‰ ì‹œì‘ ìœ„ì¹˜ë¡œ ì§€ì •í•˜ê¸°
        basePackageClasses = AutoAppConfig.class,
        ...
)
public class AutoAppConfig { }
```

â†’ basePackages : íƒìƒ‰í•  íŒ¨í‚¤ì§€ì˜ ì‹œì‘ ìœ„ì¹˜ ì§€ì •, í•˜ìœ„ íŒ¨í‚¤ì§€ ëª¨ë‘ íƒìƒ‰

â†’ basePackageClasses : ì§€ì •í•˜ì§€ ì•Šì„ ì‹œ @ComponentScan ì´ ë¶™ì€ ì„¤ì • ì •ë³´ í´ë˜ìŠ¤ì˜ íŒ¨í‚¤ì§€ê°€ ì‹œì‘ ìœ„ì¹˜

> âœ… **ê¶Œì¥í•˜ëŠ” ë°©ë²•**
>
> íŒ¨í‚¤ì§€ ìœ„ì¹˜ë¥¼ ì§€ì •í•˜ì§€ ì•Šê³ , ì„¤ì • ì •ë³´ í´ë˜ìŠ¤ì˜ ìœ„ì¹˜ë¥¼ í”„ë¡œì íŠ¸ ìµœìƒë‹¨ì— ë‘ëŠ” ê²ƒ (ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•˜ëŠ” ë°©ë²•)
>

### ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ê¸°ë³¸ ëŒ€ìƒ

- @Component : ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì—ì„œ ì‚¬ìš©
- @Controller : ìŠ¤í”„ë§ MVC ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì‚¬ìš©
- @Service : ìŠ¤í”„ë§ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì—ì„œ ì‚¬ìš© â†’ ë¹„ì¦ˆë‹ˆìŠ¤ ê³„ì¸µ ì¸ì‹
- @Repository : ìŠ¤í”„ë§ ë°ì´í„° ì ‘ê·¼ ê³„ì¸µì—ì„œ ì‚¬ìš© â†’ë°ì´í„° ê³„ì¸µì˜ ì˜ˆì™¸ë¥¼ ìŠ¤í”„ë§ ì˜ˆì™¸ë¡œ ë³€í™˜
- @Configuration : ìŠ¤í”„ë§ ì„¤ì • ì •ë³´ì—ì„œ ì‚¬ìš© â†’ ìŠ¤í”„ë§ ë¹ˆì´ ì‹±ê¸€í†¤ì„ ìœ ì§€í•˜ë„ë¡ ì¶”ê°€ ì²˜ë¦¬

> â­ **ì°¸ê³  â­**
>
> ì• ë…¸í…Œì´ì…˜ì—ëŠ” ìƒì†ê´€ê³„ë¼ëŠ” ê²ƒì´ ì—†ë‹¤. ì• ë…¸í…Œì´ì…˜ì´ íŠ¹ì • ì• ë…¸í…Œì´ì…˜ì„ ë“¤ê³  ìˆëŠ” ê²ƒì„ ì¸ì‹í•  ìˆ˜ ìˆëŠ” ê²ƒì€ ìë°” ì–¸ì–´ê°€ ì§€ì›í•˜ëŠ” ê¸°ëŠ¥ì€ ì•„ë‹ˆê³ , ìŠ¤í”„ë§ì´ ì§€ì›í•˜ëŠ” ê¸°ëŠ¥ì´ë‹¤.
>

> **ì°¸ê³ **
>
> useDefaultFilters ì˜µì…˜ì€ ê¸°ë³¸ìœ¼ë¡œ ì¼œì ¸ìˆëŠ”ë°, ì´ ì˜µì…˜ì„ ë„ë©´ ê¸°ë³¸ ìŠ¤ìº” ëŒ€ìƒë“¤ì´ ì œì™¸ëœë‹¤.
>

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# í•„í„°

- includeFilters : ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ëŒ€ìƒì„ ì¶”ê°€ë¡œ ì§€ì •
- excludeFilters : ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì—ì„œ ì œì™¸í•  ëŒ€ìƒ ì§€ì •

1. test/java/hello.core/scan ì— filter ì´ë¦„ì˜ Package ìƒì„±
2. ë§Œë“  filter íŒ¨í‚¤ì§€ì— MyIncludeComponent ì´ë¦„ì˜ Annotation ìƒì„±

```java
package hello.core.scan.filter;

import java.lang.annotation.*;

@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Documented
public @interface MyIncludeComponent { }
```

â†’ ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ëŒ€ìƒì— ì¶”ê°€í•  ì• ë…¸í…Œì´ì…˜

3. filter íŒ¨í‚¤ì§€ì— MyExcludeComponent ì´ë¦„ì˜ Annotation ìƒì„±

```java
package hello.core.scan.filter;

import java.lang.annotation.*;

@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Documented
public @interface MyExcludeComponent { }
```

â†’ ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ëŒ€ìƒì—ì„œ ì œì™¸í•  ì• ë…¸í…Œì´ì…˜

4. filter íŒ¨í‚¤ì§€ì— BeanA, BeanB ì´ë¦„ì˜ Class ìƒì„±
- BeanA

```java
package hello.core.scan.filter;

@MyIncludeComponent
public class BeanA { }
```

â†’ ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ëŒ€ìƒì— ì¶”ê°€í•  í´ë˜ìŠ¤ (@MyIncludeComponent ì ìš©)

- BeanB

```java
package hello.core.scan.filter;

@MyExcludeComponent // ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ëŒ€ìƒì—ì„œ ì œì™¸
public class BeanB { }
```

â†’ ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ëŒ€ìƒì—ì„œ ì œì™¸í•  í´ë˜ìŠ¤ (@MyExcludeComponent ì ìš©)

5. filter íŒ¨í‚¤ì§€ì— ComponentFilterAppConfigTest ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.scan.filter;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.NoSuchBeanDefinitionException;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.FilterType;

import static org.assertj.core.api.Assertions.assertThat;
import static org.junit.jupiter.api.Assertions.assertThrows;

public class ComponentFilterAppConfigTest {

    @Test
    void filterScan() {
        ApplicationContext ac = new AnnotationConfigApplicationContext(ComponentFilterAppConfig.class);
        BeanA beanA = ac.getBean("beanA", BeanA.class);
        assertThat(beanA).isNotNull();

        assertThrows(
                NoSuchBeanDefinitionException.class,
                () -> ac.getBean("beanB", BeanB.class)
        );
    }

    @Configuration
    @ComponentScan(
            includeFilters = @ComponentScan.Filter(type = FilterType.ANNOTATION, classes = MyIncludeComponent.class),
            excludeFilters = @ComponentScan.Filter(type = FilterType.ANNOTATION, classes = MyExcludeComponent.class)
    )
    static class ComponentFilterAppConfig {}
}
```

â¡ï¸ includeFilters ì— MyIncludeComponent ì• ë…¸í…Œì´ì…˜ì„ ì¶”ê°€í•´ì„œ BeanA ê°€ ìŠ¤í”„ë§ ë¹ˆì— ë“±ë¡ë¨

â¡ï¸ excludeFilters ì— MyExcludeComponent ì• ë…¸í…Œì´ì…˜ì„ ì¶”ê°€í•´ì„œ BeanB ëŠ” ìŠ¤í”„ë§ ë¹ˆì— ë“±ë¡ë˜ì§€ ì•ŠìŒ

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/ComponentFilterAppConfigTest.png)

â†’ ì„±ê³µ !

### FilterType ì˜µì…˜

- ANNOTATION : ê¸°ë³¸ê°’, ì• ë…¸í…Œì´ì…˜ì„ ì¸ì‹í•´ì„œ ë™ì‘ (ìƒëµ ê°€ëŠ¥)
- ASSIGNABLE_TYPE : ì§€ì •í•œ íƒ€ì…ê³¼ ìì‹ íƒ€ì…ì„ ì¸ì‹í•´ì„œ ë™ì‘
- ASPECT J : AspectJ íŒ¨í„´ ì‚¬ìš©
- REGEX : ì •ê·œ í‘œí˜„ì‹
- CUSTOM : TypeFilter ì´ë¼ëŠ” ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„í•´ì„œ ì²˜ë¦¬

> **ì°¸ê³ **
>
> @Component ë©´ ì¶©ë¶„í•˜ê¸° ë•Œë¬¸ì—, includeFilters ë¥¼ ì‚¬ìš©í•  ì¼ì€ ê±°ì˜ ì—†ë‹¤. excludeFilters ëŠ” ê°„í˜¹ ì‚¬ìš©í•˜ì§€ë§Œ ë§ì§€ëŠ” ì•Šë‹¤. ìµœê·¼ ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì„ ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•˜ëŠ”ë°, ì˜µì…˜ì„ ë³€ê²½í•˜ë©´ì„œ ì‚¬ìš©í•˜ê¸°ë³´ë‹¨ ìŠ¤í”„ë§ì˜ ê¸°ë³¸ ì„¤ì •ì— ë§ì¶”ì–´ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•œë‹¤.
>

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ì¤‘ë³µ ë“±ë¡ê³¼ ì¶©ëŒ

- ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì—ì„œ ê°™ì€ ë¹ˆ ì´ë¦„ì„ ë“±ë¡í•˜ë©´ ì–´ë–»ê²Œ ë ê¹Œ?
  - ìë™ ë¹ˆ ë“±ë¡ vs. ìë™ ë¹ˆ ë“±ë¡
  - ìˆ˜ë™ ë¹ˆ ë“±ë¡ vs. ìë™ ë¹ˆ ë“±ë¡

## ìë™ ë¹ˆ ë“±ë¡ vs. ìë™ ë¹ˆ ë“±ë¡

- ConflictingBeanDefinitionException ì˜ˆì™¸ ë°œìƒ

## ìˆ˜ë™ ë¹ˆ ë“±ë¡ vs. ìë™ ë¹ˆ ë“±ë¡

- ìˆ˜ë™ ë¹ˆ ë“±ë¡ì´ ìš°ì„ ê¶Œì„ ê°€ì§ â†’ ìˆ˜ë™ ë¹ˆì´ ìë™ ë¹ˆì„ ì˜¤ë²„ë¼ì´ë”©
- ìµœê·¼ ìŠ¤í”„ë§ ë¶€íŠ¸ì—ì„œëŠ” ìˆ˜ë™ ë¹ˆ ë“±ë¡ê³¼ ìë™ ë¹ˆ ë“±ë¡ì´ ì¶©ëŒë‚˜ë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë„ë¡ ê¸°ë³¸ ê°’ì„ ë°”ê¿ˆ

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ğŸ¾ğŸ¾ì˜ì¡´ê´€ê³„ ìë™ ì£¼ì…ğŸ¾ğŸ¾

# ë‹¤ì–‘í•œ ì˜ì¡´ê´€ê³„ ì£¼ì… ë°©ë²•

## ìƒì„±ì ì£¼ì…

- ìƒì„±ìë¥¼ í†µí•´ ì˜ì¡´ ê´€ê³„ë¥¼ ì£¼ì… ë°›ëŠ” ë°©ë²•
- ì§€ê¸ˆê¹Œì§€ ì§„í–‰í–ˆë˜ ë°©ì‹

ex) OrderServiceImpl

```java
...
@Component
public class OrderServiceImpl implements OrderService{

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    @Autowired
    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }

    ...
}
```

- â­ íŠ¹ì§•
  - ìƒì„±ì í˜¸ì¶œ ì‹œì ì— ë”± 1ë²ˆë§Œ í˜¸ì¶œ
  - â€œ**ë¶ˆë³€**, **í•„ìˆ˜**â€ ì˜ì¡´ ê´€ê³„ì— ì‚¬ìš©
    - ë¶ˆë³€ : ì½”ë“œê°€ ë°”ë€Œì§€ ì•ŠìŒ
    - í•„ìˆ˜ : final ë³€ìˆ˜ â†’ ëŒ€ì‘í•˜ëŠ” ê°’ì´ ìˆì–´ì•¼ í•¨
- â­ ìƒì„±ìê°€ 1ê°œë§Œ ìˆìœ¼ë©´ @Autowired ë¥¼ ìƒëµí•´ë„ ì˜ì¡´ ê´€ê³„ ìë™ ì£¼ì… (ìŠ¤í”„ë§ ë¹ˆì—ë§Œ í•´ë‹¹)

## ìˆ˜ì •ì ì£¼ì… (setter)

- setter í•„ë“œ ê°’ì„ ë³€ê²½í•˜ëŠ” ìˆ˜ì •ì ë©”ì„œë“œë¥¼ í†µí•´ ì˜ì¡´ ê´€ê³„ë¥¼ ì£¼ì…í•˜ëŠ” ë°©ë²•

ex) OrderServiceImpl

```java
...
@Component
public class OrderServiceImpl implements OrderService{

    private MemberRepository memberRepository;
    private DiscountPolicy discountPolicy;

    @Autowired
		public void setMemberRepository(MemberRepository memberRepository) {
			this.memberRepository = memberRepository
		}

		@Autowired
		public void setDiscountPolicy(DiscountPolicy discountPolicy) {
			this.discountPolicy = discountPolicy;
		}
	
		...
}
```

- íŠ¹ì§•
  - â€œ**ì„ íƒ**, **ë³€ê²½**â€ ê°€ëŠ¥ì„±ì´ ìˆëŠ” ì˜ì¡´ ê´€ê³„ì— ì‚¬ìš©
    - ì„ íƒ : @Autowired(required = false)
    - ë³€ê²½ : ì™¸ë¶€ì—ì„œ í˜¸ì¶œ ì‹œ

> ì°¸ê³  : @Autowired ì˜ ê¸°ë³¸ ë™ì‘ì€ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤. ì£¼ì…í•  ëŒ€ìƒì´ ì—†ì–´ë„ ë™ì‘í•˜ê²Œ í•˜ë ¤ë©´ @Autowired(required = false) ë¡œ ì§€ì •í•œë‹¤.
>

> ì°¸ê³  : ìë°”ë¹ˆ í”„ë¡œí¼í‹°, ìë°”ì—ì„œëŠ” í•„ë“œì˜ ê°’ì„ ì§ì ‘ ë³€ê²½í•˜ì§€ ì•Šê³ , setXxx, getXxx ë¼ëŠ” ë©”ì„œë“œë¥¼ í†µí•´ ê°’ì„ ì½ê±°ë‚˜ ìˆ˜ì •
>

## í•„ë“œ ì£¼ì…

- í•„ë“œì— ë°”ë¡œ ì£¼ì…í•˜ëŠ” ë°©ë²•

ex) OrderServiceImpl

```java
...
@Component
public class OrderServiceImpl implements OrderService{

    @Autowired private MemberRepository memberRepository;
    @Autowired private DiscountPolicy discountPolicy;

    ...
}
```

- ì½”ë“œê°€ ê°„ê²°í•˜ì§€ë§Œ, ì™¸ë¶€ì—ì„œ ë³€ê²½ ë¶ˆê°€ëŠ¥ â†’ í…ŒìŠ¤íŠ¸í•˜ê¸° í˜ë“¦
- DI ì»¨í…Œì´ë„ˆê°€ ì—†ìœ¼ë©´ ì•ˆë¨
- ì‚¬ìš©í•˜ëŠ” ê²½ìš°
  - ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì‹¤ì œ ì½”ë“œì™€ ê´€ê³„ ì—†ëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œ
  - @Configuration : ìŠ¤í”„ë§ ì„¤ì • ëª©ì 

> ì°¸ê³  : @Autowired ëŠ” @SprintBootTest ì²˜ëŸ¼ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ í…ŒìŠ¤íŠ¸ì— í†µí•©í•œ ê²½ìš°ì—ë§Œ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.
>

## ì¼ë°˜ ë©”ì„œë“œ ì£¼ì…

- ì¼ë°˜ ë©”ì„œë“œë¥¼ í†µí•´ ì˜ì¡´ ê´€ê³„ ì£¼ì…

ex) OrderServiceImpl

```java
...
@Component
public class OrderServiceImpl implements OrderService{

    private MemberRepository memberRepository;
    private DiscountPolicy discountPolicy;

    @Autowired
    public void init(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
			this.memberRepository = memberRepository;
			this.discountPolicy = discountPolicy;
		}

		...
}
```

- íŠ¹ì§•
  - í•œ ë²ˆì— ì—¬ëŸ¬ í•„ë“œë¥¼ ì£¼ì… ë°›ì„ ìˆ˜ ìˆìŒ
  - ì¼ë°˜ì ìœ¼ë¡œ ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ

> ì°¸ê³  : ì˜ì¡´ ê´€ê³„ ìë™ ì£¼ì…ì€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ê´€ë¦¬í•˜ëŠ” ìŠ¤í”„ë§ ë¹ˆì´ì–´ì•¼ ë™ì‘í•œë‹¤.
>

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ì˜µì…˜ ì²˜ë¦¬

### ë¬¸ì œ ìƒí™©

- ì£¼ì…í•  ìŠ¤í”„ë§ ë¹ˆì´ ì—†ì–´ë„ ë™ì‘í•´ì•¼ í•  ë•Œê°€ ìˆìŒ
- @Autowired ë§Œ ì‚¬ìš© ì‹œ â€˜requiredâ€™ ì˜µì…˜ì˜ ê¸°ë³¸ ê°’ì´ â€˜trueâ€™ ë¡œ ë˜ì–´ ìˆì–´, ìë™ ì£¼ì… ëŒ€ìƒì´ ì—†ìœ¼ë©´ ì˜¤ë¥˜ ë°œìƒ

### ìë™ ì£¼ì… ëŒ€ìƒì„ ì˜µì…˜ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•

1. test/java/hello.core ì— autowired ì´ë¦„ì˜ Package ìƒì„±
2. ìƒì„±í•œ íŒ¨í‚¤ì§€ì— AutowiredTest ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.autowired;

import hello.core.member.Member;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.lang.Nullable;

import java.util.Optional;

public class AutowiredTest {

    @Test
    void AutowiredOption() {
        ApplicationContext ac = new AnnotationConfigApplicationContext(TestBean.class);
    }

    static class TestBean {

        // 1. í˜¸ì¶œ ì•ˆë¨
        @Autowired(required = false) // required ê¸°ë³¸ê°’ì€ true
        public void setNoBean1(Member noBean1) {
            System.out.println("noBean1 = " + noBean1);
        }

        // 2. null í˜¸ì¶œ
        @Autowired
        public void setNoBean2(@Nullable Member noBean2) {
            System.out.println("noBean2 = " + noBean2);
        }

        // 3. Optional.empty í˜¸ì¶œ
        @Autowired
        public void setNoBean3(Optional<Member> noBean3) {
            System.out.println("noBean3 = " + noBean3);
        }
    }
}
```

1ï¸âƒ£ @Autowired(required = false) : ìë™ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ ìˆ˜ì •ì ë©”ì„œë“œ ìì²´ê°€ í˜¸ì¶œ ì•ˆë¨

2ï¸âƒ£ org.springframework.lang.@Nullable : ìë™ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ null ì´ ì…ë ¥ë¨

3ï¸âƒ£ Optional<> : ìë™ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ Optional.empty ê°€ ì…ë ¥ë¨

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/AutowiredTest.png)

â†’ Member ì€ ìŠ¤í”„ë§ ë¹ˆì´ ì•„ë‹˜

â†’ setNoBean1() ì€ @Autowired(required=false) ì´ë¯€ë¡œ í˜¸ì¶œ ìì²´ê°€ ì•ˆë¨

> **ì°¸ê³ **
>
> @Nullable, Optional ì€ ìŠ¤í”„ë§ ì „ë°˜ì— ê±¸ì³ ì§€ì›ëœë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ìƒì„±ì ìë™ ì£¼ì…ì—ì„œ íŠ¹ì • í•„ë“œì—ë§Œ ì‚¬ìš©í•´ë„ ëœë‹¤
>

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ìƒì„±ì ì£¼ì…ì„ ì„ íƒí•´ë¼!

> ğŸ’¡ ê³¼ê±°ì—ëŠ” ìˆ˜ì •ì ì£¼ì…ê³¼ í•„ë“œ ì£¼ì…ì„ ë§ì´ ì‚¬ìš©í–ˆì§€ë§Œ, ìµœê·¼ì—ëŠ” ìŠ¤í”„ë§ì„ í¬í•¨í•œ DI í”„ë ˆì„ì›Œí¬ ëŒ€ë¶€ë¶„ì´ ìƒì„±ì ì£¼ì…ì„ ê¶Œì¥í•œë‹¤.


## ë¶ˆë³€

- ëŒ€ë¶€ë¶„ì˜ ì˜ì¡´ ê´€ê³„ ì£¼ì…ì€ í•œ ë²ˆ ì¼ì–´ë‚˜ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¢…ë£Œ ì‹œì ê¹Œì§€ ë³€ê²½í•  ì¼ì´ ì—†ìŒ (ì˜¤íˆë ¤ ë¶ˆë³€í•´ì•¼ í•¨)
- ìˆ˜ì •ì ì£¼ì… ì‚¬ìš© ì‹œ, setXxx ë©”ì„œë“œë¥¼ public ìœ¼ë¡œ ì—´ì–´ë‘ì–´ì•¼ í•¨
  - ë³€ê²½í•˜ë©´ ì•ˆë˜ëŠ” ë©”ì„œë“œë¥¼ ì—´ì–´ë‘ëŠ” ê²ƒì€ ì¢‹ì€ ì„¤ê³„ ë°©ë²•ì´ ì•„ë‹˜
- ìƒì„±ì ì£¼ì… ì‚¬ìš© ì‹œ, ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ 1ë²ˆë§Œ í˜¸ì¶œë˜ë¯€ë¡œ ë¶ˆë³€í•˜ê²Œ ì„¤ê³„ ê°€ëŠ¥

## ëˆ„ë½

### <ë¬¸ì œ ìƒí™©>

â¡ï¸ ìˆ˜ì •ì ì˜ì¡´ ê´€ê³„ì¸ ê²½ìš°

- OrderServiceImpl

```java
...
@Component
public class OrderServiceImpl implements OrderService{

    private MemberRepository memberRepository;
    private DiscountPolicy discountPolicy;

    @Autowired
    public void setMemberRepository(MemberRepository memberRepository) {
			this.memberRepository = memberRepository;
		}

		@Autowired
		public void setDiscountPolicy(DiscountPolicy discountPolicy) {
			this.discountPolicy = discountPolicy;
		}

    ...
}
```

- OrderServiceImplTest

```java
package hello.core.order;

import hello.core.discount.FixDiscountPolicy;
import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemoryMemberRepository;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.*;

class OrderServiceImplTest {

    @Test
    void createOrder() {
        OrderServiceImpl orderService = new OrderServiceImpl();
        Order order = orderService.createOrder(1L, "itemA", 10000);
    }

}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

â†’ NPE (Null Point Exception) ë°œìƒ : memberRepository, discountPolicy ëª¨ë‘ ì˜ì¡´ ê´€ê³„ ì£¼ì… ëˆ„ë½ë¨

### <í•´ê²° ë°©ë²•>

â¡ï¸ ìƒì„±ì ì£¼ì… ì‚¬ìš© & final í‚¤ì›Œë“œ

- OrderServiceImpl

```java
...
@Component
public class OrderServiceImpl implements OrderService{

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    @Autowired
    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }

    ...
}
```

â†’ ìƒì„±ì ì£¼ì… ì‚¬ìš© ì‹œ í•„ë“œì— final í‚¤ì›Œë“œ ì‚¬ìš© ê°€ëŠ¥ (ìƒì„±ìì— ê°’ì´ ì„¤ì •ë˜ì§€ ì•Šì„ ì‹œ ì˜¤ë¥˜ë¥¼ ì»´íŒŒì¼ ì‹œì ì— ë§‰ì•„ì¤Œ)

- OrderServiceImplTest

```java
...
class OrderServiceImplTest {

    @Test
    void createOrder() {
        MemoryMemberRepository memberRepository = new MemoryMemberRepository();
        memberRepository.save(new Member(1L, "name", Grade.VIP));

        OrderServiceImpl orderService = new OrderServiceImpl(new MemoryMemberRepository(), new FixDiscountPolicy());
        Order order = orderService.createOrder(1L, "itemA", 10000);

        org.assertj.core.api.Assertions.assertThat(order.getDiscountPrice()).isEqualTo(1000);
    }

}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/OrderServiceImplTest.png)

> **ì°¸ê³ **
> 
> ìˆ˜ì •ì ì£¼ì…ì„ í¬í•¨í•œ ë‚˜ë¨¸ì§€ ì£¼ì… ë°©ì‹ì€ ëª¨ë‘ ìƒì„±ì ì´í›„ì— í˜¸ì¶œë˜ë¯€ë¡œ, í•„ë“œì— final í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤. ì˜¤ì§ ìƒì„±ì ì£¼ì… ë°©ì‹ë§Œ final í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
>

## ì •ë¦¬

- ìƒì„±ì ì£¼ì… ë°©ì‹ : í”„ë ˆì„ì›Œí¬ì— ì˜ì¡´í•˜ì§€ ì•Šê³ , ìˆœìˆ˜í•œ ìë°” ì–¸ì–´ì˜ íŠ¹ì§•ì„ ì˜ ì‚´ë¦¬ëŠ” ë°©ë²•
- ê¸°ë³¸ : ìƒì„±ì ì£¼ì…
- í•„ìˆ˜ ê°’ì´ ì•„ë‹Œ ê²½ìš° : ìˆ˜ì •ì ì£¼ì…
- í•­ìƒ ìƒì„±ì ì£¼ì… ì„ íƒ í›„ ì˜µì…˜ í•„ìš” ì‹œ ìˆ˜ì •ì ì£¼ì… ì„ íƒí•˜ê¸°!
  - í•„ë“œ ì£¼ì…ì€ ê¶Œì¥í•˜ì§€ ì•ŠìŒ

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ë¡¬ë³µê³¼ ìµœì‹  íŠ¸ëœë“œ

### ë¡¬ë³µ ì ìš©í•˜ê¸°

- build.gradle ì— lombok ì„¤ì • ì¶”ê°€í•˜ê¸° & gradle refresh

```java
...

//lombok ì„¤ì • ì¶”ê°€ ì‹œì‘
configurations {
	compileOnly {
		extendsFrom annotationProcessor
	}
}
//lombok ì„¤ì • ì¶”ê°€ ë

...

dependencies {
...

	//lombok ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€ ì‹œì‘
 	compileOnly 'org.projectlombok:lombok'
 	annotationProcessor 'org.projectlombok:lombok'

	testCompileOnly 'org.projectlombok:lombok'
 	testAnnotationProcessor 'org.projectlombok:lombok'
 	//lombok ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€ ë

...
}

...
```

- lombok í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜í•˜ê¸°

![Untitled](img/lombokPlugin.png)

- Annotation Processors í™œì„±í™”í•˜ê¸°

![Untitled](img/annotationProcessors.png)

- í…ŒìŠ¤íŠ¸

```java
package hello.core;

import lombok.Getter;
import lombok.Setter;
import lombok.ToString;

@Getter
@Setter
@ToString
public class HelloLombok {

    private String name;
    private int age;

    public static void main(String[] args) {
        HelloLombok helloLombok = new HelloLombok();
        // Setter
        helloLombok.setName("alsrud");
        // Getter
        String name = helloLombok.getName();
        System.out.println("name = " + name);
        // ToString
        System.out.println("helloLombok = " + helloLombok);
    }
}
```

![Untitled](img/HelloLombok.png)

### ì½”ë“œ ìµœì í™”í•˜ê¸° - OrderServiceImpl

- ê¸°ì¡´ ì½”ë“œ

```java
...
@Component
public class OrderServiceImpl implements OrderService{

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    @Autowired // ìƒì„±ì 1ê°œì¼ ë• ìƒëµ ê°€ëŠ¥
    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }

    ...
}
```

- ë³€ê²½ëœ ì½”ë“œ

```java
...
import lombok.RequiredArgsConstructor;

@Component
@RequiredArgsConstructor
public class OrderServiceImpl implements OrderService{

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    // lombok ì˜ @RequiredArgsConstructor ê°€ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ì¤Œ
//    @Autowired
//    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
//        this.memberRepository = memberRepository;
//        this.discountPolicy = discountPolicy;
//    }

    ...
}
```

â¡ï¸ ë¡¬ë³µ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì œê³µí•˜ëŠ” @RequiredArgsConstructor ê¸°ëŠ¥ ì‚¬ìš© ì‹œ, final ì´ ë¶™ì€ í•„ë“œë¥¼ ëª¨ì•„ ìƒì„±ì ìë™ ìƒì„±

> **ì •ë¦¬**
> 
> ìµœê·¼ì—ëŠ” ìƒì„±ìë¥¼ ë”± 1ê°œ ë‘ê³ , @Autowired ë¥¼ ìƒëµí•˜ëŠ” ë°©ë²•ì„ ì£¼ë¡œ ì‚¬ìš©í•œë‹¤. ì—¬ê¸°ì— Lombok ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ @RequiredArgsConstructor ì„ í•¨ê»˜ ì‚¬ìš©í•˜ë©´, ê¸°ëŠ¥ì€ ëª¨ë‘ ì œê³µí•˜ë©´ì„œ ì½”ë“œëŠ” ê¹”ë”í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
>

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ì¡°íšŒ ë¹ˆì´ 2ê°œ ì´ìƒ - ë¬¸ì œ

- @Autowired ëŠ” íƒ€ì…(Type)ìœ¼ë¡œ ì¡°íšŒ
  - íƒ€ì…ìœ¼ë¡œ ì¡°íšŒ ì‹œ ì„ íƒëœ ë¹ˆì´ 2ê°œ ì´ìƒì¼ ë•Œ ë¬¸ì œ ë°œìƒ

- í˜„ì¬ : RateDiscountPolicy ì—ë§Œ @Component ì ìš©ë˜ì–´ ìˆìŒ

```java
...
@Component
public class RateDiscountPolicy implements DiscountPolicy{

    ...
}
```

- FixDiscountPolicy â†’ @Component ì• ë…¸í…Œì´ì…˜ ì¶”ê°€

```java
...

@Component
public class FixDiscountPolicy implements DiscountPolicy{

    ...
}
```

â¡ï¸ RateDiscountPolicy & FixDiscountPolicy ëª¨ë‘ @Component ê°€ ì ìš©ëœ ìƒíƒœ

- AutoAppConfigTest â†’ ì˜ì¡´ ê´€ê³„ ìë™ ì£¼ì… ì‹¤í–‰ ì‹œ ì˜¤ë¥˜ ë°œìƒ (NoUniqueBeanDefinitionException)

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# @Autowired í•„ë“œ ëª…, @Qualifier, @Primary

- ì¡°íšŒ ëŒ€ìƒ ë¹ˆì´ 2ê°œ ì´ìƒì¼ ë•Œ í•´ê²° ë°©ë²•
  - @Autowired í•„ë“œ ëª… ë§¤ì¹­
  - @Qualifier â†’ @Qualifier ë¼ë¦¬ ë§¤ì¹­ â†’ ë¹ˆ ì´ë¦„ ë§¤ì¹­
  - @Primary ì‚¬ìš©

## @Autowired í•„ë“œ ëª… ë§¤ì¹­

- @Autowired ëŠ” íƒ€ì… ë§¤ì¹­ì„ ì‹œë„í•˜ê³ , ì´ë•Œ ì—¬ëŸ¬ ë¹ˆì´ ìˆìœ¼ë©´ í•„ë“œ ì´ë¦„, íŒŒë¼ë¯¸í„° ì´ë¦„ìœ¼ë¡œ ë¹ˆ ì´ë¦„ì„ ì¶”ê°€ ë§¤ì¹­

- ê¸°ì¡´ ì½”ë“œ - OrderServiceImpl

```java
...
@Component
public class OrderServiceImpl implements OrderService{

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    @Autowired
    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }

    ...
}
```

- ë³€ê²½ëœ ì½”ë“œ

```java
...
@Component
public class OrderServiceImpl implements OrderService{

    private final MemberRepository memberRepository;
    private final DiscountPolicy rateDiscountPolicy;

    @Autowired
    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy rateDiscountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = rateDiscountPolicy;
    }

    ...
}
```

â†’ í•„ë“œ ëª…ì„ ë¹ˆ ì´ë¦„ìœ¼ë¡œ ë³€ê²½ : rateDiscountPolicy

- @Autowired ë§¤ì¹­ ì •ë¦¬
  1. íƒ€ì… ë§¤ì¹­
  2. íƒ€ì… ë§¤ì¹­ì˜ ê²°ê³¼ê°€ 2ê°œ ì´ìƒì¼ ë•Œ í•„ë“œ ëª…, íŒŒë¼ë¯¸í„° ëª…ìœ¼ë¡œ ë¹ˆ ì´ë¦„ ë§¤ì¹­

## @Qualifier ì‚¬ìš©

- @Qualifier ëŠ” ì¶”ê°€ êµ¬ë¶„ìë¥¼ ë¶™ì´ëŠ” ë°©ë²• (ë¹ˆ ì´ë¦„ ë³€ê²½X)

- ë¹ˆ ë“±ë¡ ì‹œ @Qualifier ì¶”ê°€ : RateDiscountPolicy & FixDiscountPolicy

```java
//RateDiscountPolicy
...
@Component
@Qualifier("mainDiscountPolicy")
public class RateDiscountPolicy implements DiscountPolicy{

    ...
}

//FixDiscountPolicy
...
@Component
@Qualifier("fixDiscountPolicy")
public class FixDiscountPolicy implements DiscountPolicy{

    ...
}
```

- ìƒì„±ì ìë™ ì£¼ì… : OrderServiceImpl

```java
...
@Component
public class OrderServiceImpl implements OrderService{

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    @Autowired
    public OrderServiceImpl(MemberRepository memberRepository, @Qualifier("mainDiscountPolicy") DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }

    ...
}
```

- @Qualifier ì •ë¦¬
  1. @Qualifier ë¼ë¦¬ ë§¤ì¹­
  2. ë¹ˆ ì´ë¦„ ë§¤ì¹­
  3. NoSuchBeanDefinitionException ì˜ˆì™¸ ë°œìƒ

## @Primary ì‚¬ìš©

- @Primary ëŠ” ìš°ì„  ìˆœìœ„ë¥¼ ì •í•˜ëŠ” ë°©ë²•
- @Autowired ì‹œ ì—¬ëŸ¬ ë¹ˆì´ ë§¤ì¹­ë˜ë©´ @Primary ê°€ ìš°ì„ ê¶Œì„ ê°€ì§

- ìš°ì„ ê¶Œ ë¶€ì—¬ : rateDiscountPolicy

```java
//RateDiscountPolicy
...
@Component
@Primary
public class RateDiscountPolicy implements DiscountPolicy{

    ...
}

//FixDiscountPolicy
...
@Component
public class FixDiscountPolicy implements DiscountPolicy{

    ...
}

//OrderServiceImpl
...
@Component
public class OrderServiceImpl implements OrderService{

    ...
    @Autowired
    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }

    ...
}
```

> **@Primary vs. @Qualifier**
> 
> - @Qualifier ë‹¨ì  : ì£¼ì… ë°›ì„ ë•Œ ëª¨ë“  ì½”ë“œì— @Qualifier ë¥¼ ë¶™ì—¬ì£¼ì–´ì•¼ í•¨
> - ë©”ì¸ ë°ì´í„°ë² ì´ìŠ¤ì˜ ì»¤ë„¥ì…˜ì„ íšë“í•˜ëŠ” ìŠ¤í”„ë§ ë¹ˆ : @Primary ì ìš©í•˜ì—¬ @Qualifier ì§€ì • ì—†ì´ í¸ë¦¬í•˜ê²Œ ì¡°íšŒ
> - ì„œë¸Œ ë°ì´í„°ë² ì´ìŠ¤ì˜ ì»¤ë„¥ì…˜ì„ íšë“í•˜ëŠ” ìŠ¤í”„ë§ ë¹ˆ : @Qualifier ì§€ì •í•˜ì—¬ ëª…ì‹œì ìœ¼ë¡œ íšë“
> - ìš°ì„  ìˆœìœ„ : @Primary(ê¸°ë³¸ê°’) < @Qualifier(ìƒì„¸í•œ ë™ì‘)
>

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ì• ë…¸í…Œì´ì…˜ ì§ì ‘ ë§Œë“¤ê¸°

### ë¬¸ì œ ìƒí™©

- @Qualifier(â€mainDiscountPolicyâ€) ë°©ì‹ìœ¼ë¡œ ë¬¸ì ì‘ì„± ì‹œ ì»´íŒŒì¼ ê³¼ì • ì¤‘ íƒ€ì… ì²´í¬ê°€ ì•ˆë¨

### í•´ê²° ë°©ë²•

1. main/java/hello.core ì— annotation ì´ë¦„ì˜ Package ìƒì„±
2. ìƒì„±í•œ íŒ¨í‚¤ì§€ì— MainDiscountPolicy ì´ë¦„ì˜ Annotation ìƒì„±

```java
package hello.core.annotation;

import org.springframework.beans.factory.annotation.Qualifier;
import java.lang.annotation.*;

@Target({ElementType.FIELD, ElementType.METHOD, ElementType.PARAMETER,
        ElementType.TYPE, ElementType.ANNOTATION_TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Qualifier("mainDiscountPolicy")
public @interface MainDiscountPolicy {
}
```

3. ìƒì„±í•œ ì• ë…¸í…Œì´ì…˜ RateDiscountPolicy ì½”ë“œì— ì¶”ê°€

```java
...

@Component
@MainDiscountPolicy
public class RateDiscountPolicy implements DiscountPolicy{

    ...
}
```

4. ìƒì„±í•œ ì• ë…¸í…Œì´ì…˜ OrderServiceImpl ì½”ë“œì— ì¶”ê°€

```java
...

@Component
public class OrderServiceImpl implements OrderService{

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    @Autowired
    public OrderServiceImpl(MemberRepository memberRepository, @MainDiscountPolicy DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }

    ...
}
```

> **ì°¸ê³ **
>
> ì• ë…¸í…Œì´ì…˜ì—ëŠ” ìƒì†ì˜ ê°œë…ì´ ì—†ë‹¤. ì—¬ëŸ¬ ì• ë…¸í…Œì´ì…˜ì„ ëª¨ì•„ ì‚¬ìš©í•˜ëŠ” ê¸°ëŠ¥ì€ ìŠ¤í”„ë§ì´ ì§€ì›í•´ì£¼ëŠ” ê¸°ëŠ¥ì´ë‹¤. @Qualifier ë¿ë§Œ ì•„ë‹ˆë¼ ë‹¤ë¥¸ ì• ë…¸í…Œì´ì…˜ë“¤ë„ í•¨ê»˜ ì¡°í•©í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. @Autowired ì¬ì •ì˜ë„ ê°€ëŠ¥í•˜ë‹¤. í•˜ì§€ë§Œ, ëšœë ·í•œ ëª©ì  ì—†ì´ ë¬´ë¶„ë³„í•˜ê²Œ ì¬ì •ì˜ í•˜ëŠ” ê²ƒì€ ìœ ì§€ ë³´ìˆ˜ì— í˜¼ë€ì„ ê°€ì¤‘í•  ìˆ˜ ìˆë‹¤.
>

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ì¡°íšŒí•œ ë¹ˆì´ ëª¨ë‘ í•„ìš”í•  ë•Œ, List, Map

- í•´ë‹¹ íƒ€ì…ì˜ ìŠ¤í”„ë§ ë¹ˆì´ ëª¨ë‘ í•„ìš”í•œ ê²½ìš° ë°œìƒ
  - ex) í´ë¼ì´ì–¸íŠ¸ê°€ í• ì¸ì˜ ì¢…ë¥˜(rate, fix)ë¥¼ ì„ íƒí•˜ëŠ” ê²½ìš°

1. test/java/hello.core/autowired ì— AllBeanTest ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.autowired;

import hello.core.AutoAppConfig;
import hello.core.discount.DiscountPolicy;
import hello.core.member.Grade;
import hello.core.member.Member;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

import java.util.List;
import java.util.Map;

import static org.assertj.core.api.Assertions.assertThat;

public class AllBeanTest {

    @Test
    void findAllBean() {
        ApplicationContext ac = new AnnotationConfigApplicationContext(AutoAppConfig.class, DiscountService.class);

        DiscountService discountService = ac.getBean(DiscountService.class);
        Member member = new Member(1L, "userA", Grade.VIP);
        int discountPrice = discountService.discount(member, 10000, "fixDiscountPolicy");

        assertThat(discountService).isInstanceOf(DiscountService.class);
        assertThat(discountPrice).isEqualTo(1000);

        int rateDiscountPrice = discountService.discount(member, 20000, "rateDiscountPolicy");
        assertThat(rateDiscountPrice).isEqualTo(2000);
    }

    static class DiscountService {
        private final Map<String, DiscountPolicy> policyMap;
        private final List<DiscountPolicy> policies;

        @Autowired
        public DiscountService(Map<String, DiscountPolicy> policyMap, List<DiscountPolicy> policies) {
            this.policyMap = policyMap;
            this.policies = policies;
            System.out.println("policyMap = " + policyMap);
            System.out.println("policies = " + policies);
        }

        public int discount(Member member, int price, String discountCode) {
            DiscountPolicy discountPolicy = policyMap.get(discountCode);
            return discountPolicy.discount(member, price);
        }
    }
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/AllBeanTest.png)

### ë¡œì§ ë¶„ì„

- DiscountService : Map ìœ¼ë¡œ ëª¨ë“  DiscountPolicy ë¥¼ ì£¼ì… ë°›ìŒ (fixDiscountPolicy, rateDiscountPolicy)
- discount() : discountCode ë¡œ â€œfixDiscountPolicyâ€ ê°€ ë„˜ì–´ì˜¤ë©´ map ì—ì„œ fixDiscountPolicy ìŠ¤í”„ë§ ë¹ˆì„ ì°¾ì•„ ì‹¤í–‰ (â€rateDiscountPolicyâ€ â†’ rateDiscountPolicy ìŠ¤í”„ë§ ë¹ˆ ì‹¤í–‰)

### ì£¼ì… ë¶„ì„

- Map<String, DiscountPolicy> : map ì˜ key ì— ìŠ¤í”„ë§ ë¹ˆì˜ ì´ë¦„ì„ ë„£ì–´ì£¼ê³ , ê·¸ ê°’ìœ¼ë¡œ DiscountPolicy íƒ€ì…ìœ¼ë¡œ ì¡°íšŒí•œ ëª¨ë“  ìŠ¤í”„ë§ ë¹ˆ ë‹´ì•„ì¤Œ
- List<DiscountPolicy> : DiscountPolicy íƒ€ì…ìœ¼ë¡œ ì¡°íšŒí•œ ëª¨ë“  ìŠ¤í”„ë§ ë¹ˆ ë‹´ì•„ì¤Œ
- í•´ë‹¹í•˜ëŠ” íƒ€ì…ì˜ ìŠ¤í”„ë§ ë¹ˆì´ ì—†ì„ ì‹œ, ë¹ˆ ì»¬ë ‰ì…˜ì´ë‚˜ Map ì£¼ì…  
  
> **ì°¸ê³  - ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ìƒì„±í•˜ë©´ì„œ ìŠ¤í”„ë§ ë¹ˆ ë“±ë¡í•˜ê¸°**
>
> ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” ìƒì„±ìì— í´ë˜ìŠ¤ ì •ë³´ë¥¼ ë°›ëŠ”ë‹¤. ì—¬ê¸°ì— í´ë˜ìŠ¤ ì •ë³´ë¥¼ ë„˜ê¸°ë©´ í•´ë‹¹ í´ë˜ìŠ¤ê°€ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ìë™ ë“±ë¡ëœë‹¤.  
> ex) new AnnotationConfigApplicationContext(AutoAppConfig.class, DiscountService.class);  
> â†’ new AnnotationConfigApplicationContext() ë¥¼ í†µí•´ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„±  
> â†’ AutoAppConfig.class, DiscountService.class ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë„˜ê¸°ë©´ì„œ í•´ë‹¹ í´ë˜ìŠ¤ë¥¼ ìë™ìœ¼ë¡œ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡
>
> ì •ë¦¬ : ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ìƒì„±í•˜ë©´ì„œ, í•´ë‹¹ ì»¨í…Œì´ë„ˆì— AutoAppConfig, DiscountService ë¥¼ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ìë™ ë“±ë¡
>

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ìë™, ìˆ˜ë™ì˜ ì˜¬ë°”ë¥¸ ì‹¤ë¬´ ìš´ì˜ ê¸°ì¤€

### í¸ë¦¬í•œ ìë™ ê¸°ëŠ¥ì„ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©í•˜ê¸°

- @Component, @Controller, @Service, @Repository ì¼ë°˜ì ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œì§ ìë™ ìŠ¤ìº” ê¸°ëŠ¥ ì§€ì›
- ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì„ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©
- ìë™ ë¹ˆ ì‚¬ìš© â†’ OCP, DIP ì§€í‚¬ ìˆ˜ ìˆìŒ

### ìˆ˜ë™ ë¹ˆ ë“±ë¡ì„ ì‚¬ìš©í•˜ëŠ” ì‹œì 

- ì• í”Œë¦¬ì¼€ì´ì…˜ì— ê´‘ë²”ìœ„í•˜ê²Œ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ê¸°ìˆ  ì§€ì› ê°ì²´ëŠ” ìˆ˜ë™ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ì—¬ ì„¤ì • ì •ë³´ì— ë°”ë¡œ ë‚˜íƒ€ë‚˜ê²Œ í•˜ëŠ” ê²ƒì´ ìœ ì§€ë³´ìˆ˜ í•˜ê¸° ì¢‹ìŒ

> ì• í”Œë¦¬ì¼€ì´ì…˜ì€ í¬ê²Œ ì—…ë¬´ ë¡œì§ê³¼ ê¸°ìˆ  ì§€ì› ë¡œì§ìœ¼ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤.

**ì—…ë¬´ ë¡œì§ ë¹ˆ**
- ì›¹ì„ ì§€ì›í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬, í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ìˆëŠ” ì„œë¹„ìŠ¤, ë°ì´í„° ê³„ì¸µì˜ ë¡œì§ì„ ì²˜ë¦¬í•˜ëŠ” ë¦¬í¬ì§€í† ë¦¬ ë“±
- ë³´í†µ ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ ê°œë°œ ì‹œ ì¶”ê°€ë˜ê±°ë‚˜ ë³€ê²½ë¨
- ìë™ ê¸°ëŠ¥ ê¶Œì¥

**ê¸°ìˆ  ì§€ì› ë¹ˆ
-** ê¸°ìˆ ì ì¸ ë¬¸ì œë‚˜ ê³µí†µ ê´€ì‹¬ì‚¬(AOP)ë¥¼ ì²˜ë¦¬í•  ë•Œ ì£¼ë¡œ ì‚¬ìš©
- ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° & ê³µí†µ ë¡œê·¸ ì²˜ë¦¬ì²˜ëŸ¼ ì—…ë¬´ ë¡œì§ì„ ì§€ì›í•˜ê¸° ìœ„í•œ í•˜ë¶€ ê¸°ìˆ ì´ë‚˜ ê³µí†µ ê¸°ìˆ ë“¤
- ìˆ˜ë™ ë¹ˆ ë“±ë¡ ê¶Œì¥
>

### ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì¤‘ ë‹¤í˜•ì„±ì„ í™œìš©í•˜ëŠ” ì‹œì 

- ìˆ˜ë™ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ê±°ë‚˜, ìë™ì¼ ë•Œì—ëŠ” **íŠ¹ì • íŒ¨í‚¤ì§€ì— ê°™ì´ ë¬¶ì–´** ë‘ê¸°

ex) DiscountPolicyConfig

```java
@Configuration
public class DiscountPolicyConfig {
	@Bean
	public DiscountPolicy rateDiscountPolicy() {
		return new RateDiscountPolicy();
	}
	@Bean
	public DiscountPolicy fixDiscountPolicy() {
		return new FixDiscountPolicy();
	}
}
```

â†’ ë¹ˆ ì´ë¦„ & ì–´ë–¤ ë¹ˆë“¤ì´ ì£¼ì…ë ì§€ íŒŒì•… ê°€ëŠ¥

âœ”ï¸ ìŠ¤í”„ë§ê³¼ ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ ìë™ìœ¼ë¡œ ë“±ë¡í•˜ëŠ” ìˆ˜ë§ì€ ë¹ˆë“¤ì€ ì˜ˆì™¸

âœ”ï¸ ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ ì•„ë‹ˆë¼ ë‚´ê°€ ì§ì ‘ ê¸°ìˆ  ì§€ì› ê°ì²´ë¥¼ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡í•œë‹¤ë©´ ìˆ˜ë™ìœ¼ë¡œ ë“±ë¡í•´ ëª…í™•í•˜ê²Œ ë“œëŸ¬ë‚´ê¸°

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ğŸ¾ğŸ¾ğŸ¾ ë¹ˆ ìƒëª…ì£¼ê¸° ì½œë°± ğŸ¾ğŸ¾ğŸ¾

# ë¹ˆ ìƒëª…ì£¼ê¸° ì½œë°± ì‹œì‘

- ë°ì´í„°ë² ì´ìŠ¤ ì»¤ë„¥ì…˜ í’€ì´ë‚˜ ë„¤íŠ¸ì›Œí¬ ì†Œì¼“ì²˜ëŸ¼ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘ ì‹œì ì— í•„ìš”í•œ ì—°ê²°ì„ ë¯¸ë¦¬ í•´ë‘ê³ , ì• í”Œë¦¬ì¼€ì´ì…˜ ì¢…ë£Œ ì‹œì ì— ì—°ê²°ì„ ëª¨ë‘ ì¢…ë£Œí•˜ëŠ” ì‘ì—… ì§„í–‰ ì‹œ, **ê°ì²´ì˜ ì´ˆê¸°í™”**ì™€ **ì¢…ë£Œ ì‘ì—…**ì´ í•„ìš”

### ë¬¸ì œ ìƒí™©

- ìƒí™© ê°€ì •
  - ê°„ë‹¨í•˜ê²Œ ì™¸ë¶€ ë„¤íŠ¸ì›Œí¬ì— ë¯¸ë¦¬ ì—°ê²°í•˜ëŠ” ê°ì²´ë¥¼ í•˜ë‚˜ ìƒì„±
  - ì‹¤ì œ ë„¤íŠ¸ì›Œí¬ ì—°ê²°X, ë‹¨ìˆœ ë¬¸ì ì¶œë ¥
  - NetworkClient : ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘ ì‹œì ì— connect() í˜¸ì¶œë¡œ ì—°ê²°, ì¢…ë£Œ ì‹œì ì— disconnect() í˜¸ì¶œë¡œ ì—°ê²° í•´ì œ

1. test/java/hello.core ì— lifecycle ì´ë¦„ì˜ Package ìƒì„±
2. ìƒì„±í•œ íŒ¨í‚¤ì§€ì— NetworkClient ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.lifecycle;

public class NetworkClient {

    private String url;

    public NetworkClient() {
        System.out.println("ìƒì„±ì í˜¸ì¶œ, url = " + url);
        connect();
        call("ì´ˆê¸°í™” ì—°ê²° ë©”ì„¸ì§€");
    }

    public void setUrl(String url) {
        this.url = url;
    }

    // ì„œë¹„ìŠ¤ ì‹œì‘ ì‹œ í˜¸ì¶œ
    public void connect() {
        System.out.println("connect: " + url);
    }

    public void call(String message) {
        System.out.println("call: " + url + " message: " + message);
    }

    // ì„œë¹„ìŠ¤ ì¢…ë£Œ ì‹œ í˜¸ì¶œ
    public void disconnect() {
        System.out.println("close: " + url);
    }
}
```

3. lifecycle íŒ¨í‚¤ì§€ì— BeanLifeCycleTest ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.lifecycle;

import org.junit.jupiter.api.Test;
import org.springframework.context.ApplicationContext;
import org.springframework.context.ConfigurableApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

public class BeanLifeCycleTest {

    @Test
    public void lifeCycleTest() {
        ConfigurableApplicationContext ac = new AnnotationConfigApplicationContext(LifeCycleConfig.class);
        NetworkClient client = ac.getBean(NetworkClient.class);
        ac.close();
    }

    @Configuration
    static class LifeCycleConfig {
        @Bean
        public NetworkClient networkClient() {
            NetworkClient networkClient = new NetworkClient();
            networkClient.setUrl("http://hello-spring.dev");
            return networkClient;
        }
    }
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/BeanLifeCycleTest.png)

â†’ ê°ì²´ ìƒì„± í›„ ìˆ˜ì •ì ì£¼ì…ìœ¼ë¡œ url ì´ null ë¡œ ì¶œë ¥ë¨

### ìŠ¤í”„ë§ ë¹ˆ ë¼ì´í”„ì‚¬ì´í´

1. ê°ì²´ ìƒì„±
2. ì˜ì¡´ ê´€ê³„ ì£¼ì…

### ìŠ¤í”„ë§ ë¹ˆ ì´ë²¤íŠ¸ ë¼ì´í”„ì‚¬ì´í´

1. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„±
2. ìŠ¤í”„ë§ ë¹ˆ ìƒì„±
3. ì˜ì¡´ ê´€ê³„ ì£¼ì…
4. ì´ˆê¸°í™” ì½œë°± (ë¹ˆì´ ìƒì„±ë˜ê³ , ë¹ˆì˜ ì˜ì¡´ ê´€ê³„ ì£¼ì…ì´ ì™„ë£Œ í›„ í˜¸ì¶œ)
5. ì‚¬ìš©
6. ì†Œë©¸ ì „ ì½œë°± (ë¹ˆì´ ì†Œë©¸ë˜ê¸° ì§ì „ í˜¸ì¶œ)
7. ìŠ¤í”„ë§ ì¢…ë£Œ

> **ì°¸ê³  - ê°ì²´ì˜ ìƒì„±ê³¼ ì´ˆê¸°í™” ë¶„ë¦¬í•˜ê¸°**
>
> - ìƒì„±ìëŠ” í•„ìˆ˜ ì •ë³´(íŒŒë¼ë¯¸í„°)ë¥¼ ë°›ê³ , ë©”ëª¨ë¦¬ë¥¼ í• ë‹¹í•˜ì—¬ ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ì±…ì„ì„ ê°€ì§„ë‹¤. ë°˜ë©´ì— ì´ˆê¸°í™”ëŠ” ìƒì„±ëœ ê°’ë“¤ì„ í™œìš©í•´ ì™¸ë¶€ ì»¤ë„¥ì…˜ì„ ì—°ê²°í•˜ëŠ” ë¬´ê±°ìš´ ë™ì‘ì„ ìˆ˜í–‰í•œë‹¤.
> - ë”°ë¼ì„œ ìƒì„±ì ì•ˆì—ì„œ ë¬´ê±°ìš´ ì´ˆê¸°í™” ì‘ì—…ì„ í•¨ê»˜ í•˜ëŠ” ê²ƒë³´ë‹¤ ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ë¶€ë¶„ê³¼ ì´ˆê¸°í™”í•˜ëŠ” ë¶€ë¶„ì„ ëª…í™•í•˜ê²Œ ë‚˜ëˆ„ëŠ” ê²ƒì´ ìœ ì§€ë³´ìˆ˜ ê´€ì ì—ì„œ ì¢‹ë‹¤.
> - ë¬¼ë¡  ì´ˆê¸°í™” ì‘ì—…ì´ ë‚´ë¶€ ê°’ë“¤ë§Œ ì•½ê°„ ë³€ê²½í•˜ëŠ” ì •ë„ë¡œ ë‹¨ìˆœí•œ ê²½ìš°ì—ëŠ” ìƒì„±ìì—ì„œ í•œ ë²ˆì— ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ë‚˜ì„ ìˆ˜ ìˆë‹¤.
>

### ìŠ¤í”„ë§ì´ ë¹ˆ ìƒëª…ì£¼ê¸° ì½œë°±ì„ ì§€ì›í•˜ëŠ” ë°©ë²• 3ê°€ì§€

1. ì¸í„°í˜ì´ìŠ¤ (InitializingBean, DisposableBean)
2. ì„¤ì • ì •ë³´ì— ì´ˆê¸°í™” ë©”ì„œë“œ, ì¢…ë£Œ ë©”ì„œë“œ ì§€ì •
3. @PostConstruct, @PreDestroy ì• ë…¸í…Œì´ì…˜ ì§€ì›

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ì¸í„°í˜ì´ìŠ¤ InitializingBean, DisposableBean

- NetworkClient ì—ì„œ InitializingBean, DisposableBean êµ¬í˜„í•˜ê¸°

âœ… InitializingBean : afterPropertiesSet() ë©”ì„œë“œë¡œ ì´ˆê¸°í™” ì§€ì›

âœ… DisposableBean : destroy() ë©”ì„œë“œë¡œ ì†Œë©¸ ì§€ì›

```java
package hello.core.lifecycle;

import org.springframework.beans.factory.DisposableBean;
import org.springframework.beans.factory.InitializingBean;

public class NetworkClient implements InitializingBean, DisposableBean {

    ...

    @Override
    public void afterPropertiesSet() throws Exception {
        System.out.println("NetworkClient.afterPropertiesSet");
        connect();
        call("ì´ˆê¸°í™” ì—°ê²° ë©”ì„¸ì§€");
    }

    @Override
    public void destroy() throws Exception {
        System.out.println("NetworkClient.destroy");
        disconnect();
    }
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/InitializingBean.png)

â†’ ì´ˆê¸°í™” ë©”ì„œë“œ ì£¼ì… ì™„ë£Œ í›„ ì ì ˆí•˜ê²Œ í˜¸ì¶œ

â†’ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ì¢…ë£Œ í›„ ì†Œë©¸ ë©”ì„œë“œ í˜¸ì¶œ

### ì´ˆê¸°í™”, ì†Œë©¸ ì¸í„°í˜ì´ìŠ¤ ë‹¨ì 

- ìŠ¤í”„ë§ ì „ìš© ì¸í„°í˜ì´ìŠ¤ ì˜ì¡´
- ì´ë¦„ ë³€ê²½ ë¶ˆê°€
- ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ì ìš© ë¶ˆê°€ (ì½”ë“œë¥¼ ê³ ì¹  ìˆ˜ ì—†ìŒ)

> **ì°¸ê³ **
>
> ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ˆê¸°í™”, ì¢…ë£Œ ë°©ë²•ì€ ìŠ¤í”„ë§ ì´ˆì°½ê¸° ë‚˜ì˜¨ ë°©ë²•ë“¤ë¡œ, ì§€ê¸ˆì€ ê±°ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.
>

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ë¹ˆ ë“±ë¡ ì´ˆê¸°í™”, ì†Œë©¸ ë©”ì„œë“œ

- NetworkClient ì½”ë“œ ë³€ê²½

```java
package hello.core.lifecycle;

public class NetworkClient {

    ...

    public void init() {
        System.out.println("NetworkClient.afterPropertiesSet");
        connect();
        call("ì´ˆê¸°í™” ì—°ê²° ë©”ì„¸ì§€");
    }

    public void close() {
        System.out.println("NetworkClient.destroy");
        disconnect();
    }
}
```

- BeanLifeCycleTest ì½”ë“œ ë³€ê²½

```java
...

public class BeanLifeCycleTest {

    ...

    @Configuration
    static class LifeCycleConfig {
        @Bean(initMethod = "init", destroyMethod = "close")
        public NetworkClient networkClient() {
            ...
        }
    }
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/ë¹ˆë“±ë¡_init&close.png)

### ì„¤ì • ì •ë³´ ì‚¬ìš© íŠ¹ì§•

- ë©”ì„œë“œ ì´ë¦„ì„ ììœ ë¡­ê²Œ ì„¤ì • ê°€ëŠ¥
- ìŠ¤í”„ë§ ë¹ˆì´ ìŠ¤í”„ë§ ì½”ë“œì— ì˜ì¡´í•˜ì§€ ì•ŠìŒ
- ì„¤ì • ì •ë³´ë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ì½”ë“œë¥¼ ê³ ì¹  ìˆ˜ ì—†ëŠ” ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ë„ ì´ˆê¸°í™”, ì¢…ë£Œ ë©”ì„œë“œ ì ìš© ê°€ëŠ¥

### ì¢…ë£Œ ë©”ì„œë“œ ì¶”ë¡  : @Bean ì˜ destroyMethod

- ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ëŒ€ë¶€ë¶„ close, shutdown ì´ë¦„ì˜ ì¢…ë£Œ ë©”ì„œë“œ ì‚¬ìš©
- @Bean ì˜ destroyMethod ê¸°ë³¸ê°’ : (inferred)
    - close, shutdown ì´ë¦„ì˜ ë©”ì„œë“œ ìë™ í˜¸ì¶œ (ì¢…ë£Œ ë©”ì„œë“œ ì¶”ë¡  í›„ í˜¸ì¶œ)
    - ë”°ë¼ì„œ ì§ì ‘ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡ ì‹œ ì¢…ë£Œ ë©”ì„œë“œë¥¼ ë”°ë¡œ ì§€ì •í•´ì£¼ì§€ ì•Šì•„ë„ ë¨
- ì¶”ë¡  ê¸°ëŠ¥ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë ¤ë©´ destroyMethod = â€œ â€œ ì²˜ëŸ¼ ë¹ˆ ê³µë°± ì§€ì •

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ì• ë…¸í…Œì´ì…˜ @PostConstruct, @PreDestroy

- ì´ ë°©ë²• ì“°ê¸° ğŸ˜Š

- NetworkClient ì½”ë“œì— ì• ë…¸í…Œì´ì…˜ ì¶”ê°€

```java
package hello.core.lifecycle;

import jakarta.annotation.PostConstruct;
import jakarta.annotation.PreDestroy;

public class NetworkClient {

    ...

    @PostConstruct
    public void init() {
        ...
    }

    @PreDestroy
    public void close() {
        ...
    }
}
```

- BeanLifeCycleTest ì½”ë“œ ë³€ê²½

```java
...
public class BeanLifeCycleTest {

    ...

    @Configuration
    static class LifeCycleConfig {
        @Bean
        public NetworkClient networkClient() {
            ...
        }
    }
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/PostConstruct.png)

â†’ @PostConstruct, @PreDestroy ì• ë…¸í…Œì´ì…˜ ì‚¬ìš© ì‹œ ê°€ì¥ í¸ë¦¬í•˜ê²Œ ì´ˆê¸°í™”ì™€ ì¢…ë£Œ ì‹¤í–‰ ê°€ëŠ¥

### @PostConstruct, @PreDestroy ì• ë…¸í…Œì´ì…˜ íŠ¹ì§•

- ìµœì‹  ìŠ¤í”„ë§ì—ì„œ ê°€ì¥ ê¶Œì¥í•˜ëŠ” ë°©ë²•
- ë§¤ìš° í¸ë¦¬
- javax.annotation.PostConstruct : ìë°” í‘œì¤€ íŒ¨í‚¤ì§€ â†’ ìŠ¤í”„ë§ì´ ì•„ë‹Œ ë‹¤ë¥¸ ì»¨í…Œì´ë„ˆì—ì„œë„ ë™ì‘
- ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ê³¼ ì˜ ì–´ìš¸ë¦¼
- ìœ ì¼í•œ ë‹¨ì  : ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì ìš© ë¶ˆê°€
    - ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì´ˆê¸°í™”, ì¢…ë£Œ ì‹œ @Bean ê¸°ëŠ¥ ì‚¬ìš©

> **ì •ë¦¬**
>
> - @PostConstruct, @PreDestroy ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ì !!
> - ì½”ë“œë¥¼ ê³ ì¹  ìˆ˜ ì—†ëŠ” ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì´ˆê¸°í™”, ì¢…ë£Œí•´ì•¼ í•˜ë©´ @Bean ì˜ initMethod, destroyMethod ë¥¼ ì‚¬ìš©í•˜ì
>

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ğŸ¾ğŸ¾ğŸ¾ ë¹ˆ ìŠ¤ì½”í”„ ğŸ¾ğŸ¾ğŸ¾

# ë¹ˆ ìŠ¤ì½”í”„ë€?

- ìŠ¤í”„ë§ ë¹ˆì€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì˜ ì‹œì‘ê³¼ í•¨ê»˜ ìƒì„±ë˜ì–´ ì¢…ë£Œë  ë•Œê¹Œì§€ ìœ ì§€
    - ìŠ¤í”„ë§ ë¹ˆì´ ê¸°ë³¸ì ìœ¼ë¡œ ì‹±ê¸€í†¤ ìŠ¤ì½”í”„ë¡œ ìƒì„±ë˜ê¸° ë•Œë¬¸
        - ìŠ¤ì½”í”„ : ë¹ˆì´ ì¡´ì¬í•  ìˆ˜ ìˆëŠ” ë²”ìœ„

### ìŠ¤í”„ë§ì´ ì§€ì›í•˜ëŠ” ìŠ¤ì½”í”„

- **ì‹±ê¸€í†¤** : ê¸°ë³¸ ìŠ¤ì½”í”„, ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì˜ ì‹œì‘ê³¼ ì¢…ë£Œê¹Œì§€ ìœ ì§€ë˜ëŠ” ê°€ì¥ ë„“ì€ ë²”ìœ„ì˜ ìŠ¤ì½”í”„
- **í”„ë¡œí† íƒ€ì…** : ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ í”„ë¡œí† íƒ€ì… ë¹ˆì˜ ìƒì„±ê³¼ ì˜ì¡´ ê´€ê³„ ì£¼ì…ê¹Œì§€ë§Œ ê´€ì—¬í•˜ê³ , ë”ëŠ” ê´€ë¦¬í•˜ì§€ ì•ŠëŠ” ë§¤ìš° ì§§ì€ ë²”ìœ„ì˜ ìŠ¤ì½”í”„
- **ì›¹ ê´€ë ¨ ìŠ¤ì½”í”„**
    - **request** : ì›¹ ìš”ì²­ì´ ë“¤ì–´ì˜¤ê³  ë‚˜ê°ˆ ë•Œê¹Œì§€ ìœ ì§€ë˜ëŠ” ìŠ¤ì½”í”„
    - **session** : ì›¹ ì„¸ì…˜ì´ ìƒì„±ë˜ê³  ì¢…ë£Œë  ë•Œê¹Œì§€ ìœ ì§€ë˜ëŠ” ìŠ¤ì½”í”„
    - **application** : ì›¹ì˜ ì„œë¸”ë¦¿ ì»¨í…ìŠ¤íŠ¸ì™€ ê°™ì€ ë²”ìœ„ë¡œ ìœ ì§€ë˜ëŠ” ìŠ¤ì½”í”„


### ë¹ˆ ìŠ¤ì½”í”„ ì§€ì •í•˜ëŠ” ë°©ë²•

- ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ìë™ ë“±ë¡

```java
@Scope("prototype")
```

- ìˆ˜ë™ ë“±ë¡
```java
@Scope("prototype")
@Bean
PrototypeBean HelloBean() {
	return new HelloBean();
}
```

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„

- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì—ì„œ **í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„** ì¡°íšŒ ì‹œ, ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” *í•­ìƒ ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤*ë¥¼ ìƒì„± í›„ ë°˜í™˜
    - cf) ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ **ì‹±ê¸€í†¤ ìŠ¤ì½”í”„**ì˜ ë¹ˆ ì¡°íšŒ ì‹œ, *í•­ìƒ ê°™ì€ ì¸ìŠ¤í„´ìŠ¤*ì˜ ìŠ¤í”„ë§ ë¹ˆ ë°˜í™˜

### ì‹±ê¸€í†¤ ë¹ˆ ìš”ì²­

![Untitled](img/singletonscope.png)

1. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ì‹±ê¸€í†¤ ìŠ¤ì½”í”„ì˜ ë¹ˆ ìš”ì²­
2. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” ë³¸ì¸ì´ ê´€ë¦¬í•˜ëŠ” ìŠ¤í”„ë§ ë¹ˆ ë°˜í™˜
3. ì´í›„ ê°™ì€ ìš”ì²­ì´ ì™€ë„, ê°™ì€ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ì˜ ìŠ¤í”„ë§ ë¹ˆ ë°˜í™˜

### í”„ë¡œí† íƒ€ì… ë¹ˆ ìš”ì²­

![Untitled](img/prototypescope.png)

1. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ì˜ ë¹ˆ ìš”ì²­
2. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” ì´ ì‹œì ì— í”„ë¡œí† íƒ€ì… ë¹ˆì„ ìƒì„±í•˜ê³ , í•„ìš”í•œ ì˜ì¡´ ê´€ê³„ ì£¼ì…

![Untitled](img/prototypescope2.png)

3. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” ìƒì„±í•œ í”„ë¡œí† íƒ€ì… ë¹ˆì„ í´ë¼ì´ì–¸íŠ¸ì— ë°˜í™˜
4. ì´í›„ ê°™ì€ ìš”ì²­ì´ ì˜¤ë©´, í•­ìƒ ìƒˆë¡œìš´ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ìƒì„± í›„ ë°˜í™˜

> **ì •ë¦¬**
>
> í•µì‹¬ì€ **ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ìƒì„±í•˜ê³ , ì˜ì¡´ ê´€ê³„ ì£¼ì…, ì´ˆê¸°í™”ê¹Œì§€ë§Œ ì²˜ë¦¬í•œë‹¤ëŠ” ê²ƒ**ì´ë‹¤. í´ë¼ì´ì–¸íŠ¸ì— ë¹ˆì„ ë°˜í™˜í•œ í›„, ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” ìƒì„±í•œ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ê´€ë¦¬í•˜ì§€ ì•ŠëŠ”ë‹¤. í”„ë¡œí† íƒ€ì… ë¹ˆì„ ê´€ë¦¬í•  ì±…ì„ì€ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ë°›ì€ í´ë¼ì´ì–¸íŠ¸ì— ìˆë‹¤. ê·¸ë˜ì„œ @PreDestroy ê°™ì€ **ì¢…ë£Œ ë©”ì„œë“œê°€ í˜¸ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤**.
>

## ì‹¤ìŠµ

### ì‹±ê¸€í†¤ ìŠ¤ì½”í”„ ë¹ˆ ì¡°íšŒ

1. test/java/hello.core ì— scope ì´ë¦„ì˜ Package ìƒì„±
2. ìƒì„±í•œ íŒ¨í‚¤ì§€ì— SingletonTest ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.scope;

import jakarta.annotation.PostConstruct;
import jakarta.annotation.PreDestroy;
import org.junit.jupiter.api.Test;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.annotation.Scope;

import static org.assertj.core.api.Assertions.assertThat;

public class SingletonTest {

    @Test
    void singletonBeanFind() {
        AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(SingletonBean.class);

        SingletonBean singletonBean1 = ac.getBean(SingletonBean.class);
        SingletonBean singletonBean2 = ac.getBean(SingletonBean.class);
        System.out.println("singletonBean1 = " + singletonBean1);
        System.out.println("singletonBean2 = " + singletonBean2);
        assertThat(singletonBean1).isSameAs(singletonBean2);

        ac.close();
    }

    @Scope("singleton")
    static class SingletonBean {
        @PostConstruct
        public void init() {
            System.out.println("SingletonBean.init");
        }

        @PreDestroy
        public void destroy() {
            System.out.println("SingletonBean.destroy");
        }
    }
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/SingletonTest2.png)

â†’ ë¹ˆ ì´ˆê¸°í™” ë©”ì„œë“œ ì‹¤í–‰

â†’ ê°™ì€ ì¸ìŠ¤í„´ìŠ¤ ë¹ˆ ì¡°íšŒ

â†’ ì¢…ë£Œ ë©”ì„œë“œ ì •ìƒ í˜¸ì¶œ

### í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ ë¹ˆ ì¡°íšŒ

1. scope íŒ¨í‚¤ì§€ì— PrototypeTest ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.scope;

import jakarta.annotation.PostConstruct;
import jakarta.annotation.PreDestroy;
import org.junit.jupiter.api.Test;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.annotation.Scope;

import static org.assertj.core.api.Assertions.assertThat;

public class PrototypeTest {

    @Test
    void prototypeBeanFind() {
        AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(PrototypeBean.class);

        System.out.println("find prototypeBean1");
        PrototypeBean prototypeBean1 = ac.getBean(PrototypeBean.class);
        System.out.println("find prototypeBean2");
        PrototypeBean prototypeBean2 = ac.getBean(PrototypeBean.class);
        System.out.println("prototypeBean1 = " + prototypeBean1);
        System.out.println("prototypeBean2 = " + prototypeBean2);
        assertThat(prototypeBean1).isNotSameAs(prototypeBean2);

        ac.close();
    }

    @Scope("prototype")
    static class PrototypeBean {
        @PostConstruct
        public void init() {
            System.out.println("PrototypeBean.init");
        }

        @PreDestroy
        public void destroy() {
            System.out.println("PrototypeBean.destroy");
        }
    }
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/PrototypeTest.png)

â†’ ì‹±ê¸€í†¤ ë¹ˆì€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„± ì‹œì ì— ì´ˆê¸°í™” ë©”ì„œë“œê°€ ì‹¤í–‰ë˜ì§€ë§Œ, í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ì˜ ë¹ˆì€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì—ì„œ ë¹ˆì„ ì¡°íšŒí•  ë•Œ ìƒì„±ë˜ê³ , ì´ˆê¸°í™” ë©”ì„œë“œ ì‹¤í–‰

â†’ í”„ë¡œí† íƒ€ì… ë¹ˆì„ 2ë²ˆ ì¡°íšŒí–ˆìœ¼ë¯€ë¡œ ì™„ì „íˆ ë‹¤ë¥¸ ìŠ¤í”„ë§ ë¹ˆì´ ìƒì„±ë˜ê³ , ì´ˆê¸°í™”ë„ 2ë²ˆ ì‹¤í–‰ëœ ê²ƒì„ í™•ì¸

â†’ ì¢…ë£Œ ë©”ì„œë“œ ì‹¤í–‰ ì•ˆë¨

> **í”„ë¡œí† íƒ€ì… ë¹ˆì˜ íŠ¹ì§• ì •ë¦¬**
>
> - ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ìš”ì²­í•  ë•Œë§ˆë‹¤ ìƒˆë¡œ ìƒì„±ëœë‹¤
> - ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” í”„ë¡œí† íƒ€ì… ë¹ˆì˜ ìƒì„±ê³¼ ì˜ì¡´ ê´€ê³„ ì£¼ì…, ì´ˆê¸°í™”ê¹Œì§€ë§Œ ê´€ì—¬í•œë‹¤
> - ì¢…ë£Œ ë©”ì„œë“œëŠ” í˜¸ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤
> - í”„ë¡œí† íƒ€ì… ë¹ˆì€ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì¡°íšŒí•œ í´ë¼ì´ì–¸íŠ¸ê°€ ì¡°íšŒí•´ì•¼ í•œë‹¤. ì¢…ë£Œ ë©”ì„œë“œì— ëŒ€í•œ í˜¸ì¶œ ì—­ì‹œ í´ë¼ì´ì–¸íŠ¸ê°€ ì§ì ‘ í•´ì•¼ í•œë‹¤
>

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ - ì‹±ê¸€í†¤ ë¹ˆê³¼ í•¨ê»˜ ì‚¬ìš© ì‹œ ë¬¸ì œì 

- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ì˜ ë¹ˆì„ ìš”ì²­í•˜ë©´ í•­ìƒ ìƒˆë¡œìš´ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± í›„ ë°˜í™˜
- í•˜ì§€ë§Œ ì‹±ê¸€í†¤ ë¹ˆê³¼ í•¨ê»˜ ì‚¬ìš© ì‹œ, ë¬¸ì œ ë°œìƒ ê°€ëŠ¥

## ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— í”„ë¡œí† íƒ€ì… ë¹ˆ ì§ì ‘ ìš”ì²­í•˜ê¸°

- case1 - í´ë¼ì´ì–¸íŠ¸ A

![Untitled](img/í”„ë¡œí† íƒ€ì…ë¹ˆì§ì ‘ìš”ì²­.png)

1. í´ë¼ì´ì–¸íŠ¸A ê°€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— í”„ë¡œí† íƒ€ì… ë¹ˆ ìš”ì²­
2. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” í”„ë¡œí† íƒ€ì… ë¹ˆì„ ìƒˆë¡œ ìƒì„±í•´ ë°˜í™˜(x01), í•´ë‹¹ ë¹ˆì˜ count í•„ë“œ ê°’ì€ 0
3. í´ë¼ì´ì–¸íŠ¸ëŠ” ì¡°íšŒí•œ í”„ë¡œí† íƒ€ì… ë¹ˆì— addCount() ë¥¼ í˜¸ì¶œí•˜ë©´ì„œ count í•„ë“œ ê°’ +1

â†’ í”„ë¡œí† íƒ€ì… ë¹ˆ(x01)ì˜ count í•„ë“œ ê°’ : 1

- case2 - í´ë¼ì´ì–¸íŠ¸ B ì¶”ê°€

![Untitled](img/í”„ë¡œí† íƒ€ì…ë¹ˆì§ì ‘ìš”ì²­2.png)

4. í´ë¼ì´ì–¸íŠ¸B ê°€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— í”„ë¡œí† íƒ€ì… ë¹ˆ ìš”ì²­
5. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” í”„ë¡œí† íƒ€ì… ë¹ˆì„ ìƒˆë¡œ ìƒì„± í›„ ë°˜í™˜(x02), í•´ë‹¹ ë¹ˆì˜ count í•„ë“œ ê°’ì€ 0
6. í´ë¼ì´ì–¸íŠ¸ëŠ” ì¡°íšŒí•œ í”„ë¡œí† íƒ€ì… ë¹ˆì— addCount() ë¥¼ í˜¸ì¶œí•˜ë©´ì„œ count í•„ë“œ ê°’ +1

â†’ í”„ë¡œí† íƒ€ì… ë¹ˆ(x02)ì˜ count í•„ë“œ ê°’ : 1

## ì‹±ê¸€í†¤ ë¹ˆì—ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆ ì‚¬ìš©í•˜ê¸°

- ì‹±ê¸€í†¤ ë¹ˆ(clientBean)ì´ ì˜ì¡´ ê´€ê³„ ì£¼ì…ì„ í†µí•´ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì£¼ì…ë°›ì•„ ì‚¬ìš©í•˜ëŠ” ì˜ˆì‹œ

- case1 - í´ë¼ì´ì–¸íŠ¸ A

![Untitled](img/ì‹±ê¸€í†¤ì—ì„œ_í”„ë¡œí† íƒ€ì…_ë¹ˆ_ìš”ì²­.png)

1. â€˜clientBeanâ€™ ì´ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„± ì‹œì ì— ì˜ì¡´ ê´€ê³„ ìë™ ì£¼ì… ì‚¬ìš© â†’ ì£¼ì… ì‹œì ì— ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— í”„ë¡œí† íƒ€ì… ë¹ˆ ìš”ì²­
2. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” í”„ë¡œí† íƒ€ì… ë¹ˆ ìƒì„± í›„ â€˜clientBeanâ€™ ì— ë°˜í™˜ (í”„ë¡œí† íƒ€ì… ë¹ˆ ê´€ë¦¬ëŠ” ì´ì œ clientBean í´ë¼ì´ì–¸íŠ¸ë¡œ ë„˜ì–´ì˜´), í”„ë¡œí† íƒ€ì… ë¹ˆì˜ count í•„ë“œ ê°’ì€ 0

â†’ â€˜clientBeanâ€™ ì€ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ë‚´ë¶€ í•„ë“œì— ë³´ê´€ (ì •í™•íˆëŠ” ì°¸ì¡°ê°’ ë³´ê´€)

![Untitled](img/ì‹±ê¸€í†¤ì—ì„œ_í”„ë¡œí† íƒ€ì…_ë¹ˆ_ìš”ì²­2.png)

3. í´ë¼ì´ì–¸íŠ¸A ê°€ â€˜clientBean.logic()â€™ í˜¸ì¶œ (clientBean ì€ ì‹±ê¸€í†¤ì´ë¯€ë¡œ í•­ìƒ ê°™ì€ ê°ì²´ ë°˜í™˜)
4. â€˜clientBeanâ€™ ì€ prototypeBean ì˜ addCount() ë¥¼ í˜¸ì¶œí•´ í”„ë¡œí† íƒ€ì… ë¹ˆì˜ count ì¦ê°€ì‹œí‚´, count ê°’ì€ 1

- case2 - í´ë¼ì´ì–¸íŠ¸ B ì¶”ê°€

![Untitled](img/ì‹±ê¸€í†¤ì—ì„œ_í”„ë¡œí† íƒ€ì…_ë¹ˆ_ìš”ì²­3.png)

5. í´ë¼ì´ì–¸íŠ¸B ê°€ â€˜clientBean.logic()â€™ í˜¸ì¶œ (clientBeanì´ ì‹±ê¸€í†¤ì´ë¯€ë¡œ í´ë¼ì´ì–¸íŠ¸A ê°€ í˜¸ì¶œí–ˆë˜ ê°ì²´ì™€ ê°™ì€ ê°ì²´ ë°˜í™˜)
6. â€˜clientBeanâ€™ ì€ prototypeBean ì˜ addCount() í˜¸ì¶œ í›„ í”„ë¡œí† íƒ€ì… ë¹ˆì˜ count ì¦ê°€ì‹œí‚´, count ê°’ì€ 2

### ì½”ë“œë¡œ í™•ì¸í•˜ê¸°

- scope íŒ¨í‚¤ì§€ì— SingletonWithPrototypeTest1 ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.scope;

import jakarta.annotation.PostConstruct;
import jakarta.annotation.PreDestroy;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.annotation.Scope;

import static org.assertj.core.api.Assertions.assertThat;

public class SingletonWithPrototypeTest1 {

    // í”„ë¡œí† íƒ€ì… ë¹ˆ ì§ì ‘ ìš”ì²­ í™•ì¸
    @Test
    void prototypeFind() {
        AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(PrototypeBean.class);
        PrototypeBean prototypeBean1 = ac.getBean(PrototypeBean.class);
        prototypeBean1.addCount();
        assertThat(prototypeBean1.getCount()).isEqualTo(1);

        PrototypeBean prototypeBean2 = ac.getBean(PrototypeBean.class);
        prototypeBean2.addCount();
        assertThat(prototypeBean2.getCount()).isEqualTo(1);
    }

    // ì‹±ê¸€í†¤ì—ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆ ì‚¬ìš© í™•ì¸
    @Test
    void singletonClientUsePrototype() {
        AnnotationConfigApplicationContext ac =
                new AnnotationConfigApplicationContext(ClientBean.class, PrototypeBean.class);

        ClientBean clientBean1 = ac.getBean(ClientBean.class);
        int count1 = clientBean1.logic();
        assertThat(count1).isEqualTo(1);

        ClientBean clientBean2 = ac.getBean(ClientBean.class);
        int count2 = clientBean2.logic();
        assertThat(count2).isEqualTo(2);
    }

    // í”„ë¡œí† íƒ€ì… ë¹ˆ
    @Scope("prototype")
    static class PrototypeBean {
        private int count = 0;

        public void addCount() {
            count++;
        }

        public int getCount() {
            return count;
        }

        @PostConstruct
        public void init() {
            System.out.println("PrototypeBean.init " + this);
        }

        // í˜¸ì¶œ ì•ˆë¨
        @PreDestroy
        public void destroy() {
            System.out.println("PrototypeBean.destroy");
        }
    }

    // ì‹±ê¸€í†¤ì—ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆ ì‚¬ìš©
    @Scope("singleton")
    static class ClientBean {
        // ìƒì„± ì‹œì ì— ì£¼ì…
        private final PrototypeBean prototypeBean;

        @Autowired
        ClientBean(PrototypeBean prototypeBean) {
            this.prototypeBean = prototypeBean;
        }

        public int logic() {
            prototypeBean.addCount();
            int count = prototypeBean.getCount();
            return count;
        }
    }
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/SingletonWithPrototypeTest1.png)

â†’ ê°™ì€ í”„ë¡œí† íƒ€ì… ë¹ˆì´ í˜¸ì¶œë˜ì–´ count ê°’ì´ ì¦ê°€í•œë‹¤

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ - ì‹±ê¸€í†¤ ë¹ˆê³¼ í•¨ê»˜ ì‚¬ìš© ì‹œ Provider ë¡œ ë¬¸ì œ í•´ê²°

> ğŸ’¡ ì‹±ê¸€í†¤ ë¹ˆê³¼ í”„ë¡œí† íƒ€ì… ë¹ˆì„ í•¨ê»˜ ì‚¬ìš©í•  ë•Œ, ì–´ë–»ê²Œ í•˜ë©´ ì‚¬ìš©í•  ë•Œë§ˆë‹¤ í•­ìƒ ìƒˆë¡œìš´ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ìƒì„±í•  ìˆ˜ ìˆì„ê¹Œ?


## ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ìš”ì²­í•˜ê¸°

- ì‹±ê¸€í†¤ ë¹ˆì´ í”„ë¡œí† íƒ€ì…ì„ ì‚¬ìš©í•  ë•Œë§ˆë‹¤ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ìƒˆë¡œ ìš”ì²­
- ê°€ì¥ ê°„ë‹¨í•œ ë°©ë²•

- SingletonWithPrototypeTest1 ì½”ë“œ ìˆ˜ì •

```java
...
public class SingletonWithPrototypeTest1 {

    ...

    // ì‹±ê¸€í†¤ì—ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆ ì‚¬ìš© í™•ì¸
    @Test
    void singletonClientUsePrototype() {
        ...
        ClientBean clientBean2 = ac.getBean(ClientBean.class);
        int count2 = clientBean2.logic();
        assertThat(count2).isEqualTo(1); // ë°”ë€ ë¶€ë¶„
    }

    ...

    // ì‹±ê¸€í†¤ì—ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆ ì‚¬ìš©
    @Scope("singleton")
    static class ClientBean {
        // ìƒì„± ì‹œì ì— ì£¼ì…
        // private final PrototypeBean prototypeBean;

        @Autowired
        ApplicationContext applicationContext;

//        @Autowired
//        ClientBean(PrototypeBean prototypeBean) {
//            this.prototypeBean = prototypeBean;
//        }

        public int logic() {
            PrototypeBean prototypeBean = applicationContext.getBean(PrototypeBean.class);
            prototypeBean.addCount();
            int count = prototypeBean.getCount();
            return count;
        }
    }
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/SingletonWithPrototype_ìŠ¤í”„ë§ì»¨í…Œì´ë„ˆì—ìš”ì²­.png)

â†’ ac.getBean() ì„ í†µí•´ í•­ìƒ ìƒˆë¡œìš´ í”„ë¡œí† íƒ€ì… ë¹ˆì´ ìƒì„±ë˜ëŠ” ê²ƒì„ í™•ì¸

â†’ ì˜ì¡´ ê´€ê³„ë¥¼ ì™¸ë¶€ì—ì„œ ì£¼ì…(DI) ë°›ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ì§ì ‘ í•„ìš”í•œ ì˜ì¡´ ê´€ê³„ë¥¼ ì°¾ëŠ” ê²ƒì„ DL (Dependency Lookup) ì˜ì¡´ ê´€ê³„ ì¡°íšŒ(íƒìƒ‰)ë¼ í•¨

â†’ ìŠ¤í”„ë§ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ ì „ì²´ë¥¼ ì£¼ì…ë°›ê²Œ ë˜ë©´, ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ì¢…ì†ì ì¸ ì½”ë“œê°€ ë˜ê³ , ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ê°€ ì–´ë ¤ì›Œ ì§

âœ… ì§€ì •í•œ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì»¨í…Œì´ë„ˆì—ì„œ ëŒ€ì‹  ì°¾ì•„ì£¼ëŠ”, **DL** ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ë¬´ì–¸ê°€ê°€ í•„ìš”

## ObjectFactory, ObjectProvider

- ObjectProvider : ì§€ì •í•œ ë¹ˆì„ ì»¨í…Œì´ë„ˆì—ì„œ ëŒ€ì‹  ì°¾ì•„ì£¼ëŠ” ê²ƒ (DL ì„œë¹„ìŠ¤)
    - ObjectFactory + í¸ì˜ ê¸°ëŠ¥

- SingletonWithPrototypeTest1 ì½”ë“œ ìˆ˜ì •

```java
...
public class SingletonWithPrototypeTest1 {

    ...

    // ì‹±ê¸€í†¤ì—ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆ ì‚¬ìš©
    @Scope("singleton")
    static class ClientBean {

        @Autowired
        private ObjectProvider<PrototypeBean> prototypeBeanProvider;

        public int logic() {
            PrototypeBean prototypeBean = prototypeBeanProvider.getObject();
            prototypeBean.addCount();
            int count = prototypeBean.getCount();
            return count;
        }
    }
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/ObjectProvider.png)

â†’ prototypeBeanProvider.getObject() ë¥¼ í†µí•´ í•­ìƒ ìƒˆë¡œìš´ í”„ë¡œí† íƒ€ì… ë¹ˆ ìƒì„± (ë‚´ë¶€ì—ì„œ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ í†µí•´ í•´ë‹¹ ë¹ˆì„ ì°¾ì•„ ë°˜í™˜ - **DL**)

â†’ ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì§€ë§Œ, ê¸°ëŠ¥ì´ ë‹¨ìˆœí•˜ë¯€ë¡œ ë‹¨ìœ„í…ŒìŠ¤íŠ¸ë‚˜ mock ì½”ë“œë¥¼ ë§Œë“¤ê¸°ëŠ” í›¨ì”¬ ì‰¬ì›€

â†’ ObjectProvider ëŠ” ì§€ê¸ˆ í•„ìš”í•œ DL ì •ë„ì˜ ê¸°ëŠ¥ë§Œ ì œê³µ

### íŠ¹ì§•

- ObjectFactory : ë‹¨ìˆœí•œ ê¸°ëŠ¥, ë³„ë„ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ í•„ìš” ì—†ìŒ, ìŠ¤í”„ë§ì— ì˜ì¡´
- ObjectProvider : ObjectFactory ìƒì†, ì˜µì…˜, ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬ ë“±ì˜ í¸ì˜ ê¸°ëŠ¥ì´ ë§ìŒ, ë³„ë„ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ í•„ìš” ì—†ìŒ, ìŠ¤í”„ë§ì— ì˜ì¡´

## JSR-330 Provider

- javax.inject.Provider ë¼ëŠ” JSR-330 ìë°” í‘œì¤€ ì‚¬ìš©í•˜ê¸°
- ìŠ¤í”„ë§ ë¶€íŠ¸ 3.0 : jakarta.inject.Provider

1. build.gradle ì— ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€í•˜ê¸° & gradle refresh

```java
...

dependencies {
	...

	implementation 'jakarta.inject:jakarta.inject-api:2.0.1' // JSR-330 Provider
}

...
```

2. SingletonWithPrototypeTest1 ì½”ë“œ ìˆ˜ì •

```java
...
public class SingletonWithPrototypeTest1 {

    ...

    // ì‹±ê¸€í†¤ì—ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆ ì‚¬ìš©
    @Scope("singleton")
    static class ClientBean {

        @Autowired
        private Provider<PrototypeBean> prototypeBeanProvider;

        public int logic() {
            ...
        }
    }
}
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼

![Untitled](img/JSR-330.png)

â†’ provider.get() ë¥¼ í†µí•´ í•­ìƒ ìƒˆë¡œìš´ í”„ë¡œí† íƒ€ì… ë¹ˆì´ ìƒì„±ë˜ëŠ” ê²ƒì„ í™•ì¸ (ë‚´ë¶€ì—ì„œ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ í†µí•´ í•´ë‹¹ ë¹ˆì„ ì°¾ì•„ ë°˜í™˜ - **DL**)

â†’ ìë°” í‘œì¤€, ë‹¨ìˆœí•œ ê¸°ëŠ¥ : ë‹¨ìœ„í…ŒìŠ¤íŠ¸, mock ì½”ë“œ ë§Œë“¤ê¸°ê°€ ì‰¬ì›Œì§

â†’ Provider ëŠ” ì§€ê¸ˆ í•„ìš”í•œ DL ì •ë„ì˜ ê¸°ëŠ¥ë§Œ ì œê³µ

### íŠ¹ì§•

- get() ë©”ì„œë“œ í•˜ë‚˜ë¡œ ë‹¨ìˆœí•œ ê¸°ëŠ¥ êµ¬í˜„
- ë³„ë„ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ í•„ìš”
- ìë°” í‘œì¤€ â†’ ìŠ¤í”„ë§ì´ ì•„ë‹Œ ë‹¤ë¥¸ ì»¨í…Œì´ë„ˆì—ì„œë„ ì‚¬ìš© ê°€ëŠ¥

### ì •ë¦¬

- í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì‚¬ìš©í•˜ëŠ” ë•Œ : ë§¤ë²ˆ ì‚¬ìš©í•  ë•Œë§ˆë‹¤ ì˜ì¡´ ê´€ê³„ ì£¼ì…ì´ ì™„ë£Œëœ ìƒˆë¡œìš´ ê°ì²´ê°€ í•„ìš”í•œ ìƒí™© (ì‹±ê¸€í†¤ìœ¼ë¡œ ëŒ€ë¶€ë¶„ì˜ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ë•Œë¬¸ì— í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì§ì ‘ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ì¼ì€ ë“œë¬¾)
- ObjectProvider, JSR330 Provider ë“±ì€ í”„ë¡œí† íƒ€ì… ë¿ë§Œ ì•„ë‹ˆë¼ DL ì´ í•„ìš”í•œ ê²½ìš°ëŠ” ì–¸ì œë“ ì§€ ì‚¬ìš© ê°€ëŠ¥

> **ì°¸ê³ **
>
> - ObjectProvider : DL ì„ ìœ„í•œ í¸ì˜ ê¸°ëŠ¥ ì œê³µ, ìŠ¤í”„ë§ ì™¸ ë³„ë„ì˜ ì˜ì¡´ ê´€ê³„ ì¶”ê°€ í•„ìš” ì—†ìŒ
> - JSR330 Provider : ì½”ë“œë¥¼ ìŠ¤í”„ë§ì´ ì•„ë‹Œ ë‹¤ë¥¸ ì»¨í…Œì´ë„ˆì—ì„œ ì‚¬ìš©í•´ì•¼ í•  ë•Œ ì‚¬ìš©
> - íŠ¹ë³„íˆ ë‹¤ë¥¸ ì»¨í…Œì´ë„ˆë¥¼ ì‚¬ìš©í•  ì¼ì´ ì—†ë‹¤ë©´, ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ ì‚¬ìš©í•˜ê¸°
>

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ì›¹ ìŠ¤ì½”í”„

### ì›¹ ìŠ¤ì½”í”„ íŠ¹ì§•

- ì›¹ ìŠ¤ì½”í”„ëŠ” ì›¹ í™˜ê²½ì—ì„œë§Œ ë™ì‘
- ì›¹ ìŠ¤ì½”í”„ëŠ” í”„ë¡œí† íƒ€ì…ê³¼ ë‹¤ë¥´ê²Œ ìŠ¤í”„ë§ì´ í•´ë‹¹ ìŠ¤ì½”í”„ì˜ ì¢…ë£Œ ì‹œì ê¹Œì§€ ê´€ë¦¬ â†’ ì¢…ë£Œ ë©”ì„œë“œê°€ í˜¸ì¶œë¨

### ì›¹ ìŠ¤ì½”í”„ ì¢…ë¥˜

- **request** : HTTP ìš”ì²­ í•˜ë‚˜ê°€ ë“¤ì–´ì˜¤ê³  ë‚˜ê°ˆ ë•Œê¹Œì§€ ìœ ì§€ë˜ëŠ” ìŠ¤ì½”í”„, ê°ê°ì˜ HTTP ìš”ì²­ë§ˆë‹¤ ë³„ë„ì˜ ë¹ˆ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ë˜ê³  ê´€ë¦¬ë¨
- **session** : HTTP Session ê³¼ ë™ì¼í•œ ìƒëª…ì£¼ê¸°ë¥¼ ê°€ì§€ëŠ” ìŠ¤ì½”í”„
- **application** : ì„œë¸”ë¦¿ ì»¨í…ìŠ¤íŠ¸(ServletContext)ì™€ ë™ì¼í•œ ìƒëª… ì£¼ê¸°ë¥¼ ê°€ì§€ëŠ” ìŠ¤ì½”í”„
- **websocket** : ì›¹ ì†Œì¼“ê³¼ ë™ì¼í•œ ìƒëª… ì£¼ê¸°ë¥¼ ê°€ì§€ëŠ” ìŠ¤ì½”í”„

![Untitled](img/HTTP_request.png)

â†’ HTTP request ìš”ì²­ ë‹¹ ê°ê° í• ë‹¹ë˜ëŠ” request ìŠ¤ì½”í”„

1. í´ë¼ì´ì–¸íŠ¸ A ìš”ì²­ â†’ HTTP request ì— ë”°ë¥¸ ê°ì²´ í• ë‹¹ (A ì „ìš©)
2. ê°™ì€ HTTP request ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ ë§Œë“¤ì–´ë‘ì—ˆë˜ ê°ì²´ ë°˜í™˜
3. í´ë¼ì´ì–¸íŠ¸ B ìš”ì²­ â†’ HTTP request ì— ë”°ë¥¸ ê°ì²´ í• ë‹¹ (B ì „ìš©)

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# request ìŠ¤ì½”í”„ ì˜ˆì œ ë§Œë“¤ê¸°

## ì›¹ í™˜ê²½ ì¶”ê°€

- ì›¹ ìŠ¤ì½”í”„ëŠ” ì›¹ í™˜ê²½ì—ì„œë§Œ ë™ì‘í•˜ë¯€ë¡œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€í•˜ê¸°

1. build.gradle ì— ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€ & gradle refresh

```java
...
dependencies {
	implementation 'jakarta.inject:jakarta.inject-api:2.0.1' // JSR-330 Provider
	...
}

...
```

2. hello.core.CoreApplication ì˜ main ë©”ì„œë“œ ì‹¤í–‰

![Untitled](img/requestScope.png)

â†’ spring-boot-starter-web ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¶”ê°€í•˜ë©´ ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” ë‚´ì¥ í†°ìº£ ì„œë²„ë¥¼ í™œìš©í•´ ì›¹ ì„œë²„ì™€ ìŠ¤í”„ë§ì„ í•¨ê»˜ ì‹¤í–‰ì‹œí‚´

> **ì°¸ê³ **
> 
> - ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” ì›¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì—†ìœ¼ë©´ AnnotationConfigApplicationContext ê¸°ë°˜ ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬ë™
> - ì›¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì¶”ê°€ë˜ë©´ AnnotationConfigServletWebServerApplicationContext ê¸°ë°˜ ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬ë™
>

3. [localhost:8080](http://localhost:8080) ì ‘ì†

![Untitled](img/requestScope2.png)

â†’ ì ‘ì† ì„±ê³µ

## request ìŠ¤ì½”í”„ ì˜ˆì œ ê°œë°œ

- ë™ì‹œì— ì—¬ëŸ¬ HTTP ìš”ì²­ì´ ì˜¤ë©´, ë¡œê·¸ êµ¬ë¶„ì´ ì–´ë ¤ì›€ â†’ request ìŠ¤ì½”í”„ í™œìš©
- ë¡œê·¸ê°€ ë‚¨ë„ë¡ request ìŠ¤ì½”í”„ í™œìš©í•˜ì—¬ ê¸°ëŠ¥ ê°œë°œ

![Untitled](img/requestScope_ê¸°ëŒ€ë¡œê·¸.png)

â†’ ê¸°ëŒ€í•˜ëŠ” ê³µí†µ í¬ë§· : UUID {message}

â†’ UUID ë¥¼ ì‚¬ìš©í•˜ì—¬ HTTP ìš”ì²­ êµ¬ë¶„í•˜ê¸°

â†’ requestURL ì •ë³´ ì¶”ê°€í•˜ê¸°

1. main/java/hello.core ì— common ì´ë¦„ì˜ Package ìƒì„±
2. ìƒì„±í•œ íŒ¨í‚¤ì§€ì— MyLogger ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.common;

import jakarta.annotation.PostConstruct;
import jakarta.annotation.PreDestroy;
import org.springframework.context.annotation.Scope;
import org.springframework.stereotype.Component;

import java.util.UUID;

@Component
@Scope(value = "request")
public class MyLogger {

    private String uuid;
    private String requestURL;

    public void setRequestURL(String requestURL) {
        this.requestURL = requestURL;
    }

    public void log(String message) {
        System.out.println("[" + uuid + "]" + "[" + requestURL + "]" + message);
    }
    
    @PostConstruct
    public void init() {
        uuid = UUID.randomUUID().toString();
        System.out.println("[" + uuid + "] request scope bean create: " + this);
    }
    
    @PreDestroy
    public void close() {
        System.out.println("[" + uuid + "] request scope bean close: " + this);
    }
}
```

â˜‘ï¸ ë¡œê·¸ë¥¼ ì¶œë ¥í•˜ê¸° ìœ„í•œ MyLogger í´ë˜ìŠ¤

â˜‘ï¸ @Scope(value = â€œrequestâ€) ë¥¼ ì‚¬ìš©í•´ request ìŠ¤ì½”í”„ë¡œ ì§€ì • â†’ HTTP ìš”ì²­ ë‹¹ í•˜ë‚˜ì˜ ë¹ˆ ìƒì„±, HTTP ìš”ì²­ ëë‚˜ëŠ” ì‹œì ì— ì†Œë©¸

â˜‘ï¸ @PostConstruct ì´ˆê¸°í™” ë©”ì„œë“œê°€ ë¹ˆì´ ìƒì„±ë˜ëŠ” ì‹œì ì— uuid ìƒì„± í›„ ì €ì¥

â˜‘ï¸ @PreDestroy ë¥¼ ì´ìš©í•´ ë¹ˆì´ ì†Œë©¸ë˜ëŠ” ì‹œì ì— ì¢…ë£Œ ë©”ì„¸ì§€ ë‚¨ê¹€

â˜‘ï¸ requestURL ì€ ì™¸ë¶€ì—ì„œ setter ë¡œ ì…ë ¥ë°›ê¸°

3. main/java/hello.core ì— web ì´ë¦„ì˜ Package ìƒì„±
4. web íŒ¨í‚¤ì§€ì— LogDemoController ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.web;

import hello.core.common.MyLogger;
import jakarta.servlet.http.HttpServletRequest;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;

@Controller
@RequiredArgsConstructor
public class LobDemoController {

    private final LogDemoService logDemoService;
    private final MyLogger myLogger;

    @RequestMapping("log-demo")
    @ResponseBody
    public String logDemo(HttpServletRequest request) {
        String requestURL = request.getRequestURL().toString();
        myLogger.setRequestURL(requestURL);

        myLogger.log("controller test");
        logDemoService.logic("testId");
        return "OK";
    }
}
```

â˜‘ï¸ ë¡œê±°ê°€ ì˜ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” í…ŒìŠ¤íŠ¸ìš© ì»¨íŠ¸ë¡¤ëŸ¬

â˜‘ï¸ HttpServletRequest ë¡œ ìš”ì²­ URL ë°›ê¸° (requestURL : http://localhost:8080/log-demo)

â˜‘ï¸ requestURL ê°’ myLogger ì— ì €ì¥

â˜‘ï¸ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ controller test ë¼ëŠ” ë¡œê·¸ ë‚¨ê¹€

5. web íŒ¨í‚¤ì§€ì— LogDemoService ì´ë¦„ì˜ Class ìƒì„±

```java
package hello.core.web;

import hello.core.common.MyLogger;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;

@Service
@RequiredArgsConstructor
public class LogDemoService {

    private final MyLogger myLogger;

    public void logic(String id) {
        myLogger.log("service id = " + id);
    }
}
```

â˜‘ï¸ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ìˆëŠ” ì„œë¹„ìŠ¤ ê³„ì¸µ ë¡œê·¸ ì¶œë ¥í•˜ê¸°

â˜‘ï¸ ì„œë¹„ìŠ¤ ê³„ì¸µì€ ì›¹ ê¸°ìˆ ì— ì¢…ì†ë˜ì§€ ì•Šê³ , ê°€ê¸‰ì  ìˆœìˆ˜í•˜ê²Œ ìœ ì§€í•˜ëŠ” ê²ƒì´ ìœ ì§€ë³´ìˆ˜ ê´€ì ì—ì„œ ì¢‹ìŒ

6. hello.core.CoreApplication ì‹¤í–‰

â†’ ì˜¤ë¥˜ ë°œìƒ : ì‹¤ì œ ê³ ê° ìš”ì²­ì´ ì™€ì•¼ ìƒì„± ê°€ëŠ¥

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ìŠ¤ì½”í”„ì™€ Provider

## ObjectProvider

1. LogDemoController ì½”ë“œ ìˆ˜ì •

```java
...
@Controller
@RequiredArgsConstructor
public class LobDemoController {

    ...
    private final ObjectProvider<MyLogger> myLoggerProvider;

    @RequestMapping("log-demo")
    @ResponseBody
    public String logDemo(HttpServletRequest request) {
        MyLogger myLogger = myLoggerProvider.getObject();
        ...
    }
}
```

2. LogDemoService ì½”ë“œ ìˆ˜ì •

```java
...
@Service
@RequiredArgsConstructor
public class LogDemoService {

    private final ObjectProvider<MyLogger> myLoggerProvider;

    public void logic(String id) {
        MyLogger myLogger = myLoggerProvider.getObject();
        ...
    }
}
```

3. hello.core.CoreApplication ì‹¤í–‰ í›„ ì›¹ ë¸Œë¼ìš°ì € ì ‘ì†

![Untitled](img/requestscope_ObjectProvider.png)

- ë¡œê·¸

![Untitled](img/requestscope_ObjectProviderLog.png)

â†’ ObjectProvider ì‚¬ìš©ìœ¼ë¡œ ObjectProvider.getObject() í˜¸ì¶œ ì‹œì ê¹Œì§€ request scope ë¹ˆì˜ ìƒì„± ì§€ì—°

â†’ ObjectProvider.getObject() í˜¸ì¶œ ì‹œì  : HTTP ìš”ì²­ ì§„í–‰ ì¤‘ì´ë¯€ë¡œ request scope ë¹ˆì˜ ìƒì„±ì´ ì •ìƒ ì²˜ë¦¬

â†’ ObjectProvider.getObject() ë¥¼ LogDemoController, LogDemoService ì—ì„œ ê°ê° í˜¸ì¶œí•´ë„ ê°™ì€ HTTP ìš”ì²­ì´ë©´ ê°™ì€ ìŠ¤í”„ë§ ë¹ˆ ë°˜í™˜!!

<!------------------------------------------------------------>
<!------------------------------------------------------------>
<!------------------------------------------------------------>

# ìŠ¤ì½”í”„ì™€ í”„ë¡ì‹œ

### ì½”ë“œ ìˆ˜ì •í•˜ê¸°

- myLogger

```java
...
@Component
@Scope(value = "request", proxyMode = ScopedProxyMode.TARGET_CLASS)
public class MyLogger {
    ...
}
```

â­ proxyMode = ScopedProxyMode.TARGET_CLASS

â¡ï¸ ì ìš© ëŒ€ìƒì´ ì¸í„°í˜ì´ìŠ¤ê°€ ì•„ë‹Œ í´ë˜ìŠ¤ë©´ TARGET_CLASS ì„ íƒ

â¡ï¸ ì ìš© ëŒ€ìƒì´ ì¸í„°í˜ì´ìŠ¤ë©´ INTERFACES ì„ íƒ

â†’ MyLogger ì˜ ê°€ì§œ í”„ë¡ì‹œ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ë‘ê³ , HTTP request ì™€ ìƒê´€ ì—†ì´ ê°€ì§œ í”„ë¡ì‹œ í´ë˜ìŠ¤ë¥¼ ë‹¤ë¥¸ ë¹ˆì— ë¯¸ë¦¬ ì£¼ì…í•´ ë‘˜ ìˆ˜ ìˆìŒ

- LogDemoController

```java
...
@Controller
@RequiredArgsConstructor
public class LobDemoController {

    ...
    private final MyLogger myLogger;

    @RequestMapping("log-demo")
    @ResponseBody
    public String logDemo(HttpServletRequest request) {
        String requestURL = request.getRequestURL().toString();
        myLogger.setRequestURL(requestURL);

        myLogger.log("controller test");
        logDemoService.logic("testId");
        return "OK";
    }
}
```

- LogDemoService

```java
...
@Service
@RequiredArgsConstructor
public class LogDemoService {

    private final MyLogger myLogger;

    public void logic(String id) {
        myLogger.log("service id = " + id);
    }
}
```

## ì›¹ ìŠ¤ì½”í”„ì™€ í”„ë¡ì‹œ ë™ì‘ ì›ë¦¬

- CGLIB ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ë‚´ í´ë˜ìŠ¤ë¥¼ ìƒì† ë°›ì€ ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ë¥¼ ë§Œë“¤ì–´ ì£¼ì…
  - @Scope ì˜ proxyMode = ScopedProxyMode.TARGET_CLASS ì„¤ì • ì‹œ, ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” CGLIB ë¼ì´ë¸ŒëŸ¬ë¦¬(ë°”ì´íŠ¸ì½”ë“œ ì¡°ì‘)ë¥¼ ì‚¬ìš©í•´ MyLogger ë¥¼ ìƒì†ë°›ì€ ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ ìƒì„±
  - í™•ì¸ ì‹œ MyLogger$$EnhancerBySpringCGLIB í´ë˜ìŠ¤ë¡œ ë§Œë“¤ì–´ì§„ ê°ì²´ê°€ ëŒ€ì‹  ë“±ë¡ë˜ì–´ ìˆìŒ
  - ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— â€œmyLoggerâ€ ëŒ€ì‹  ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ ë“±ë¡
  - ì˜ì¡´ ê´€ê³„ ì£¼ì…ë„ ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ê°€ ì£¼ì…ë¨

![Untitled](img/scope&proxy.png)

âœ… ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ëŠ” ìš”ì²­ì´ ì˜¤ë©´ ê·¸ë•Œ ë‚´ë¶€ì—ì„œ ì§„ì§œ ë¹ˆì„ ìš”ì²­í•˜ëŠ” ìœ„ì„ ë¡œì§ì´ ë“¤ì–´ìˆìŒ

â†’ í´ë¼ì´ì–¸íŠ¸ê°€ myLogger.log() í˜¸ì¶œ ì‹œ ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ ë©”ì„œë“œ í˜¸ì¶œ

â†’ ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ëŠ” request ìŠ¤ì½”í”„ì˜ ì§„ì§œ myLogger.log() í˜¸ì¶œ

â†’ ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ëŠ” ì›ë³¸ í´ë˜ìŠ¤ë¥¼ ìƒì† ë°›ì•„ì„œ ë§Œë“¤ì–´ì¡Œê¸° ë•Œë¬¸ì— í´ë¼ì´ì–¸íŠ¸ ì…ì¥ì—ì„œëŠ” ë™ì¼í•˜ê²Œ ì‚¬ìš© ê°€ëŠ¥ (ë‹¤í˜•ì„±)

### ë™ì‘ ì •ë¦¬

- CGLIB ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ë‚´ í´ë˜ìŠ¤ë¥¼ ìƒì† ë°›ì€ ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ ìƒì„± í›„ ì˜ì¡´ ê´€ê³„ ì£¼ì…
- ì‹¤ì œ ìš”ì²­ì´ ì˜¤ë©´ ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ëŠ” ë‚´ë¶€ì—ì„œ ì‹¤ì œ ë¹ˆì„ ìš”ì²­í•˜ëŠ” ìœ„ì„ ë¡œì§ ì‹¤í–‰
- ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ëŠ” ì‹±ê¸€í†¤ì²˜ëŸ¼ ë™ì‘ (ì‹¤ì œ request scope ì™€ëŠ” ê´€ê³„X)

### íŠ¹ì§• ì •ë¦¬

- í”„ë¡ì‹œ ê°ì²´ ë•ë¶„ì— í´ë¼ì´ì–¸íŠ¸ëŠ” ë§ˆì¹˜ ì‹±ê¸€í†¤ ë¹ˆì„ ì‚¬ìš©í•˜ë“¯ì´ í¸ë¦¬í•˜ê²Œ request scope ì‚¬ìš©
- â­ ì§„ì§œ ì¡°íšŒ ê°ì²´ë¥¼ ê¼­ í•„ìš”í•œ ì‹œì ê¹Œì§€ ì§€ì—° ì²˜ë¦¬
- ì• ë…¸í…Œì´ì…˜ ì„¤ì • ë³€ê²½ë§Œìœ¼ë¡œ ì›ë³¸ ê°ì²´ë¥¼ í”„ë¡ì‹œ ê°ì²´ë¡œ ëŒ€ì²´ ê°€ëŠ¥ (ë‹¤í˜•ì„±ê³¼ DI ì»¨í…Œì´ë„ˆê°€ ê°€ì§„ ê°€ì¥ í° ê°•ì )
- ì›¹ ìŠ¤ì½”í”„ê°€ ì•„ë‹ˆë”ë¼ë„ í”„ë¡ì‹œ ì‚¬ìš© ê°€ëŠ¥

### ì£¼ì˜ì 

- ë§ˆì¹˜ ì‹±ê¸€í†¤ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒ ê°™ì§€ë§Œ, ë‹¤ë¥´ê²Œ ë™ì‘í•˜ê¸° ë•Œë¬¸ì— ì£¼ì˜í•´ì„œ ì‚¬ìš©
- ë¬´ë¶„ë³„í•˜ê²Œ ì‚¬ìš©í•  ì‹œ ìœ ì§€ë³´ìˆ˜ê°€ ì–´ë ¤ì›Œì§€ê¸° ë•Œë¬¸ì— íŠ¹ë³„í•œ scope ëŠ” ê¼­ í•„ìš”í•œ ê³³ì—ì„œ ìµœì†Œí™”í•˜ì—¬ ì‚¬ìš©